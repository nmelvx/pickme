webpackJsonp([3],{10:function(module,exports,__webpack_require__){!function(global,factory){module.exports=factory(__webpack_require__(18),__webpack_require__(4),__webpack_require__(270))}(0,function(Backbone,_,Radio){"use strict";function getEventName(match,prefix,eventName){return eventName.toUpperCase()}function triggerMethod$1(event){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];var methodName=getOnMethodName(event),method=getOption.call(this,methodName),result=void 0;return _.isFunction(method)&&(result=method.apply(this,args)),this.trigger.apply(this,arguments),result}function triggerMethodOn(context){for(var _len2=arguments.length,args=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];return _.isFunction(context.triggerMethod)?context.triggerMethod.apply(context,args):triggerMethod$1.apply(context,args)}function triggerMethodChildren(view,event,shouldTrigger){view._getImmediateChildren&&_.each(view._getImmediateChildren(),function(child){shouldTrigger(child)&&triggerMethodOn(child,event,child)})}function shouldTriggerAttach(view){return!view._isAttached}function shouldAttach(view){return!!shouldTriggerAttach(view)&&(view._isAttached=!0,!0)}function shouldTriggerDetach(view){return view._isAttached}function shouldDetach(view){return!!shouldTriggerDetach(view)&&(view._isAttached=!1,!0)}function triggerDOMRefresh(view){view._isAttached&&view._isRendered&&triggerMethodOn(view,"dom:refresh",view)}function handleBeforeAttach(){triggerMethodChildren(this,"before:attach",shouldTriggerAttach)}function handleAttach(){triggerMethodChildren(this,"attach",shouldAttach),triggerDOMRefresh(this)}function handleBeforeDetach(){triggerMethodChildren(this,"before:detach",shouldTriggerDetach)}function handleDetach(){triggerMethodChildren(this,"detach",shouldDetach)}function handleRender(){triggerDOMRefresh(this)}function monitorViewEvents(view){view._areViewEventsMonitored||(view._areViewEventsMonitored=!0,view.on({"before:attach":handleBeforeAttach,attach:handleAttach,"before:detach":handleBeforeDetach,detach:handleDetach,render:handleRender}))}function bindFromStrings(target,entity,evt,methods,actionName){var methodNames=methods.split(/\s+/);_.each(methodNames,function(methodName){var method=target[methodName];if(!method)throw new MarionetteError('Method "'+methodName+'" was configured as an event handler, but does not exist.');target[actionName](entity,evt,method)})}function iterateEvents(target,entity,bindings,actionName){if(entity&&bindings){if(!_.isObject(bindings))throw new MarionetteError({message:"Bindings must be an object.",url:"marionette.functions.html#marionettebindevents"});_.each(bindings,function(method,evt){if(_.isString(method))return void bindFromStrings(target,entity,evt,method,actionName);target[actionName](entity,evt,method)})}}function bindEvents(entity,bindings){return iterateEvents(this,entity,bindings,"listenTo"),this}function unbindEvents(entity,bindings){return iterateEvents(this,entity,bindings,"stopListening"),this}function iterateReplies(target,channel,bindings,actionName){if(channel&&bindings){if(!_.isObject(bindings))throw new MarionetteError({message:"Bindings must be an object.",url:"marionette.functions.html#marionettebindrequests"});var normalizedRadioRequests=normalizeMethods.call(target,bindings);channel[actionName](normalizedRadioRequests,target)}}function bindRequests(channel,bindings){return iterateReplies(this,channel,bindings,"reply"),this}function unbindRequests(channel,bindings){return iterateReplies(this,channel,bindings,"stopReplying"),this}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function getBehaviorClass(options,key){return options.behaviorClass?options.behaviorClass:_.isFunction(options)?options:_.isFunction(Marionette.Behaviors.behaviorsLookup)?Marionette.Behaviors.behaviorsLookup(options,key)[key]:Marionette.Behaviors.behaviorsLookup[key]}function parseBehaviors(view,behaviors){return _.chain(behaviors).map(function(options,key){var BehaviorClass=getBehaviorClass(options,key),_options=options===BehaviorClass?{}:options,behavior=new BehaviorClass(_options,view);return[behavior].concat(parseBehaviors(view,_.result(behavior,"behaviors")))}).flatten().value()}function uniqueName(eventName,selector){return[eventName+_.uniqueId(".evt"),selector].join(" ")}function isEnabled(name){return!!FEATURES[name]}function setEnabled(name,state){return FEATURES[name]=state}function buildViewTrigger(view,triggerDef){_.isString(triggerDef)&&(triggerDef={event:triggerDef});var eventName=triggerDef.event,shouldPreventDefault=!!triggerDef.preventDefault;isEnabled("triggersPreventDefault")&&(shouldPreventDefault=!1!==triggerDef.preventDefault);var shouldStopPropagation=!!triggerDef.stopPropagation;return isEnabled("triggersStopPropagation")&&(shouldStopPropagation=!1!==triggerDef.stopPropagation),function(event){shouldPreventDefault&&event.preventDefault(),shouldStopPropagation&&event.stopPropagation(),view.triggerMethod(eventName,view,event)}}function destroyBackboneView(view){view.supportsDestroyLifecycle||triggerMethodOn(view,"before:destroy",view);var shouldTriggerDetach=!!view._isAttached;shouldTriggerDetach&&triggerMethodOn(view,"before:detach",view),view.remove(),shouldTriggerDetach&&(view._isAttached=!1,triggerMethodOn(view,"detach",view)),view._isDestroyed=!0,view.supportsDestroyLifecycle||triggerMethodOn(view,"destroy",view)}function buildRegionFromDefinition(definition,defaults){var opts=_.extend({},defaults);if(_.isString(definition))return _.extend(opts,{el:definition}),buildRegionFromObject(opts);if(_.isFunction(definition))return _.extend(opts,{regionClass:definition}),buildRegionFromObject(opts);if(_.isObject(definition))return definition.selector&&deprecate("The selector option on a Region definition object is deprecated. Use el to pass a selector string"),_.extend(opts,{el:definition.selector},definition),buildRegionFromObject(opts);throw new MarionetteError({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})}function buildRegionFromObject(definition){return new(0,definition.regionClass)(_.omit(definition,"regionClass"))}function behaviorsLookup(){throw new MarionetteError({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.md#behaviorslookup"})}Backbone="default"in Backbone?Backbone.default:Backbone,_="default"in _?_.default:_,Radio="default"in Radio?Radio.default:Radio;var proxy=function(method){return function(context){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];return method.apply(context,args)}},extend=Backbone.Model.extend,deprecate=function deprecate(message,test){_.isObject(message)&&(message=message.prev+" is going to be removed in the future. Please use "+message.next+" instead."+(message.url?" See: "+message.url:"")),Marionette.DEV_MODE&&(void 0!==test&&test||deprecate._cache[message]||(deprecate._warn("Deprecation warning: "+message),deprecate._cache[message]=!0))};deprecate._console="undefined"!=typeof console?console:{},deprecate._warn=function(){return(deprecate._console.warn||deprecate._console.log||_.noop).apply(deprecate._console,arguments)},deprecate._cache={};var isNodeAttached=function(el){return document.documentElement.contains(el&&el.parentNode)},mergeOptions=function(options,keys){var _this=this;options&&_.each(keys,function(key){var option=options[key];void 0!==option&&(_this[key]=option)})},getOption=function(optionName){if(optionName)return this.options&&void 0!==this.options[optionName]?this.options[optionName]:this[optionName]},normalizeMethods=function(hash){var _this=this;return _.reduce(hash,function(normalizedHash,method,name){return _.isFunction(method)||(method=_this[method]),method&&(normalizedHash[name]=method),normalizedHash},{})},splitter=/(^|:)(\w)/gi,getOnMethodName=_.memoize(function(event){return"on"+event.replace(splitter,getEventName)}),errorProps=["description","fileName","lineNumber","name","message","number"],MarionetteError=extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v3.2.0/",constructor:function(message,options){_.isObject(message)?(options=message,message=options.message):options||(options={});var error=Error.call(this,message);_.extend(this,_.pick(error,errorProps),_.pick(options,errorProps)),this.captureStackTrace(),options.url&&(this.url=this.urlRoot+options.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,MarionetteError)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}});MarionetteError.extend=extend;var setOptions=function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];this.options=_.extend.apply(_,[{},_.result(this,"options")].concat(args))},CommonMixin={normalizeMethods:normalizeMethods,_setOptions:setOptions,mergeOptions:mergeOptions,getOption:getOption,bindEvents:bindEvents,unbindEvents:unbindEvents},RadioMixin={_initRadio:function(){var channelName=_.result(this,"channelName");if(channelName){if(!Radio)throw new MarionetteError({name:"BackboneRadioMissing",message:'The dependency "backbone.radio" is missing.'});var channel=this._channel=Radio.channel(channelName),radioEvents=_.result(this,"radioEvents");this.bindEvents(channel,radioEvents);var radioRequests=_.result(this,"radioRequests");this.bindRequests(channel,radioRequests),this.on("destroy",this._destroyRadio)}},_destroyRadio:function(){this._channel.stopReplying(null,null,this)},getChannel:function(){return this._channel},bindEvents:bindEvents,unbindEvents:unbindEvents,bindRequests:bindRequests,unbindRequests:unbindRequests},ClassOptions=["channelName","radioEvents","radioRequests"],MarionetteObject=function(options){this._setOptions(options),this.mergeOptions(options,ClassOptions),this.cid=_.uniqueId(this.cidPrefix),this._initRadio(),this.initialize.apply(this,arguments)};MarionetteObject.extend=extend,_.extend(MarionetteObject.prototype,Backbone.Events,CommonMixin,RadioMixin,{cidPrefix:"mno",_isDestroyed:!1,isDestroyed:function(){return this._isDestroyed},initialize:function(){},destroy:function(){if(this._isDestroyed)return this;for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return this.triggerMethod.apply(this,["before:destroy",this].concat(args)),this._isDestroyed=!0,this.triggerMethod.apply(this,["destroy",this].concat(args)),this.stopListening(),this},triggerMethod:triggerMethod$1});var DomMixin={createBuffer:function(){return document.createDocumentFragment()},appendChildren:function(el,children){Backbone.$(el).append(children)},beforeEl:function(el,sibling){Backbone.$(el).before(sibling)},replaceEl:function(newEl,oldEl){if(newEl!==oldEl){var parent=oldEl.parentNode;parent&&parent.replaceChild(newEl,oldEl)}},detachContents:function(el){Backbone.$(el).contents().detach()},setInnerContent:function(el,html){Backbone.$(el).html(html)},removeEl:function(el){Backbone.$(el).remove()},findEls:function(selector,context){return Backbone.$(selector,context)}},TemplateCache=function(templateId){this.templateId=templateId};_.extend(TemplateCache,{templateCaches:{},get:function(templateId,options){var cachedTemplate=this.templateCaches[templateId];return cachedTemplate||(cachedTemplate=new TemplateCache(templateId),this.templateCaches[templateId]=cachedTemplate),cachedTemplate.load(options)},clear:function(){for(var i=void 0,_len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var length=args.length;if(length>0)for(i=0;i<length;i++)delete this.templateCaches[args[i]];else this.templateCaches={}}}),_.extend(TemplateCache.prototype,DomMixin,{load:function(options){if(this.compiledTemplate)return this.compiledTemplate;var template=this.loadTemplate(this.templateId,options);return this.compiledTemplate=this.compileTemplate(template,options),this.compiledTemplate},loadTemplate:function(templateId,options){var $template=this.findEls(templateId);if(!$template.length)throw new MarionetteError({name:"NoTemplateError",message:'Could not find template: "'+templateId+'"'});return $template.html()},compileTemplate:function(rawTemplate,options){return _.template(rawTemplate,options)}});var _invoke=_.invokeMap||_.invoke,BehaviorsMixin={_initBehaviors:function(){this._behaviors=this._getBehaviors()},_getBehaviors:function(){var behaviors=_.result(this,"behaviors");return _.isObject(behaviors)?parseBehaviors(this,behaviors):{}},_getBehaviorTriggers:function(){var triggers=_invoke(this._behaviors,"getTriggers");return _.extend.apply(_,[{}].concat(_toConsumableArray(triggers)))},_getBehaviorEvents:function(){var events=_invoke(this._behaviors,"getEvents");return _.extend.apply(_,[{}].concat(_toConsumableArray(events)))},_proxyBehaviorViewProperties:function(){_invoke(this._behaviors,"proxyViewProperties")},_delegateBehaviorEntityEvents:function(){_invoke(this._behaviors,"delegateEntityEvents")},_undelegateBehaviorEntityEvents:function(){_invoke(this._behaviors,"undelegateEntityEvents")},_destroyBehaviors:function(args){_invoke.apply(void 0,[this._behaviors,"destroy"].concat(_toConsumableArray(args)))},_bindBehaviorUIElements:function(){_invoke(this._behaviors,"bindUIElements")},_unbindBehaviorUIElements:function(){_invoke(this._behaviors,"unbindUIElements")},_triggerEventOnBehaviors:function(){for(var behaviors=this._behaviors,i=0,length=behaviors&&behaviors.length;i<length;i++)triggerMethod$1.apply(behaviors[i],arguments)}},DelegateEntityEventsMixin={_delegateEntityEvents:function(model,collection){this._undelegateEntityEvents(model,collection);var modelEvents=_.result(this,"modelEvents");bindEvents.call(this,model,modelEvents);var collectionEvents=_.result(this,"collectionEvents");bindEvents.call(this,collection,collectionEvents)},_undelegateEntityEvents:function(model,collection){var modelEvents=_.result(this,"modelEvents");unbindEvents.call(this,model,modelEvents);var collectionEvents=_.result(this,"collectionEvents");unbindEvents.call(this,collection,collectionEvents)}},delegateEventSplitter=/^(\S+)\s*(.*)$/,getUniqueEventName=function(eventName){var match=eventName.match(delegateEventSplitter);return uniqueName(match[1],match[2])},FEATURES={triggersStopPropagation:!0,triggersPreventDefault:!0},TriggersMixin={_getViewTriggers:function(view,triggers){return _.reduce(triggers,function(events,value,key){return key=getUniqueEventName(key),events[key]=buildViewTrigger(view,value),events},{})}},_normalizeUIKeys=function(hash,ui){return _.reduce(hash,function(memo,val,key){return memo[_normalizeUIString(key,ui)]=val,memo},{})},_normalizeUIString=function(uiString,ui){return uiString.replace(/@ui\.[a-zA-Z-_$0-9]*/g,function(r){return ui[r.slice(4)]})},_normalizeUIValues=function _normalizeUIValues(hash,ui,properties){return _.each(hash,function(val,key){_.isString(val)?hash[key]=_normalizeUIString(val,ui):_.isObject(val)&&_.isArray(properties)&&(_.extend(val,_normalizeUIValues(_.pick(val,properties),ui)),_.each(properties,function(property){var propertyVal=val[property];_.isString(propertyVal)&&(val[property]=_normalizeUIString(propertyVal,ui))}))}),hash},UIMixin={normalizeUIKeys:function(hash){var uiBindings=this._getUIBindings();return _normalizeUIKeys(hash,uiBindings)},normalizeUIString:function(uiString){var uiBindings=this._getUIBindings();return _normalizeUIString(uiString,uiBindings)},normalizeUIValues:function(hash,properties){var uiBindings=this._getUIBindings();return _normalizeUIValues(hash,uiBindings,properties)},_getUIBindings:function(){var uiBindings=_.result(this,"_uiBindings"),ui=_.result(this,"ui");return uiBindings||ui},_bindUIElements:function(){var _this=this;if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var bindings=_.result(this,"_uiBindings");this._ui={},_.each(bindings,function(selector,key){_this._ui[key]=_this.$(selector)}),this.ui=this._ui}},_unbindUIElements:function(){var _this2=this;this.ui&&this._uiBindings&&(_.each(this.ui,function($el,name){delete _this2.ui[name]}),this.ui=this._uiBindings,delete this._uiBindings,delete this._ui)},_getUI:function(name){return this._ui[name]}},ViewMixin={supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,_isDestroyed:!1,isDestroyed:function(){return!!this._isDestroyed},_isRendered:!1,isRendered:function(){return!!this._isRendered},_isAttached:!1,isAttached:function(){return!!this._isAttached},delegateEvents:function(eventsArg){this._proxyBehaviorViewProperties(),this._buildEventProxies();var viewEvents=this._getEvents(eventsArg);void 0===eventsArg&&(this.events=viewEvents);var combinedEvents=_.extend({},this._getBehaviorEvents(),viewEvents,this._getBehaviorTriggers(),this.getTriggers());return Backbone.View.prototype.delegateEvents.call(this,combinedEvents),this},_getEvents:function(eventsArg){var events=eventsArg||this.events;return _.isFunction(events)?this.normalizeUIKeys(events.call(this)):this.normalizeUIKeys(events)},getTriggers:function(){if(this.triggers){var triggers=this.normalizeUIKeys(_.result(this,"triggers"));return this._getViewTriggers(this,triggers)}},delegateEntityEvents:function(){return this._delegateEntityEvents(this.model,this.collection),this._delegateBehaviorEntityEvents(),this},undelegateEntityEvents:function(){return this._undelegateEntityEvents(this.model,this.collection),this._undelegateBehaviorEntityEvents(),this},destroy:function(){if(this._isDestroyed)return this;for(var shouldTriggerDetach=!!this._isAttached,_len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return this.triggerMethod.apply(this,["before:destroy",this].concat(args)),shouldTriggerDetach&&this.triggerMethod("before:detach",this),this.unbindUIElements(),this.removeEl(this.el),shouldTriggerDetach&&(this._isAttached=!1,this.triggerMethod("detach",this)),this._removeChildren(),this._destroyBehaviors(args),this._isDestroyed=!0,this._isRendered=!1,this.triggerMethod.apply(this,["destroy",this].concat(args)),this.stopListening(),this},bindUIElements:function(){return this._bindUIElements(),this._bindBehaviorUIElements(),this},unbindUIElements:function(){return this._unbindUIElements(),this._unbindBehaviorUIElements(),this},getUI:function(name){return this._getUI(name)},childViewEventPrefix:"childview",triggerMethod:function(){var ret=triggerMethod$1.apply(this,arguments);return this._triggerEventOnBehaviors.apply(this,arguments),ret},_buildEventProxies:function(){this._childViewEvents=_.result(this,"childViewEvents"),this._childViewTriggers=_.result(this,"childViewTriggers")},_proxyChildViewEvents:function(view){this.listenTo(view,"all",this._childViewEventHandler)},_childViewEventHandler:function(eventName){for(var childViewEvents=this.normalizeMethods(this._childViewEvents),_len2=arguments.length,args=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];void 0!==childViewEvents&&_.isFunction(childViewEvents[eventName])&&childViewEvents[eventName].apply(this,args);var childViewTriggers=this._childViewTriggers;childViewTriggers&&_.isString(childViewTriggers[eventName])&&this.triggerMethod.apply(this,[childViewTriggers[eventName]].concat(args));var prefix=_.result(this,"childViewEventPrefix");if(!1!==prefix){var childEventName=prefix+":"+eventName;this.triggerMethod.apply(this,[childEventName].concat(args))}}};_.extend(ViewMixin,DomMixin,BehaviorsMixin,CommonMixin,DelegateEntityEventsMixin,TriggersMixin,UIMixin);var ClassOptions$2=["allowMissingEl","parentEl","replaceElement"],Region=MarionetteObject.extend({cidPrefix:"mnr",replaceElement:!1,_isReplaced:!1,constructor:function(options){if(this._setOptions(options),this.mergeOptions(options,ClassOptions$2),this._initEl=this.el=this.getOption("el"),this.el=this.el instanceof Backbone.$?this.el[0]:this.el,!this.el)throw new MarionetteError({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),MarionetteObject.call(this,options)},show:function(view,options){if(this._ensureElement(options))return(view=this._getView(view,options))===this.currentView?this:(this.triggerMethod("before:show",this,view,options),view._isAttached||this.empty(options),this._setupChildView(view),this._renderView(view),this._attachView(view,options),this.currentView=view,this.triggerMethod("show",this,view,options),this)},_setupChildView:function(view){monitorViewEvents(view),this._proxyChildViewEvents(view),view.on("destroy",this._empty,this)},_proxyChildViewEvents:function(view){var parentView=this._parentView;parentView&&parentView._proxyChildViewEvents(view)},_renderView:function(view){view._isRendered||(view.supportsRenderLifecycle||triggerMethodOn(view,"before:render",view),view.render(),view.supportsRenderLifecycle||(view._isRendered=!0,triggerMethodOn(view,"render",view)))},_attachView:function(view){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},shouldTriggerAttach=!view._isAttached&&isNodeAttached(this.el),shouldReplaceEl=void 0===options.replaceElement?!!_.result(this,"replaceElement"):!!options.replaceElement;shouldTriggerAttach&&triggerMethodOn(view,"before:attach",view),shouldReplaceEl?this._replaceEl(view):this.attachHtml(view),shouldTriggerAttach&&(view._isAttached=!0,triggerMethodOn(view,"attach",view))},_ensureElement:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(void 0===options.allowMissingEl?!!_.result(this,"allowMissingEl"):!!options.allowMissingEl)return!1;throw new MarionetteError('An "el" must exist in DOM for this region '+this.cid)}return!0},_getView:function(view){if(!view)throw new MarionetteError({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(view._isDestroyed)throw new MarionetteError({name:"ViewDestroyedError",message:'View (cid: "'+view.cid+'") has already been destroyed and cannot be used.'});if(view instanceof Backbone.View)return view;var viewOptions=this._getViewOptions(view);return new View(viewOptions)},_getViewOptions:function(viewOptions){return _.isFunction(viewOptions)?{template:viewOptions}:_.isObject(viewOptions)?viewOptions:{template:function(){return viewOptions}}},getEl:function(el){return this.findEls(el,_.result(this,"parentEl"))},_replaceEl:function(view){this._restoreEl(),view.on("before:destroy",this._restoreEl,this),this.replaceEl(view.el,this.el),this._isReplaced=!0},_restoreEl:function(){if(this._isReplaced){var view=this.currentView;view&&(this.replaceEl(this.el,view.el),this._isReplaced=!1)}},isReplaced:function(){return!!this._isReplaced},attachHtml:function(view){this.appendChildren(this.el,view.el)},empty:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{allowMissingEl:!0},view=this.currentView;if(!view)return this._ensureElement(options)&&this.detachHtml(),this;var shouldDestroy=!options.preventDestroy;return shouldDestroy||deprecate("The preventDestroy option is deprecated. Use Region#detachView"),this._empty(view,shouldDestroy),this},_empty:function(view,shouldDestroy){view.off("destroy",this._empty,this),this.triggerMethod("before:empty",this,view),this._restoreEl(),delete this.currentView,view._isDestroyed||(this._removeView(view,shouldDestroy),this._stopChildViewEvents(view)),this.triggerMethod("empty",this,view)},_stopChildViewEvents:function(view){this._parentView&&this._parentView.stopListening(view)},_removeView:function(view,shouldDestroy){if(!shouldDestroy)return void this._detachView(view);view.destroy?view.destroy():destroyBackboneView(view)},detachView:function(){var view=this.currentView;if(view)return this._empty(view),view},_detachView:function(view){var shouldTriggerDetach=!!view._isAttached;shouldTriggerDetach&&triggerMethodOn(view,"before:detach",view),this.detachHtml(),shouldTriggerDetach&&(view._isAttached=!1,triggerMethodOn(view,"detach",view))},detachHtml:function(){this.detachContents(this.el)},hasView:function(){return!!this.currentView},reset:function(options){return this.empty(options),this.$el&&(this.el=this._initEl),delete this.$el,this},destroy:function(options){return this.reset(options),MarionetteObject.prototype.destroy.apply(this,arguments)}});_.extend(Region.prototype,DomMixin);var buildRegion=function(definition,defaults){return definition instanceof Region?definition:buildRegionFromDefinition(definition,defaults)},RegionsMixin={regionClass:Region,_initRegions:function(){this.regions=this.regions||{},this._regions={},this.addRegions(_.result(this,"regions"))},_reInitRegions:function(){_invoke(this._regions,"reset")},addRegion:function(name,definition){var regions={};return regions[name]=definition,this.addRegions(regions)[name]},addRegions:function(regions){if(!_.isEmpty(regions))return regions=this.normalizeUIValues(regions,["selector","el"]),this.regions=_.extend({},this.regions,regions),this._addRegions(regions)},_addRegions:function(regionDefinitions){var _this=this,defaults={regionClass:this.regionClass,parentEl:_.partial(_.result,this,"el")};return _.reduce(regionDefinitions,function(regions,definition,name){return regions[name]=buildRegion(definition,defaults),_this._addRegion(regions[name],name),regions},{})},_addRegion:function(region,name){this.triggerMethod("before:add:region",this,name,region),region._parentView=this,this._regions[name]=region,this.triggerMethod("add:region",this,name,region)},removeRegion:function(name){var region=this._regions[name];return this._removeRegion(region,name),region},removeRegions:function(){var regions=this.getRegions();return _.each(this._regions,_.bind(this._removeRegion,this)),regions},_removeRegion:function(region,name){this.triggerMethod("before:remove:region",this,name,region),region.destroy(),delete this.regions[name],delete this._regions[name],this.triggerMethod("remove:region",this,name,region)},emptyRegions:function(){var regions=this.getRegions();return _invoke(regions,"empty"),regions},hasRegion:function(name){return!!this.getRegion(name)},getRegion:function(name){return this._regions[name]},getRegions:function(){return _.clone(this._regions)},showChildView:function(name,view){for(var region=this.getRegion(name),_len=arguments.length,args=Array(_len>2?_len-2:0),_key=2;_key<_len;_key++)args[_key-2]=arguments[_key];return region.show.apply(region,[view].concat(args))},detachChildView:function(name){return this.getRegion(name).detachView()},getChildView:function(name){return this.getRegion(name).currentView}},Renderer={render:function(template,data){if(!template)throw new MarionetteError({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});return(_.isFunction(template)?template:TemplateCache.get(template))(data)}},ClassOptions$1=["behaviors","childViewEventPrefix","childViewEvents","childViewTriggers","collectionEvents","events","modelEvents","regionClass","regions","template","templateContext","triggers","ui"],View=Backbone.View.extend({constructor:function(options){this.render=_.bind(this.render,this),this._setOptions(options),this.mergeOptions(options,ClassOptions$1),monitorViewEvents(this),this._initBehaviors(),this._initRegions();var args=Array.prototype.slice.call(arguments);args[0]=this.options,Backbone.View.prototype.constructor.apply(this,args),this.delegateEntityEvents()},serializeData:function(){return this.model||this.collection?this.model?this.serializeModel():{items:this.serializeCollection()}:{}},serializeModel:function(){return this.model?_.clone(this.model.attributes):{}},serializeCollection:function(){return this.collection?this.collection.map(function(model){return _.clone(model.attributes)}):{}},setElement:function(){var hasEl=!!this.el;return Backbone.View.prototype.setElement.apply(this,arguments),hasEl&&(this._isRendered=!!this.$el.length,this._isAttached=isNodeAttached(this.el)),this._isRendered&&this.bindUIElements(),this},render:function(){return this._isDestroyed?this:(this.triggerMethod("before:render",this),this._isRendered&&this._reInitRegions(),this._renderTemplate(),this.bindUIElements(),this._isRendered=!0,this.triggerMethod("render",this),this)},_renderTemplate:function(){var template=this.getTemplate();if(!1!==template){var data=this.mixinTemplateContext(this.serializeData()),html=Renderer.render(template,data,this);this.attachElContent(html)}},getTemplate:function(){return this.template},mixinTemplateContext:function(){var target=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},templateContext=_.result(this,"templateContext");return _.extend(target,templateContext)},attachElContent:function(html){return this.setInnerContent(this.el,html),this},_removeChildren:function(){this.removeRegions()},_getImmediateChildren:function(){return _.chain(this.getRegions()).map("currentView").compact().value()}});_.extend(View.prototype,ViewMixin,RegionsMixin);var methods=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"],Container=function(views){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),_.each(views,_.bind(this.add,this))};!function(object,listProperty){_.each(methods,function(method){object[method]=function(){var list=_.values(_.result(this,listProperty)),args=[list].concat(_.toArray(arguments));return _[method].apply(_,args)}})}(Container.prototype,"_views"),_.extend(Container.prototype,{add:function(view,customIndex){return this._add(view,customIndex)._updateLength()},_add:function(view,customIndex){var viewCid=view.cid;return this._views[viewCid]=view,view.model&&(this._indexByModel[view.model.cid]=viewCid),customIndex&&(this._indexByCustom[customIndex]=viewCid),this},findByModel:function(model){return this.findByModelCid(model.cid)},findByModelCid:function(modelCid){var viewCid=this._indexByModel[modelCid];return this.findByCid(viewCid)},findByCustom:function(index){var viewCid=this._indexByCustom[index];return this.findByCid(viewCid)},findByIndex:function(index){return _.values(this._views)[index]},findByCid:function(cid){return this._views[cid]},remove:function(view){return this._remove(view)._updateLength()},_remove:function(view){var viewCid=view.cid;return view.model&&delete this._indexByModel[view.model.cid],_.some(this._indexByCustom,_.bind(function(cid,key){if(cid===viewCid)return delete this._indexByCustom[key],!0},this)),delete this._views[viewCid],this},_updateLength:function(){return this.length=_.size(this._views),this}});var ClassOptions$3=["behaviors","childView","childViewEventPrefix","childViewEvents","childViewOptions","childViewTriggers","collectionEvents","events","filter","emptyView","emptyViewOptions","modelEvents","reorderOnSort","sort","triggers","ui","viewComparator"],CollectionView=Backbone.View.extend({sort:!0,constructor:function(options){this.render=_.bind(this.render,this),this._setOptions(options),this.mergeOptions(options,ClassOptions$3),monitorViewEvents(this),this._initBehaviors(),this.once("render",this._initialEvents),this._initChildViewStorage(),this._bufferedChildren=[];var args=Array.prototype.slice.call(arguments);args[0]=this.options,Backbone.View.prototype.constructor.apply(this,args),this.delegateEntityEvents()},_startBuffering:function(){this._isBuffering=!0},_endBuffering:function(){var shouldTriggerAttach=!!this._isAttached,triggerOnChildren=shouldTriggerAttach?this._getImmediateChildren():[];this._isBuffering=!1,_.each(triggerOnChildren,function(child){triggerMethodOn(child,"before:attach",child)}),this.attachBuffer(this,this._createBuffer()),_.each(triggerOnChildren,function(child){child._isAttached=!0,triggerMethodOn(child,"attach",child)}),this._bufferedChildren=[]},_getImmediateChildren:function(){return _.values(this.children._views)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"update",this._onCollectionUpdate),this.listenTo(this.collection,"reset",this.render),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(child,collection,opts){var index=void 0!==opts.at&&(opts.index||collection.indexOf(child));(this.filter||!1===index)&&(index=_.indexOf(this._filteredSortedModels(index),child)),this._shouldAddChild(child,index)&&(this._destroyEmptyView(),this._addChild(child,index))},_onCollectionUpdate:function(collection,options){var changes=options.changes;this._removeChildModels(changes.removed)},_removeChildModels:function(models){var removedViews=this._getRemovedViews(models);removedViews.length&&(this.children._updateLength(),this._updateIndices(removedViews,!1),this.isEmpty()&&this._showEmptyView())},_getRemovedViews:function(models){var _this=this;return _.reduce(models,function(removingViews,model){var view=model&&_this.children.findByModel(model);return!view||view._isDestroyed?removingViews:(_this._removeChildView(view),removingViews.push(view),removingViews)},[])},_removeChildView:function(view){this.triggerMethod("before:remove:child",this,view),this.children._remove(view),view.destroy?view.destroy():destroyBackboneView(view),this.stopListening(view),this.triggerMethod("remove:child",this,view)},setElement:function(){var hasEl=!!this.el;return Backbone.View.prototype.setElement.apply(this,arguments),hasEl&&(this._isAttached=isNodeAttached(this.el)),this},render:function(){return this._isDestroyed?this:(this.triggerMethod("before:render",this),this._renderChildren(),this._isRendered=!0,this.triggerMethod("render",this),this)},setFilter:function(filter){var _ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},preventRender=_ref.preventRender,canBeRendered=this._isRendered&&!this._isDestroyed,filterChanged=this.filter!==filter;if(canBeRendered&&filterChanged&&!preventRender){var previousModels=this._filteredSortedModels();this.filter=filter;var models=this._filteredSortedModels();this._applyModelDeltas(models,previousModels)}else this.filter=filter;return this},removeFilter:function(options){return this.setFilter(null,options)},_applyModelDeltas:function(models,previousModels){var _this2=this,currentIds={};_.each(models,function(model,index){!_this2.children.findByModel(model)&&_this2._onCollectionAdd(model,_this2.collection,{at:index}),currentIds[model.cid]=!0});var removeModels=_.filter(previousModels,function(prevModel){return!currentIds[prevModel.cid]&&_this2.children.findByModel(prevModel)});this._removeChildModels(removeModels)},reorder:function(){var _this3=this,children=this.children,models=this._filteredSortedModels();return!models.length&&this._showingEmptyView?this:(_.some(models,function(model){return!children.findByModel(model)})?this.render():function(){var filteredOutModels=[],elsToReorder=children.reduce(function(viewEls,view){var index=_.indexOf(models,view.model);return-1===index?(filteredOutModels.push(view.model),viewEls):(view._index=index,viewEls[index]=view.el,viewEls)},new Array(models.length));_this3.triggerMethod("before:reorder",_this3),_this3._appendReorderedChildren(elsToReorder),_this3._removeChildModels(filteredOutModels),_this3.triggerMethod("reorder",_this3)}(),this)},resortView:function(){return this.reorderOnSort?this.reorder():this._renderChildren(),this},_sortViews:function(){var _this4=this,models=this._filteredSortedModels();_.find(models,function(item,index){var view=_this4.children.findByModel(item);return!view||view._index!==index})&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(children){this.appendChildren(this.el,children)},_renderChildren:function(){this._isRendered&&(this._destroyEmptyView(),this._destroyChildren());var models=this._filteredSortedModels();this.isEmpty({processedModels:models})?this._showEmptyView():(this.triggerMethod("before:render:children",this),this._startBuffering(),this._showCollection(models),this._endBuffering(),this.triggerMethod("render:children",this))},_createView:function(model,index){var ChildView=this._getChildView(model),childViewOptions=this._getChildViewOptions(model,index);return this.buildChildView(model,ChildView,childViewOptions)},_setupChildView:function(view,index){monitorViewEvents(view),this._proxyChildViewEvents(view),this.sort&&(view._index=index)},_showCollection:function(models){_.each(models,_.bind(this._addChild,this)),this.children._updateLength()},_filteredSortedModels:function(addedAt){if(!this.collection||!this.collection.length)return[];var viewComparator=this.getViewComparator(),models=this.collection.models;if(addedAt=Math.min(Math.max(addedAt,0),models.length-1),viewComparator){var addedModel=void 0;addedAt&&(addedModel=models[addedAt],models=models.slice(0,addedAt).concat(models.slice(addedAt+1))),models=this._sortModelsBy(models,viewComparator),addedModel&&models.splice(addedAt,0,addedModel)}return models=this._filterModels(models)},getViewComparator:function(){return this.viewComparator},_filterModels:function(models){var _this5=this;return this.filter&&(models=_.filter(models,function(model,index){return _this5._shouldAddChild(model,index)})),models},_sortModelsBy:function(models,comparator){return"string"==typeof comparator?_.sortBy(models,function(model){return model.get(comparator)}):1===comparator.length?_.sortBy(models,_.bind(comparator,this)):_.clone(models).sort(_.bind(comparator,this))},_showEmptyView:function(){var EmptyView=this._getEmptyView();if(EmptyView&&!this._showingEmptyView){this._showingEmptyView=!0;var model=new Backbone.Model,emptyViewOptions=this.emptyViewOptions||this.childViewOptions;_.isFunction(emptyViewOptions)&&(emptyViewOptions=emptyViewOptions.call(this,model,this._emptyViewIndex));var view=this.buildChildView(model,EmptyView,emptyViewOptions);this.triggerMethod("before:render:empty",this,view),this.addChildView(view,0),this.triggerMethod("render:empty",this,view)}},_destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty",this),this._destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty",this))},_getEmptyView:function(){var emptyView=this.emptyView;if(emptyView)return this._getView(emptyView)},_getChildView:function(child){var childView=this.childView;if(!childView)throw new MarionetteError({name:"NoChildViewError",message:'A "childView" must be specified'});if(!(childView=this._getView(childView,child)))throw new MarionetteError({name:"InvalidChildViewError",message:'"childView" must be a view class or a function that returns a view class'});return childView},_getView:function(view,child){return view.prototype instanceof Backbone.View||view===Backbone.View?view:_.isFunction(view)?view.call(this,child):void 0},_addChild:function(child,index){var view=this._createView(child,index);return this.addChildView(view,index),view},_getChildViewOptions:function(child,index){return _.isFunction(this.childViewOptions)?this.childViewOptions(child,index):this.childViewOptions},addChildView:function(view,index){return this.triggerMethod("before:add:child",this,view),this._setupChildView(view,index),this._isBuffering?this.children._add(view):(this._updateIndices(view,!0),this.children.add(view)),this._renderView(view),this._attachView(view,index),this.triggerMethod("add:child",this,view),view},_updateIndices:function(views,increment){if(this.sort){if(!increment)return void _.each(_.sortBy(this.children._views,"_index"),function(view,index){view._index=index});var view=_.isArray(views)?_.max(views,"_index"):views;_.isObject(view)&&this.children.each(function(laterView){laterView._index>=view._index&&(laterView._index+=1)})}},_renderView:function(view){view._isRendered||(view.supportsRenderLifecycle||triggerMethodOn(view,"before:render",view),view.render(),view.supportsRenderLifecycle||(view._isRendered=!0,triggerMethodOn(view,"render",view)))},_attachView:function(view,index){var shouldTriggerAttach=!view._isAttached&&!this._isBuffering&&this._isAttached;shouldTriggerAttach&&triggerMethodOn(view,"before:attach",view),this.attachHtml(this,view,index),shouldTriggerAttach&&(view._isAttached=!0,triggerMethodOn(view,"attach",view))},buildChildView:function(child,ChildViewClass,childViewOptions){return new ChildViewClass(_.extend({model:child},childViewOptions))},removeChildView:function(view){return!view||view._isDestroyed?view:(this._removeChildView(view),this.children._updateLength(),this._updateIndices(view,!1),view)},isEmpty:function(options){var models=void 0;return _.result(options,"processedModels")?models=options.processedModels:(models=this.collection?this.collection.models:[],models=this._filterModels(models)),0===models.length},attachBuffer:function(collectionView,buffer){this.appendChildren(collectionView.el,buffer)},_createBuffer:function(){var _this6=this,elBuffer=this.createBuffer();return _.each(this._bufferedChildren,function(b){_this6.appendChildren(elBuffer,b.el)}),elBuffer},attachHtml:function(collectionView,childView,index){collectionView._isBuffering?collectionView._bufferedChildren.splice(index,0,childView):collectionView._insertBefore(childView,index)||collectionView._insertAfter(childView)},_insertBefore:function(childView,index){var currentView=void 0;return this.sort&&index<this.children.length-1&&(currentView=this.children.find(function(view){return view._index===index+1})),!!currentView&&(this.beforeEl(currentView.el,childView.el),!0)},_insertAfter:function(childView){this.appendChildren(this.el,childView.el)},_initChildViewStorage:function(){this.children=new Container},_removeChildren:function(){this._destroyChildren()},_destroyChildren:function(options){this.children.length&&(this.triggerMethod("before:destroy:children",this),this.children.each(_.bind(this._removeChildView,this)),this.children._updateLength(),this.triggerMethod("destroy:children",this))},_shouldAddChild:function(child,index){var filter=this.filter;return!_.isFunction(filter)||filter.call(this,child,index,this.collection)}});_.extend(CollectionView.prototype,ViewMixin);var ClassOptions$4=["childViewContainer","template","templateContext"],CompositeView=CollectionView.extend({constructor:function(options){deprecate("CompositeView is deprecated. Convert to View at your earliest convenience"),this.mergeOptions(options,ClassOptions$4),CollectionView.prototype.constructor.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"update",this._onCollectionUpdate),this.listenTo(this.collection,"reset",this.renderChildren),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_getChildView:function(child){var childView=this.childView;if(!childView)return this.constructor;if(!(childView=this._getView(childView,child)))throw new MarionetteError({name:"InvalidChildViewError",message:'"childView" must be a view class or a function that returns a view class'});return childView},serializeData:function(){return this.serializeModel()},render:function(){return this._isDestroyed?this:(this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this.bindUIElements(),this.renderChildren(),this._isRendering=!1,this._isRendered=!0,this.triggerMethod("render",this),this)},renderChildren:function(){(this._isRendered||this._isRendering)&&CollectionView.prototype._renderChildren.call(this)},attachBuffer:function(compositeView,buffer){var $container=this.getChildViewContainer(compositeView);this.appendChildren($container,buffer)},_insertAfter:function(childView){var $container=this.getChildViewContainer(this,childView);this.appendChildren($container,childView.el)},_appendReorderedChildren:function(children){var $container=this.getChildViewContainer(this);this.appendChildren($container,children)},getChildViewContainer:function(containerView,childView){if(containerView.$childViewContainer)return containerView.$childViewContainer;var container=void 0;if(containerView.childViewContainer){var selector=_.result(containerView,"childViewContainer");if(container="@"===selector.charAt(0)&&containerView.ui?containerView.ui[selector.substr(4)]:this.findEls(selector,containerView.$el),container.length<=0)throw new MarionetteError({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+containerView.childViewContainer})}else container=containerView.$el;return containerView.$childViewContainer=container,container},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),MixinFromView=_.pick(View.prototype,"serializeModel","getTemplate","_renderTemplate","mixinTemplateContext","attachElContent");_.extend(CompositeView.prototype,MixinFromView);var ClassOptions$5=["collectionEvents","events","modelEvents","triggers","ui"],Behavior=MarionetteObject.extend({cidPrefix:"mnb",constructor:function(options,view){this.view=view,this.defaults=_.clone(_.result(this,"defaults",{})),this._setOptions(this.defaults,options),this.mergeOptions(this.options,ClassOptions$5),this.ui=_.extend({},_.result(this,"ui"),_.result(view,"ui")),MarionetteObject.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(){return this.$el=this.view.$el,this.el=this.view.el,this},bindUIElements:function(){return this._bindUIElements(),this},unbindUIElements:function(){return this._unbindUIElements(),this},getUI:function(name){return this._getUI(name)},delegateEntityEvents:function(){return this._delegateEntityEvents(this.view.model,this.view.collection),this},undelegateEntityEvents:function(){return this._undelegateEntityEvents(this.view.model,this.view.collection),this},getEvents:function(){var _this=this,behaviorEvents=this.normalizeUIKeys(_.result(this,"events"));return _.reduce(behaviorEvents,function(events,behaviorHandler,key){if(_.isFunction(behaviorHandler)||(behaviorHandler=_this[behaviorHandler]),behaviorHandler)return key=getUniqueEventName(key),events[key]=_.bind(behaviorHandler,_this),events},{})},getTriggers:function(){if(this.triggers){var behaviorTriggers=this.normalizeUIKeys(_.result(this,"triggers"));return this._getViewTriggers(this.view,behaviorTriggers)}}});_.extend(Behavior.prototype,DelegateEntityEventsMixin,TriggersMixin,UIMixin);var ClassOptions$6=["region","regionClass"],Application=MarionetteObject.extend({cidPrefix:"mna",constructor:function(options){this._setOptions(options),this.mergeOptions(options,ClassOptions$6),this._initRegion(),MarionetteObject.prototype.constructor.apply(this,arguments)},regionClass:Region,_initRegion:function(){var region=this.region;if(region){var defaults={regionClass:this.regionClass};this._region=buildRegion(region,defaults)}},getRegion:function(){return this._region},showView:function(view){for(var region=this.getRegion(),_len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];return region.show.apply(region,[view].concat(args))},getView:function(){return this.getRegion().currentView},start:function(options){return this.triggerMethod("before:start",this,options),this.triggerMethod("start",this,options),this}}),ClassOptions$7=["appRoutes","controller"],AppRouter=Backbone.Router.extend({constructor:function(options){this._setOptions(options),this.mergeOptions(options,ClassOptions$7),Backbone.Router.apply(this,arguments);var appRoutes=this.appRoutes,controller=this._getController();this.processAppRoutes(controller,appRoutes),this.on("route",this._processOnRoute,this)},appRoute:function(route,methodName){var controller=this._getController();return this._addAppRoute(controller,route,methodName),this},_processOnRoute:function(routeName,routeArgs){if(_.isFunction(this.onRoute)){var routePath=_.invert(this.appRoutes)[routeName];this.onRoute(routeName,routePath,routeArgs)}},processAppRoutes:function(controller,appRoutes){var _this=this;if(!appRoutes)return this;var routeNames=_.keys(appRoutes).reverse();return _.each(routeNames,function(route){_this._addAppRoute(controller,route,appRoutes[route])}),this},_getController:function(){return this.controller},_addAppRoute:function(controller,route,methodName){var method=controller[methodName];if(!method)throw new MarionetteError('Method "'+methodName+'" was not found on the controller');this.route(route,methodName,_.bind(method,controller))},triggerMethod:triggerMethod$1});_.extend(AppRouter.prototype,CommonMixin);var previousMarionette=Backbone.Marionette,Marionette=Backbone.Marionette={};return Marionette.noConflict=function(){return Backbone.Marionette=previousMarionette,this},Marionette.bindEvents=proxy(bindEvents),Marionette.unbindEvents=proxy(unbindEvents),Marionette.bindRequests=proxy(bindRequests),Marionette.unbindRequests=proxy(unbindRequests),Marionette.mergeOptions=proxy(mergeOptions),Marionette.getOption=proxy(getOption),Marionette.normalizeMethods=proxy(normalizeMethods),Marionette.extend=extend,Marionette.isNodeAttached=isNodeAttached,Marionette.deprecate=deprecate,Marionette.triggerMethod=proxy(triggerMethod$1),Marionette.triggerMethodOn=triggerMethodOn,Marionette.isEnabled=isEnabled,Marionette.setEnabled=setEnabled,Marionette.monitorViewEvents=monitorViewEvents,Marionette.Behaviors={},Marionette.Behaviors.behaviorsLookup=behaviorsLookup,Marionette.Application=Application,Marionette.AppRouter=AppRouter,Marionette.Renderer=Renderer,Marionette.TemplateCache=TemplateCache,Marionette.View=View,Marionette.CollectionView=CollectionView,Marionette.CompositeView=CompositeView,Marionette.Behavior=Behavior,Marionette.Region=Region,Marionette.Error=MarionetteError,Marionette.Object=MarionetteObject,Marionette.DEV_MODE=!1,Marionette.FEATURES=FEATURES,Marionette.VERSION="3.2.0",Marionette})},16:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(10),__webpack_require__(24),__webpack_require__(4),__webpack_require__(5),__webpack_require__(2),__webpack_require__(178)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,Marionette,SuperModel,_,jQuery,MailPoet){"use strict";var Module={},AugmentedView=Marionette.View.extend({});return Module.BlockModel=SuperModel.extend({stale:[],initialize:function(){this.on("change",function(){this._updateDefaults(),App.getChannel().trigger("autoSave")})},_getDefaults:function(blockDefaults,configDefaults){var defaults;return defaults=_.isObject(configDefaults)&&_.isFunction(configDefaults.toJSON)?configDefaults.toJSON():configDefaults,JSON.parse(JSON.stringify(jQuery.extend(blockDefaults,defaults||{})))},_updateDefaults:function(){var context=this.get("context")||this.get("type");App.getConfig().set("blockDefaults."+context,this.toJSON())},toJSON:function(){return _.omit(SuperModel.prototype.toJSON.call(this),this.stale)},getChildren:function(){return[]}}),Module.BlockView=AugmentedView.extend({regions:{toolsRegion:"> .mailpoet_tools"},modelEvents:{change:"render",delete:"deleteBlock",duplicate:"duplicateBlock"},events:{mouseenter:"showTools",mouseleave:"hideTools"},behaviors:{DraggableBehavior:{cloneOriginal:!0,hideOriginal:!0,onDrop:function(options){options.dragBehavior.view.model.destroy()},onDragSubstituteBy:function(behavior){var WidgetView,node;if(_.isFunction(behavior.view.onDragSubstituteBy))return WidgetView=new(behavior.view.onDragSubstituteBy()),WidgetView.render(),node=WidgetView.$el.get(0).cloneNode(!0),WidgetView.destroy(),node}},HighlightEditingBehavior:{}},templateContext:function(){return{model:this.model.toJSON(),viewCid:this.cid}},constructor:function(){AugmentedView.apply(this,arguments),this.$el.addClass("mailpoet_editor_view_"+this.cid)},initialize:function(){this.on("showSettings",this.showSettings,this),this.on("dom:refresh",this.showBlock,this),this._isFirstRender=!0},showTools:function(){this.showingToolsDisabled||(this.$("> .mailpoet_tools").addClass("mailpoet_display_tools"),this.toolsView.triggerMethod("showTools"))},hideTools:function(){this.$("> .mailpoet_tools").removeClass("mailpoet_display_tools"),this.toolsView.triggerMethod("hideTools")},enableShowingTools:function(){this.showingToolsDisabled=!1},disableShowingTools:function(){this.showingToolsDisabled=!0,this.hideTools()},showSettings:function(options){this.toolsView.triggerMethod("showSettings",options)},getDropFunc:function(){return function(){return this.model.clone()}.bind(this)},disableDragging:function(){this.$el.addClass("mailpoet_ignore_drag")},enableDragging:function(){this.$el.removeClass("mailpoet_ignore_drag")},showBlock:function(){this._isFirstRender&&(this.transitionIn(),this._isFirstRender=!1)},deleteBlock:function(){this.transitionOut().then(function(){this.model.destroy()}.bind(this))},duplicateBlock:function(){this.model.collection.add(this.model.toJSON(),{at:this.model.collection.findIndex(this.model)})},transitionIn:function(){return this._transition("slideDown","fadeIn","easeOut")},transitionOut:function(){return this._transition("slideUp","fadeOut","easeIn")},_transition:function(slideDirection,fadeDirection,easing){var promise=jQuery.Deferred();return this.$el.velocity(slideDirection,{duration:250,easing:easing,complete:function(){promise.resolve()}}).velocity(fadeDirection,{duration:250,easing:easing,queue:!1}),promise}}),Module.BlockToolsView=AugmentedView.extend({getTemplate:function(){return window.templates.genericBlockTools},events:{"click .mailpoet_edit_block":"changeSettings","click .mailpoet_delete_block_activate":"showDeletionConfirmation","click .mailpoet_delete_block_cancel":"hideDeletionConfirmation","click .mailpoet_delete_block_confirm":"deleteBlock","click .mailpoet_duplicate_block":"duplicateBlock"},tools:{settings:!0,delete:!0,duplicate:!0,move:!0},getSettingsView:function(){return Module.BlockSettingsView},initialize:function(opts){var options=opts||{};_.isUndefined(options.tools)||(this.tools=jQuery.extend({},this.tools,options.tools||{})),this.on("hideTools",this.hideDeletionConfirmation,this),this.on("showSettings",this.changeSettings)},templateContext:function(){return{model:this.model.toJSON(),viewCid:this.cid,tools:this.tools}},changeSettings:function(options){new(this.getSettingsView())(_.extend({model:this.model},options||{})).render()},showDeletionConfirmation:function(){this.$(".mailpoet_delete_block").closest(".mailpoet_block").find("> .mailpoet_block_highlight").css({background:"#E64047",opacity:.5}),this.$(".mailpoet_delete_block").addClass("mailpoet_delete_block_activated")},hideDeletionConfirmation:function(){this.$(".mailpoet_delete_block").closest(".mailpoet_block").find("> .mailpoet_block_highlight").css({background:"transparent",opacity:1}),this.$(".mailpoet_delete_block").removeClass("mailpoet_delete_block_activated")},deleteBlock:function(event){return event.preventDefault(),this.model.trigger("delete"),!1},duplicateBlock:function(event){return event.preventDefault(),this.model.trigger("duplicate"),!1}}),Module.BlockSettingsView=Marionette.View.extend({className:"mailpoet_editor_settings",behaviors:{ColorPickerBehavior:{}},initialize:function(params){var panelParams;this.model.trigger("startEditing"),panelParams={element:this.$el,template:"",position:"right",width:App.getConfig().get("sidepanelWidth"),onCancel:function(){this.destroy()}.bind(this)},this.renderOptions=params.renderOptions||{},"subpanel"===this.renderOptions.displayFormat?MailPoet.Modal.subpanel(panelParams):MailPoet.Modal.panel(panelParams)},templateContext:function(){return{model:this.model.toJSON()}},close:function(){this.destroy()},changeField:function(field,event){this.model.set(field,jQuery(event.target).val())},changePixelField:function(field,event){this.changeFieldWithSuffix(field,event,"px")},changeFieldWithSuffix:function(field,event,suffix){this.model.set(field,jQuery(event.target).val()+suffix)},changeBoolField:function(field,event){this.model.set(field,"true"===jQuery(event.target).val())},changeBoolCheckboxField:function(field,event){this.model.set(field,!!jQuery(event.target).prop("checked"))},changeColorField:function(field,event){var value=jQuery(event.target).val();""===value&&(value="transparent"),this.model.set(field,value)},onBeforeDestroy:function(){MailPoet.Modal.close(),this.model.trigger("stopEditing")}}),Module.WidgetView=Marionette.View.extend({className:"mailpoet_widget mailpoet_droppable_block mailpoet_droppable_widget",behaviors:{DraggableBehavior:{drop:function(){throw new Error("Unsupported operation")}}}}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},189:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(2),__webpack_require__(4),__webpack_require__(5)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,MailPoet,_,jQuery){"use strict";var Module={},base=BaseBlock;return Module.ButtonBlockModel=base.BlockModel.extend({defaults:function(){return this._getDefaults({type:"button",text:"Button",url:"",styles:{block:{backgroundColor:"#ff0000",borderColor:"#cccccc",borderWidth:"1px",borderRadius:"4px",borderStyle:"solid",width:"200px",lineHeight:"40px",fontColor:"#000000",fontFamily:"Arial",fontSize:"16px",fontWeight:"normal",textAlign:"center"}}},App.getConfig().get("blockDefaults.button"))}}),Module.ButtonBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_button_block mailpoet_droppable_block",getTemplate:function(){return window.templates.buttonBlock},onDragSubstituteBy:function(){return Module.ButtonWidgetView},behaviors:_.extend({},base.BlockView.prototype.behaviors,{ShowSettingsBehavior:{}}),initialize:function(){base.BlockView.prototype.initialize.apply(this,arguments),this._replaceButtonStylesHandler=function(data){this.model.set(data)}.bind(this),App.getChannel().on("replaceAllButtonStyles",this._replaceButtonStylesHandler)},onRender:function(){this.toolsView=new Module.ButtonBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)}}),Module.ButtonBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.ButtonBlockSettingsView}}),Module.ButtonBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.buttonBlockSettings},events:function(){return{"input .mailpoet_field_button_text":_.partial(this.changeField,"text"),"input .mailpoet_field_button_url":_.partial(this.changeField,"url"),"change .mailpoet_field_button_alignment":_.partial(this.changeField,"styles.block.textAlign"),"change .mailpoet_field_button_font_color":_.partial(this.changeColorField,"styles.block.fontColor"),"change .mailpoet_field_button_font_family":_.partial(this.changeField,"styles.block.fontFamily"),"change .mailpoet_field_button_font_size":_.partial(this.changeField,"styles.block.fontSize"),"change .mailpoet_field_button_background_color":_.partial(this.changeColorField,"styles.block.backgroundColor"),"change .mailpoet_field_button_border_color":_.partial(this.changeColorField,"styles.block.borderColor"),"change .mailpoet_field_button_font_weight":"changeFontWeight","input .mailpoet_field_button_border_width":_.partial(this.updateValueAndCall,".mailpoet_field_button_border_width_input",_.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"change .mailpoet_field_button_border_width":_.partial(this.updateValueAndCall,".mailpoet_field_button_border_width_input",_.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"input .mailpoet_field_button_border_width_input":_.partial(this.updateValueAndCall,".mailpoet_field_button_border_width",_.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"input .mailpoet_field_button_border_radius":_.partial(this.updateValueAndCall,".mailpoet_field_button_border_radius_input",_.partial(this.changePixelField,"styles.block.borderRadius").bind(this)),"change .mailpoet_field_button_border_radius":_.partial(this.updateValueAndCall,".mailpoet_field_button_border_radius_input",_.partial(this.changePixelField,"styles.block.borderRadius").bind(this)),"input .mailpoet_field_button_border_radius_input":_.partial(this.updateValueAndCall,".mailpoet_field_button_border_radius",_.partial(this.changePixelField,"styles.block.borderRadius").bind(this)),"input .mailpoet_field_button_width":_.partial(this.updateValueAndCall,".mailpoet_field_button_width_input",_.partial(this.changePixelField,"styles.block.width").bind(this)),"change .mailpoet_field_button_width":_.partial(this.updateValueAndCall,".mailpoet_field_button_width_input",_.partial(this.changePixelField,"styles.block.width").bind(this)),"input .mailpoet_field_button_width_input":_.partial(this.updateValueAndCall,".mailpoet_field_button_width",_.partial(this.changePixelField,"styles.block.width").bind(this)),"input .mailpoet_field_button_line_height":_.partial(this.updateValueAndCall,".mailpoet_field_button_line_height_input",_.partial(this.changePixelField,"styles.block.lineHeight").bind(this)),"change .mailpoet_field_button_line_height":_.partial(this.updateValueAndCall,".mailpoet_field_button_line_height_input",_.partial(this.changePixelField,"styles.block.lineHeight").bind(this)),"input .mailpoet_field_button_line_height_input":_.partial(this.updateValueAndCall,".mailpoet_field_button_line_height",_.partial(this.changePixelField,"styles.block.lineHeight").bind(this)),"click .mailpoet_field_button_replace_all_styles":"applyToAll","click .mailpoet_done_editing":"close"}},templateContext:function(){return _.extend({},base.BlockView.prototype.templateContext.apply(this,arguments),{availableStyles:App.getAvailableStyles().toJSON(),renderOptions:this.renderOptions})},applyToAll:function(){App.getChannel().trigger("replaceAllButtonStyles",_.pick(this.model.toJSON(),"styles","type"))},updateValueAndCall:function(fieldToUpdate,callable,event){this.$(fieldToUpdate).val(jQuery(event.target).val()),callable(event)},changeFontWeight:function(event){var checked=!!jQuery(event.target).prop("checked");this.model.set("styles.block.fontWeight",checked?jQuery(event.target).val():"normal")}}),Module.ButtonWidgetView=base.WidgetView.extend({getTemplate:function(){return window.templates.buttonInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.ButtonBlockModel}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("button",{blockModel:Module.ButtonBlockModel,blockView:Module.ButtonBlockView}),BeforeStartApp.registerWidget({name:"button",widgetView:Module.ButtonWidgetView,priority:92})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},19:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(BackboneMarionette){var Marionette=BackboneMarionette,BehaviorsLookup={};return Marionette.Behaviors.behaviorsLookup=function(){return BehaviorsLookup},window.BehaviorsLookup=BehaviorsLookup,BehaviorsLookup}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},190:function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(4),__webpack_require__(5)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,_,jQuery){var Module={},base=BaseBlock;return Module.DividerBlockModel=base.BlockModel.extend({defaults:function(){return this._getDefaults({type:"divider",styles:{block:{backgroundColor:"transparent",padding:"12px",borderStyle:"solid",borderWidth:"1px",borderColor:"#000000"}}},App.getConfig().get("blockDefaults.divider"))}}),Module.DividerBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_divider_block mailpoet_droppable_block",getTemplate:function(){return window.templates.dividerBlock},modelEvents:_.omit(base.BlockView.prototype.modelEvents,"change"),behaviors:_.defaults({ResizableBehavior:{elementSelector:".mailpoet_content",resizeHandleSelector:".mailpoet_resize_handle",transformationFunction:function(y){return y/2},minLength:0,modelField:"styles.block.padding"},ShowSettingsBehavior:{ignoreFrom:".mailpoet_resize_handle"}},base.BlockView.prototype.behaviors),onDragSubstituteBy:function(){return Module.DividerWidgetView},initialize:function(){var that=this;base.BlockView.prototype.initialize.apply(this,arguments),this._replaceDividerHandler=function(data){that.model.set(data),that.model.trigger("applyToAll")},App.getChannel().on("replaceAllDividers",this._replaceDividerHandler),this.listenTo(this.model,"change:src change:styles.block.backgroundColor change:styles.block.borderStyle change:styles.block.borderWidth change:styles.block.borderColor applyToAll",this.render),this.listenTo(this.model,"change:styles.block.padding",this.changePadding)},templateContext:function(){return _.extend({totalHeight:2*parseInt(this.model.get("styles.block.padding"),10)+parseInt(this.model.get("styles.block.borderWidth"),10)+"px"},base.BlockView.prototype.templateContext.apply(this))},onRender:function(){this.toolsView=new Module.DividerBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)},onBeforeDestroy:function(){App.getChannel().off("replaceAllDividers",this._replaceDividerHandler),this.stopListening(this.model)},changePadding:function(){this.$(".mailpoet_content").css("padding-top",this.model.get("styles.block.padding")),this.$(".mailpoet_content").css("padding-bottom",this.model.get("styles.block.padding")),this.$(".mailpoet_resize_handle_text").text(2*parseInt(this.model.get("styles.block.padding"),10)+parseInt(this.model.get("styles.block.borderWidth"),10)+"px")}}),Module.DividerBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.DividerBlockSettingsView}}),Module.DividerBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.dividerBlockSettings},events:function(){return{"click .mailpoet_field_divider_style":"changeStyle","input .mailpoet_field_divider_border_width":_.partial(this.updateValueAndCall,".mailpoet_field_divider_border_width_input",_.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"change .mailpoet_field_divider_border_width":_.partial(this.updateValueAndCall,".mailpoet_field_divider_border_width_input",_.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"input .mailpoet_field_divider_border_width_input":_.partial(this.updateValueAndCall,".mailpoet_field_divider_border_width",_.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"change .mailpoet_field_divider_border_color":_.partial(this.changeColorField,"styles.block.borderColor"),"change .mailpoet_field_divider_background_color":_.partial(this.changeColorField,"styles.block.backgroundColor"),"click .mailpoet_button_divider_apply_to_all":"applyToAll","click .mailpoet_done_editing":"close"}},modelEvents:function(){return{"change:styles.block.borderColor":"repaintDividerStyleOptions"}},templateContext:function(){return _.extend({},base.BlockView.prototype.templateContext.apply(this,arguments),{availableStyles:App.getAvailableStyles().toJSON(),renderOptions:this.renderOptions})},changeStyle:function(event){var style=jQuery(event.currentTarget).data("style");this.model.set("styles.block.borderStyle",style),this.$(".mailpoet_field_divider_style").removeClass("mailpoet_active_divider_style"),this.$('.mailpoet_field_divider_style[data-style="'+style+'"]').addClass("mailpoet_active_divider_style")},repaintDividerStyleOptions:function(){this.$(".mailpoet_field_divider_style > div").css("border-top-color",this.model.get("styles.block.borderColor"))},applyToAll:function(){App.getChannel().trigger("replaceAllDividers",this.model.toJSON())},updateValueAndCall:function(fieldToUpdate,callable,event){this.$(fieldToUpdate).val(jQuery(event.target).val()),callable(event)}}),Module.DividerWidgetView=base.WidgetView.extend({getTemplate:function(){return window.templates.dividerInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.DividerBlockModel}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("divider",{blockModel:Module.DividerBlockModel,blockView:Module.DividerBlockView}),BeforeStartApp.registerWidget({name:"divider",widgetView:Module.DividerWidgetView,priority:93})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},24:function(module,exports){Backbone.SuperModel=function(_,Backbone){var _triggerNestedChanges=function(path){for(var m=path.length-1;m>=0;m--){var p=path.slice(0,m),q=path.slice(m);if(1!=q.length){p=p.join(".");var target=this;p.length>0&&(target=this.get(p));for(var tmp=_.first(q),rest=_.rest(q),paths=[tmp],n=0;n<rest.length;n++)tmp=[tmp,rest[n]].join("."),paths.push(tmp);for(var l=0;l<paths.length;l++){var _p=paths[l],trigger=target.trigger;trigger&&_.isFunction(trigger)&&trigger.call(target,"change:"+_p,target,target.get(_p))}}}},processKeyPath=function(keyPath){return _.isString(keyPath)&&(keyPath=keyPath.split(".")),keyPath},getObjectValue=function(obj,path,def){path=processKeyPath(path);for(var len=path.length,i=0;i<len;i++){if(!obj||"object"!=typeof obj)return def;obj=obj[path[i]]}return void 0===obj?def:obj},walkObject=function(obj,keyPath,doThing){keyPath=processKeyPath(keyPath),lastKeyIndex=keyPath.length-1;for(var i=0;i<lastKeyIndex;++i)key=keyPath[i],key in obj||(obj[key]={}),obj=obj[key];doThing(obj,keyPath[lastKeyIndex])},setObjectValue=function(obj,keyPath,value){walkObject(obj,keyPath,function(destination,lastKey){destination[lastKey]=value})},deleteObjectKey=function(obj,keyPath){walkObject(obj,keyPath,function(destination,lastKey){delete destination[lastKey]})},hasObjectKey=function(obj,keyPath){var hasKey=!1;return walkObject(obj,keyPath,function(destination,lastKey){hasKey=_.has(destination,lastKey)}),hasKey},walkNestedAttributes=function(model,keyPath,doThing){keyPath=processKeyPath(keyPath);var first=_.first(keyPath),nestedModel=model.get(first);nestedModel instanceof Backbone.Model&&walkNestedAttributes(nestedModel,_.rest(keyPath),doThing),doThing(model,keyPath)},getRelation=function(obj,attr,value){var relation;if(attr){relation=_.result(obj,"relations")[attr]}return value&&!relation&&(relation=Model),void 0==relation&&(relation=Model),relation},setupBackref=function(obj,instance,options){var name=_.result(obj,"name");return name&&!instance[name]&&(instance[name]=obj),instance},isSimpleObject=function(value){return value.constructor===Object},Model=Backbone.Model.extend({relations:{},unsafeAttributes:[],name:null,_valueForCollection:function(value){return!!_.isArray(value)&&(!(value.length>=1)||_.isObject(value[0]))},_nestedSet:function(path,value,options){path=path.split(".");for(var lastKeyIndex=path.length-1,obj=this,i=0;i<lastKeyIndex;++i){var key=path[i];if(!obj.attributes[key]){var relation=getRelation(obj,key,value),instance=new relation;obj.attributes[key]=setupBackref(obj,instance)}obj=obj.attributes[key]}var finalPath=path[lastKeyIndex];if(!_.isArray(value)&&_.isObject(value)&&isSimpleObject(value))if(0===_.size(value))obj.attributes[finalPath]=new Model;else for(var j in value){var newPath=finalPath+"."+j;obj._nestedSet(newPath,value[j],options)}else if(this._valueForCollection(value)){var _relation=getRelation(obj,finalPath,value);_relation.prototype instanceof Backbone.Model&&(_relation=Collection);var collection=new _relation(value);collection=setupBackref(obj,collection),obj.attributes[finalPath]=collection}else 1==path.length?obj.attributes[finalPath]=value:obj.set(finalPath,value,_.extend({skipNested:!0,forceChange:!0},options));options.silent||_triggerNestedChanges.call(this,path)},_setChanging:function(){this._previousAttributes=this.toJSON(),this.changed={}},_triggerChanges:function(changes,options,changeValue){changes.length&&(this._pending=!0);for(var i=0,l=changes.length;i<l;i++)changeValue||(changeValue=this.get(changes[i])),1==changes[i].split(".").length&&this.trigger("change:"+changes[i],this,changeValue,options)},_setChange:function(attr,val,options){var currentValue=this.get(attr);return attr=attr.split("."),!_.isEqual(currentValue,val)||options.forceChange?(setObjectValue(this.changed,attr,val),!0):(deleteObjectKey(this.changed,attr),!1)},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,skipNested;if(null==key)return this;if("object"==typeof key?(attrs=key,options=val):(attrs={},attrs[key]=val),options=options||{},!this._validate(attrs,options))return!1;unset=options.unset,silent=options.silent,changes=[],changing=this._changing,skipNested=options.skipNested,this._changing=!0,changing||this._setChanging(),this.idAttribute in attrs&&(this.id=attrs[this.idAttribute]);var unsetAttribute=function(destination,realKey){delete destination.attributes[realKey]};for(attr in attrs)val=attrs[attr],this._setChange(attr,val,options)&&changes.push(attr),unset?walkNestedAttributes(this,attr,unsetAttribute):skipNested?this.attributes[attr]=val:this._nestedSet(attr,val,options);if(silent||this._triggerChanges(changes,options),changing)return this;if(!silent)for(;this._pending;)this._pending=!1,this.trigger("change",this,options);return this._pending=!1,this._changing=!1,this},get:function(attr){var nestedAttrs=attr?attr.split("."):[];if(nestedAttrs.length>1){var nestedAttr=this.attributes[_.first(nestedAttrs)];if(!nestedAttr)return;var rest=_.rest(nestedAttrs).join(".");return _.isFunction(nestedAttr.get)?nestedAttr.get(rest):nestedAttr[rest]}return this.attributes[attr]},toJSON:function(options){options=options||{};var unsafeAttributes=_.result(this,"unsafeAttributes");options.except&&(unsafeAttributes=_.union(unsafeAttributes,options.except));var attributes=_.clone(this.attributes);return _.each(unsafeAttributes,function(attr){delete attributes[attr]}),_.each(attributes,function(val,key){val&&_.isFunction(val.toJSON)&&(attributes[key]=val.toJSON())}),attributes},hasChanged:function(attr){return null==attr?!_.isEmpty(this.changed):hasObjectKey(this.changed,attr)},previous:function(attr){return null!=attr&&this._previousAttributes?getObjectValue(this._previousAttributes,attr):null},clear:function(options){this.id=void 0;for(var key in this.attributes){var val=this.attributes[key];val instanceof Backbone.Model?val.clear():val instanceof Backbone.Collection?val.reset():this.unset(key)}return this}}),Collection=Backbone.Collection.extend({model:Model});return Model}(_,Backbone),module.exports=Backbone.SuperModel},270:function(module,exports,__webpack_require__){!function(global,factory){module.exports=factory(__webpack_require__(4),__webpack_require__(18))}(0,function(_,Backbone){"use strict";function removeHandler(store,name,callback,context){var event=store[name];if(!(callback&&callback!==event.callback&&callback!==event.callback._callback||context&&context!==event.context))return delete store[name],!0}function removeHandlers(store,name,callback,context){store||(store={});for(var names=name?[name]:_.keys(store),matched=!1,i=0,length=names.length;i<length;i++)name=names[i],store[name]&&removeHandler(store,name,callback,context)&&(matched=!0);return matched}function _partial(channelName){return _logs[channelName]||(_logs[channelName]=_.bind(Radio.log,Radio,channelName))}function makeCallback(callback){return _.isFunction(callback)?callback:function(){return callback}}_="default"in _?_.default:_,Backbone="default"in Backbone?Backbone.default:Backbone;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},previousRadio=Backbone.Radio,Radio=Backbone.Radio={};Radio.VERSION="2.0.0",Radio.noConflict=function(){return Backbone.Radio=previousRadio,this},Radio.DEBUG=!1,Radio._debugText=function(warning,eventName,channelName){return warning+(channelName?" on the "+channelName+" channel":"")+': "'+eventName+'"'},Radio.debugLog=function(warning,eventName,channelName){Radio.DEBUG&&console&&console.warn&&console.warn(Radio._debugText(warning,eventName,channelName))};var eventSplitter=/\s+/;Radio._eventsApi=function(obj,action,name,rest){if(!name)return!1;var results={};if("object"===(void 0===name?"undefined":_typeof(name))){for(var key in name){var result=obj[action].apply(obj,[key,name[key]].concat(rest));eventSplitter.test(key)?_.extend(results,result):results[key]=result}return results}if(eventSplitter.test(name)){for(var names=name.split(eventSplitter),i=0,l=names.length;i<l;i++)results[names[i]]=obj[action].apply(obj,[names[i]].concat(rest));return results}return!1},Radio._callHandler=function(callback,context,args){var a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:return callback.call(context);case 1:return callback.call(context,a1);case 2:return callback.call(context,a1,a2);case 3:return callback.call(context,a1,a2,a3);default:return callback.apply(context,args)}};var _logs={};_.extend(Radio,{log:function(channelName,eventName){if("undefined"!=typeof console){var args=_.toArray(arguments).slice(2);console.log("["+channelName+'] "'+eventName+'"',args)}},tuneIn:function(channelName){var channel=Radio.channel(channelName);return channel._tunedIn=!0,channel.on("all",_partial(channelName)),this},tuneOut:function(channelName){var channel=Radio.channel(channelName);return channel._tunedIn=!1,channel.off("all",_partial(channelName)),delete _logs[channelName],this}}),Radio.Requests={request:function(name){var args=_.toArray(arguments).slice(1),results=Radio._eventsApi(this,"request",name,args);if(results)return results;var channelName=this.channelName,requests=this._requests;if(channelName&&this._tunedIn&&Radio.log.apply(this,[channelName,name].concat(args)),requests&&(requests[name]||requests.default)){var handler=requests[name]||requests.default;return args=requests[name]?args:arguments,Radio._callHandler(handler.callback,handler.context,args)}Radio.debugLog("An unhandled request was fired",name,channelName)},reply:function(name,callback,context){return Radio._eventsApi(this,"reply",name,[callback,context])?this:(this._requests||(this._requests={}),this._requests[name]&&Radio.debugLog("A request was overwritten",name,this.channelName),this._requests[name]={callback:makeCallback(callback),context:context||this},this)},replyOnce:function(name,callback,context){if(Radio._eventsApi(this,"replyOnce",name,[callback,context]))return this;var self=this,once=_.once(function(){return self.stopReplying(name),makeCallback(callback).apply(this,arguments)});return this.reply(name,once,context)},stopReplying:function(name,callback,context){return Radio._eventsApi(this,"stopReplying",name)?this:(name||callback||context?removeHandlers(this._requests,name,callback,context)||Radio.debugLog("Attempted to remove the unregistered request",name,this.channelName):delete this._requests,this)}},Radio._channels={},Radio.channel=function(channelName){if(!channelName)throw new Error("You must provide a name for the channel.");return Radio._channels[channelName]?Radio._channels[channelName]:Radio._channels[channelName]=new Radio.Channel(channelName)},Radio.Channel=function(channelName){this.channelName=channelName},_.extend(Radio.Channel.prototype,Backbone.Events,Radio.Requests,{reset:function(){return this.off(),this.stopListening(),this.stopReplying(),this}});var channel,args,systems=[Backbone.Events,Radio.Requests];return _.each(systems,function(system){_.each(system,function(method,methodName){Radio[methodName]=function(channelName){return args=_.toArray(arguments).slice(1),channel=this.channel(channelName),channel[methodName].apply(channel,args)}})}),Radio.reset=function(channelName){var channels=channelName?[this._channels[channelName]]:this._channels;_.each(channels,function(channel){channel.reset()})},Radio})},271:function(module,exports,__webpack_require__){!function(realWindow){"use strict";function blank(){}function isElement(o){if(!o||"object"!=typeof o)return!1;var _window=getWindow(o)||window;return/object|function/.test(typeof _window.Element)?o instanceof _window.Element:1===o.nodeType&&"string"==typeof o.nodeName}function isWindow(thing){return thing===window||!(!thing||!thing.Window)&&thing instanceof thing.Window}function isDocFrag(thing){return!!thing&&thing instanceof DocumentFragment}function isArray(thing){return isObject(thing)&&void 0!==typeof thing.length&&isFunction(thing.splice)}function isObject(thing){return!!thing&&"object"==typeof thing}function isFunction(thing){return"function"==typeof thing}function isNumber(thing){return"number"==typeof thing}function isBool(thing){return"boolean"==typeof thing}function isString(thing){return"string"==typeof thing}function trySelector(value){return!!isString(value)&&(document.querySelector(value),!0)}function extend(dest,source){for(var prop in source)dest[prop]=source[prop];return dest}function pointerExtend(dest,source){for(var prop in source){var deprecated=!1;for(var vendor in prefixedPropREs)if(0===prop.indexOf(vendor)&&prefixedPropREs[vendor].test(prop)){deprecated=!0;break}deprecated||(dest[prop]=source[prop])}return dest}function copyCoords(dest,src){dest.page=dest.page||{},dest.page.x=src.page.x,dest.page.y=src.page.y,dest.client=dest.client||{},dest.client.x=src.client.x,dest.client.y=src.client.y,dest.timeStamp=src.timeStamp}function setEventXY(targetObj,pointers,interaction){var pointer=pointers.length>1?pointerAverage(pointers):pointers[0];getPageXY(pointer,tmpXY),targetObj.page.x=tmpXY.x,targetObj.page.y=tmpXY.y,getClientXY(pointer,tmpXY),targetObj.client.x=tmpXY.x,targetObj.client.y=tmpXY.y,targetObj.timeStamp=(new Date).getTime()}function setEventDeltas(targetObj,prev,cur){targetObj.page.x=cur.page.x-prev.page.x,targetObj.page.y=cur.page.y-prev.page.y,targetObj.client.x=cur.client.x-prev.client.x,targetObj.client.y=cur.client.y-prev.client.y,targetObj.timeStamp=(new Date).getTime()-prev.timeStamp;var dt=Math.max(targetObj.timeStamp/1e3,.001);targetObj.page.speed=hypot(targetObj.page.x,targetObj.page.y)/dt,targetObj.page.vx=targetObj.page.x/dt,targetObj.page.vy=targetObj.page.y/dt,targetObj.client.speed=hypot(targetObj.client.x,targetObj.page.y)/dt,targetObj.client.vx=targetObj.client.x/dt,targetObj.client.vy=targetObj.client.y/dt}function isNativePointer(pointer){return pointer instanceof window.Event||supportsTouch&&window.Touch&&pointer instanceof window.Touch}function getXY(type,pointer,xy){return xy=xy||{},type=type||"page",xy.x=pointer[type+"X"],xy.y=pointer[type+"Y"],xy}function getPageXY(pointer,page){return page=page||{},isOperaMobile&&isNativePointer(pointer)?(getXY("screen",pointer,page),page.x+=window.scrollX,page.y+=window.scrollY):getXY("page",pointer,page),page}function getClientXY(pointer,client){return client=client||{},isOperaMobile&&isNativePointer(pointer)?getXY("screen",pointer,client):getXY("client",pointer,client),client}function getScrollXY(win){return win=win||window,{x:win.scrollX||win.document.documentElement.scrollLeft,y:win.scrollY||win.document.documentElement.scrollTop}}function getPointerId(pointer){return isNumber(pointer.pointerId)?pointer.pointerId:pointer.identifier}function getActualElement(element){return element instanceof SVGElementInstance?element.correspondingUseElement:element}function getWindow(node){if(isWindow(node))return node;var rootNode=node.ownerDocument||node;return rootNode.defaultView||rootNode.parentWindow||window}function getElementClientRect(element){var clientRect=element instanceof SVGElement?element.getBoundingClientRect():element.getClientRects()[0];return clientRect&&{left:clientRect.left,right:clientRect.right,top:clientRect.top,bottom:clientRect.bottom,width:clientRect.width||clientRect.right-clientRect.left,height:clientRect.height||clientRect.bottom-clientRect.top}}function getElementRect(element){var clientRect=getElementClientRect(element);if(!isIOS7&&clientRect){var scroll=getScrollXY(getWindow(element));clientRect.left+=scroll.x,clientRect.right+=scroll.x,clientRect.top+=scroll.y,clientRect.bottom+=scroll.y}return clientRect}function getTouchPair(event){var touches=[];return isArray(event)?(touches[0]=event[0],touches[1]=event[1]):"touchend"===event.type?1===event.touches.length?(touches[0]=event.touches[0],touches[1]=event.changedTouches[0]):0===event.touches.length&&(touches[0]=event.changedTouches[0],touches[1]=event.changedTouches[1]):(touches[0]=event.touches[0],touches[1]=event.touches[1]),touches}function pointerAverage(pointers){for(var prop,average={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},i=0;i<pointers.length;i++)for(prop in average)average[prop]+=pointers[i][prop];for(prop in average)average[prop]/=pointers.length;return average}function touchBBox(event){if(event.length||event.touches&&event.touches.length>1){var touches=getTouchPair(event),minX=Math.min(touches[0].pageX,touches[1].pageX),minY=Math.min(touches[0].pageY,touches[1].pageY);return{x:minX,y:minY,left:minX,top:minY,width:Math.max(touches[0].pageX,touches[1].pageX)-minX,height:Math.max(touches[0].pageY,touches[1].pageY)-minY}}}function touchDistance(event,deltaSource){deltaSource=deltaSource||defaultOptions.deltaSource;var sourceX=deltaSource+"X",sourceY=deltaSource+"Y",touches=getTouchPair(event),dx=touches[0][sourceX]-touches[1][sourceX],dy=touches[0][sourceY]-touches[1][sourceY];return hypot(dx,dy)}function touchAngle(event,prevAngle,deltaSource){deltaSource=deltaSource||defaultOptions.deltaSource;var sourceX=deltaSource+"X",sourceY=deltaSource+"Y",touches=getTouchPair(event),dx=touches[0][sourceX]-touches[1][sourceX],dy=touches[0][sourceY]-touches[1][sourceY],angle=180*Math.atan(dy/dx)/Math.PI;if(isNumber(prevAngle)){var dr=angle-prevAngle,drClamped=dr%360;drClamped>315?angle-=360+angle/360|0:drClamped>135?angle-=180+angle/360|0:drClamped<-315?angle+=360+angle/360|0:drClamped<-135&&(angle+=180+angle/360|0)}return angle}function getOriginXY(interactable,element){var origin=interactable?interactable.options.origin:defaultOptions.origin;return"parent"===origin?origin=parentElement(element):"self"===origin?origin=interactable.getRect(element):trySelector(origin)&&(origin=closest(element,origin)||{x:0,y:0}),isFunction(origin)&&(origin=origin(interactable&&element)),isElement(origin)&&(origin=getElementRect(origin)),origin.x="x"in origin?origin.x:origin.left,origin.y="y"in origin?origin.y:origin.top,origin}function _getQBezierValue(t,p1,p2,p3){var iT=1-t;return iT*iT*p1+2*iT*t*p2+t*t*p3}function getQuadraticCurvePoint(startX,startY,cpX,cpY,endX,endY,position){return{x:_getQBezierValue(position,startX,cpX,endX),y:_getQBezierValue(position,startY,cpY,endY)}}function easeOutQuad(t,b,c,d){return t/=d,-c*t*(t-2)+b}function nodeContains(parent,child){for(;child;){if(child===parent)return!0;child=child.parentNode}return!1}function closest(child,selector){for(var parent=parentElement(child);isElement(parent);){if(matchesSelector(parent,selector))return parent;parent=parentElement(parent)}return null}function parentElement(node){var parent=node.parentNode;if(isDocFrag(parent)){for(;(parent=parent.host)&&isDocFrag(parent););return parent}return parent}function inContext(interactable,element){return interactable._context===element.ownerDocument||nodeContains(interactable._context,element)}function testIgnore(interactable,interactableElement,element){var ignoreFrom=interactable.options.ignoreFrom;return!(!ignoreFrom||!isElement(element))&&(isString(ignoreFrom)?matchesUpTo(element,ignoreFrom,interactableElement):!!isElement(ignoreFrom)&&nodeContains(ignoreFrom,element))}function testAllow(interactable,interactableElement,element){var allowFrom=interactable.options.allowFrom;return!allowFrom||!!isElement(element)&&(isString(allowFrom)?matchesUpTo(element,allowFrom,interactableElement):!!isElement(allowFrom)&&nodeContains(allowFrom,element))}function checkAxis(axis,interactable){if(!interactable)return!1;var thisAxis=interactable.options.drag.axis;return"xy"===axis||"xy"===thisAxis||thisAxis===axis}function checkSnap(interactable,action){var options=interactable.options;return/^resize/.test(action)&&(action="resize"),options[action].snap&&options[action].snap.enabled}function checkRestrict(interactable,action){var options=interactable.options;return/^resize/.test(action)&&(action="resize"),options[action].restrict&&options[action].restrict.enabled}function checkAutoScroll(interactable,action){var options=interactable.options;return/^resize/.test(action)&&(action="resize"),options[action].autoScroll&&options[action].autoScroll.enabled}function withinInteractionLimit(interactable,element,action){for(var options=interactable.options,maxActions=options[action.name].max,maxPerElement=options[action.name].maxPerElement,activeInteractions=0,targetCount=0,targetElementCount=0,i=0,len=interactions.length;i<len;i++){var interaction=interactions[i],otherAction=interaction.prepared.name;if(interaction.interacting()){if(++activeInteractions>=maxInteractions)return!1;if(interaction.target===interactable){if((targetCount+=otherAction===action.name|0)>=maxActions)return!1;if(interaction.element===element&&(targetElementCount++,otherAction!==action.name||targetElementCount>=maxPerElement))return!1}}}return maxInteractions>0}function indexOfDeepestElement(elements){var dropzone,parent,child,i,n,deepestZone=elements[0],index=deepestZone?0:-1,deepestZoneParents=[],dropzoneParents=[];for(i=1;i<elements.length;i++)if((dropzone=elements[i])&&dropzone!==deepestZone)if(deepestZone){if(dropzone.parentNode!==dropzone.ownerDocument)if(deepestZone.parentNode!==dropzone.ownerDocument){if(!deepestZoneParents.length)for(parent=deepestZone;parent.parentNode&&parent.parentNode!==parent.ownerDocument;)deepestZoneParents.unshift(parent),parent=parent.parentNode;if(deepestZone instanceof HTMLElement&&dropzone instanceof SVGElement&&!(dropzone instanceof SVGSVGElement)){if(dropzone===deepestZone.parentNode)continue;parent=dropzone.ownerSVGElement}else parent=dropzone;for(dropzoneParents=[];parent.parentNode!==parent.ownerDocument;)dropzoneParents.unshift(parent),parent=parent.parentNode;for(n=0;dropzoneParents[n]&&dropzoneParents[n]===deepestZoneParents[n];)n++;var parents=[dropzoneParents[n-1],dropzoneParents[n],deepestZoneParents[n]];for(child=parents[0].lastChild;child;){if(child===parents[1]){deepestZone=dropzone,index=i,deepestZoneParents=[];break}if(child===parents[2])break;child=child.previousSibling}}else deepestZone=dropzone,index=i}else deepestZone=dropzone,index=i;return index}function Interaction(){if(this.target=null,this.element=null,this.dropTarget=null,this.dropElement=null,this.prevDropTarget=null,this.prevDropElement=null,this.prepared={name:null,axis:null,edges:null},this.matches=[],this.matchElements=[],this.inertiaStatus={active:!1,smoothEnd:!1,ending:!1,startEvent:null,upCoords:{},xe:0,ye:0,sx:0,sy:0,t0:0,vx0:0,vys:0,duration:0,resumeDx:0,resumeDy:0,lambda_v0:0,one_ve_v0:0,i:null},isFunction(Function.prototype.bind))this.boundInertiaFrame=this.inertiaFrame.bind(this),this.boundSmoothEndFrame=this.smoothEndFrame.bind(this);else{var that=this;this.boundInertiaFrame=function(){return that.inertiaFrame()},this.boundSmoothEndFrame=function(){return that.smoothEndFrame()}}this.activeDrops={dropzones:[],elements:[],rects:[]},this.pointers=[],this.pointerIds=[],this.downTargets=[],this.downTimes=[],this.holdTimers=[],this.prevCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.curCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.startCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.pointerDelta={page:{x:0,y:0,vx:0,vy:0,speed:0},client:{x:0,y:0,vx:0,vy:0,speed:0},timeStamp:0},this.downEvent=null,this.downPointer={},this._eventTarget=null,this._curEventTarget=null,this.prevEvent=null,this.tapTime=0,this.prevTap=null,this.startOffset={left:0,right:0,top:0,bottom:0},this.restrictOffset={left:0,right:0,top:0,bottom:0},this.snapOffsets=[],this.gesture={start:{x:0,y:0},startDistance:0,prevDistance:0,distance:0,scale:1,startAngle:0,prevAngle:0},this.snapStatus={x:0,y:0,dx:0,dy:0,realX:0,realY:0,snappedX:0,snappedY:0,targets:[],locked:!1,changed:!1},this.restrictStatus={dx:0,dy:0,restrictedX:0,restrictedY:0,snap:null,restricted:!1,changed:!1},this.restrictStatus.snap=this.snapStatus,this.pointerIsDown=!1,this.pointerWasMoved=!1,this.gesturing=!1,this.dragging=!1,this.resizing=!1,this.resizeAxes="xy",this.mouse=!1,interactions.push(this)}function getInteractionFromPointer(pointer,eventType,eventTarget){var interaction,i=0,len=interactions.length,mouseEvent=/mouse/i.test(pointer.pointerType||eventType)||4===pointer.pointerType,id=getPointerId(pointer);if(/down|start/i.test(eventType))for(i=0;i<len;i++){interaction=interactions[i];var element=eventTarget;if(interaction.inertiaStatus.active&&interaction.target.options[interaction.prepared.name].inertia.allowResume&&interaction.mouse===mouseEvent)for(;element;){if(element===interaction.element)return interaction;element=parentElement(element)}}if(mouseEvent||!supportsTouch&&!supportsPointerEvent){for(i=0;i<len;i++)if(interactions[i].mouse&&!interactions[i].inertiaStatus.active)return interactions[i];for(i=0;i<len;i++)if(interactions[i].mouse&&(!/down/.test(eventType)||!interactions[i].inertiaStatus.active))return interaction;return interaction=new Interaction,interaction.mouse=!0,interaction}for(i=0;i<len;i++)if(contains(interactions[i].pointerIds,id))return interactions[i];if(/up|end|out/i.test(eventType))return null;for(i=0;i<len;i++)if(interaction=interactions[i],(!interaction.prepared.name||interaction.target.options.gesture.enabled)&&!interaction.interacting()&&(mouseEvent||!interaction.mouse))return interaction;return new Interaction}function doOnInteractions(method){return function(event){var interaction,i,eventTarget=getActualElement(event.path?event.path[0]:event.target),curEventTarget=getActualElement(event.currentTarget);if(supportsTouch&&/touch/.test(event.type))for(prevTouchTime=(new Date).getTime(),i=0;i<event.changedTouches.length;i++){var pointer=event.changedTouches[i];interaction=getInteractionFromPointer(pointer,event.type,eventTarget),interaction&&(interaction._updateEventTargets(eventTarget,curEventTarget),interaction[method](pointer,event,eventTarget,curEventTarget))}else{if(!supportsPointerEvent&&/mouse/.test(event.type)){for(i=0;i<interactions.length;i++)if(!interactions[i].mouse&&interactions[i].pointerIsDown)return;if((new Date).getTime()-prevTouchTime<500)return}if(!(interaction=getInteractionFromPointer(event,event.type,eventTarget)))return;interaction._updateEventTargets(eventTarget,curEventTarget),interaction[method](event,event,eventTarget,curEventTarget)}}}function InteractEvent(interaction,event,action,phase,element,related){var client,page,target=interaction.target,snapStatus=interaction.snapStatus,restrictStatus=interaction.restrictStatus,pointers=interaction.pointers,deltaSource=(target&&target.options||defaultOptions).deltaSource,sourceX=deltaSource+"X",sourceY=deltaSource+"Y",options=target?target.options:defaultOptions,origin=getOriginXY(target,element),starting="start"===phase,ending="end"===phase,coords=starting?interaction.startCoords:interaction.curCoords;element=element||interaction.element,page=extend({},coords.page),client=extend({},coords.client),page.x-=origin.x,page.y-=origin.y,client.x-=origin.x,client.y-=origin.y;var relativePoints=options[action].snap&&options[action].snap.relativePoints;!checkSnap(target,action)||starting&&relativePoints&&relativePoints.length||(this.snap={range:snapStatus.range,locked:snapStatus.locked,x:snapStatus.snappedX,y:snapStatus.snappedY,realX:snapStatus.realX,realY:snapStatus.realY,dx:snapStatus.dx,dy:snapStatus.dy},snapStatus.locked&&(page.x+=snapStatus.dx,page.y+=snapStatus.dy,client.x+=snapStatus.dx,client.y+=snapStatus.dy)),!checkRestrict(target,action)||starting&&options[action].restrict.elementRect||!restrictStatus.restricted||(page.x+=restrictStatus.dx,page.y+=restrictStatus.dy,client.x+=restrictStatus.dx,client.y+=restrictStatus.dy,this.restrict={dx:restrictStatus.dx,dy:restrictStatus.dy}),this.pageX=page.x,this.pageY=page.y,this.clientX=client.x,this.clientY=client.y,this.x0=interaction.startCoords.page.x-origin.x,this.y0=interaction.startCoords.page.y-origin.y,this.clientX0=interaction.startCoords.client.x-origin.x,this.clientY0=interaction.startCoords.client.y-origin.y,this.ctrlKey=event.ctrlKey,this.altKey=event.altKey,this.shiftKey=event.shiftKey,this.metaKey=event.metaKey,this.button=event.button,this.buttons=event.buttons,this.target=element,this.t0=interaction.downTimes[0],this.type=action+(phase||""),this.interaction=interaction,this.interactable=target;var inertiaStatus=interaction.inertiaStatus;if(inertiaStatus.active&&(this.detail="inertia"),related&&(this.relatedTarget=related),ending?"client"===deltaSource?(this.dx=client.x-interaction.startCoords.client.x,this.dy=client.y-interaction.startCoords.client.y):(this.dx=page.x-interaction.startCoords.page.x,this.dy=page.y-interaction.startCoords.page.y):starting?(this.dx=0,this.dy=0):"inertiastart"===phase?(this.dx=interaction.prevEvent.dx,this.dy=interaction.prevEvent.dy):"client"===deltaSource?(this.dx=client.x-interaction.prevEvent.clientX,this.dy=client.y-interaction.prevEvent.clientY):(this.dx=page.x-interaction.prevEvent.pageX,this.dy=page.y-interaction.prevEvent.pageY),interaction.prevEvent&&"inertia"===interaction.prevEvent.detail&&!inertiaStatus.active&&options[action].inertia&&options[action].inertia.zeroResumeDelta&&(inertiaStatus.resumeDx+=this.dx,inertiaStatus.resumeDy+=this.dy,this.dx=this.dy=0),"resize"===action&&interaction.resizeAxes?options.resize.square?("y"===interaction.resizeAxes?this.dx=this.dy:this.dy=this.dx,this.axes="xy"):(this.axes=interaction.resizeAxes,"x"===interaction.resizeAxes?this.dy=0:"y"===interaction.resizeAxes&&(this.dx=0)):"gesture"===action&&(this.touches=[pointers[0],pointers[1]],starting?(this.distance=touchDistance(pointers,deltaSource),this.box=touchBBox(pointers),this.scale=1,this.ds=0,this.angle=touchAngle(pointers,void 0,deltaSource),this.da=0):ending||event instanceof InteractEvent?(this.distance=interaction.prevEvent.distance,this.box=interaction.prevEvent.box,this.scale=interaction.prevEvent.scale,this.ds=this.scale-1,this.angle=interaction.prevEvent.angle,this.da=this.angle-interaction.gesture.startAngle):(this.distance=touchDistance(pointers,deltaSource),this.box=touchBBox(pointers),this.scale=this.distance/interaction.gesture.startDistance,this.angle=touchAngle(pointers,interaction.gesture.prevAngle,deltaSource),this.ds=this.scale-interaction.gesture.prevScale,this.da=this.angle-interaction.gesture.prevAngle)),starting)this.timeStamp=interaction.downTimes[0],this.dt=0,this.duration=0,this.speed=0,this.velocityX=0,this.velocityY=0;else if("inertiastart"===phase)this.timeStamp=interaction.prevEvent.timeStamp,this.dt=interaction.prevEvent.dt,this.duration=interaction.prevEvent.duration,this.speed=interaction.prevEvent.speed,this.velocityX=interaction.prevEvent.velocityX,this.velocityY=interaction.prevEvent.velocityY;else if(this.timeStamp=(new Date).getTime(),this.dt=this.timeStamp-interaction.prevEvent.timeStamp,this.duration=this.timeStamp-interaction.downTimes[0],event instanceof InteractEvent){var dx=this[sourceX]-interaction.prevEvent[sourceX],dy=this[sourceY]-interaction.prevEvent[sourceY],dt=this.dt/1e3;this.speed=hypot(dx,dy)/dt,this.velocityX=dx/dt,this.velocityY=dy/dt}else this.speed=interaction.pointerDelta[deltaSource].speed,this.velocityX=interaction.pointerDelta[deltaSource].vx,this.velocityY=interaction.pointerDelta[deltaSource].vy;if((ending||"inertiastart"===phase)&&interaction.prevEvent.speed>600&&this.timeStamp-interaction.prevEvent.timeStamp<150){var angle=180*Math.atan2(interaction.prevEvent.velocityY,interaction.prevEvent.velocityX)/Math.PI;angle<0&&(angle+=360);var left=112.5<=angle&&angle<247.5,up=202.5<=angle&&angle<337.5,right=!left&&(292.5<=angle||angle<67.5),down=!up&&22.5<=angle&&angle<157.5;this.swipe={up:up,down:down,left:left,right:right,angle:angle,speed:interaction.prevEvent.speed,velocity:{x:interaction.prevEvent.velocityX,y:interaction.prevEvent.velocityY}}}}function preventOriginalDefault(){this.originalEvent.preventDefault()}function getActionCursor(action){var cursor="";if("drag"===action.name&&(cursor=actionCursors.drag),"resize"===action.name)if(action.axis)cursor=actionCursors[action.name+action.axis];else if(action.edges){for(var cursorKey="resize",edgeNames=["top","bottom","left","right"],i=0;i<4;i++)action.edges[edgeNames[i]]&&(cursorKey+=edgeNames[i]);cursor=actionCursors[cursorKey]}return cursor}function checkResizeEdge(name,value,page,element,interactableElement,rect,margin){if(!value)return!1;if(!0===value){var width=isNumber(rect.width)?rect.width:rect.right-rect.left,height=isNumber(rect.height)?rect.height:rect.bottom-rect.top;if(width<0&&("left"===name?name="right":"right"===name&&(name="left")),height<0&&("top"===name?name="bottom":"bottom"===name&&(name="top")),"left"===name)return page.x<(width>=0?rect.left:rect.right)+margin;if("top"===name)return page.y<(height>=0?rect.top:rect.bottom)+margin;if("right"===name)return page.x>(width>=0?rect.right:rect.left)-margin;if("bottom"===name)return page.y>(height>=0?rect.bottom:rect.top)-margin}return!!isElement(element)&&(isElement(value)?value===element:matchesUpTo(element,value,interactableElement))}function defaultActionChecker(pointer,interaction,element){var resizeEdges,rect=this.getRect(element),shouldResize=!1,action=null,resizeAxes=null,page=extend({},interaction.curCoords.page),options=this.options;if(!rect)return null;if(actionIsEnabled.resize&&options.resize.enabled){var resizeOptions=options.resize;if(resizeEdges={left:!1,right:!1,top:!1,bottom:!1},isObject(resizeOptions.edges)){for(var edge in resizeEdges)resizeEdges[edge]=checkResizeEdge(edge,resizeOptions.edges[edge],page,interaction._eventTarget,element,rect,resizeOptions.margin||margin);resizeEdges.left=resizeEdges.left&&!resizeEdges.right,resizeEdges.top=resizeEdges.top&&!resizeEdges.bottom,shouldResize=resizeEdges.left||resizeEdges.right||resizeEdges.top||resizeEdges.bottom}else{var right="y"!==options.resize.axis&&page.x>rect.right-margin,bottom="x"!==options.resize.axis&&page.y>rect.bottom-margin;shouldResize=right||bottom,resizeAxes=(right?"x":"")+(bottom?"y":"")}}return action=shouldResize?"resize":actionIsEnabled.drag&&options.drag.enabled?"drag":null,actionIsEnabled.gesture&&interaction.pointerIds.length>=2&&!interaction.dragging&&!interaction.resizing&&(action="gesture"),action?{name:action,axis:resizeAxes,edges:resizeEdges}:null}function validateAction(action,interactable){if(!isObject(action))return null;var actionName=action.name,options=interactable.options;return("resize"===actionName&&options.resize.enabled||"drag"===actionName&&options.drag.enabled||"gesture"===actionName&&options.gesture.enabled)&&actionIsEnabled[actionName]?("resize"!==actionName&&"resizeyx"!==actionName||(actionName="resizexy"),action):null}function delegateListener(event,useCapture){var fakeEvent={},delegated=delegatedEvents[event.type],eventTarget=getActualElement(event.path?event.path[0]:event.target),element=eventTarget;useCapture=!!useCapture;for(var prop in event)fakeEvent[prop]=event[prop];for(fakeEvent.originalEvent=event,fakeEvent.preventDefault=preventOriginalDefault;isElement(element);){for(var i=0;i<delegated.selectors.length;i++){var selector=delegated.selectors[i],context=delegated.contexts[i];if(matchesSelector(element,selector)&&nodeContains(context,eventTarget)&&nodeContains(context,element)){var listeners=delegated.listeners[i];fakeEvent.currentTarget=element;for(var j=0;j<listeners.length;j++)listeners[j][1]===useCapture&&listeners[j][0](fakeEvent)}}element=parentElement(element)}}function delegateUseCapture(event){return delegateListener.call(this,event,!0)}function interact(element,options){return interactables.get(element,options)||new Interactable(element,options)}function Interactable(element,options){this._element=element,this._iEvents=this._iEvents||{};var _window;if(trySelector(element)){this.selector=element;var context=options&&options.context;_window=context?getWindow(context):window,context&&(_window.Node?context instanceof _window.Node:isElement(context)||context===_window.document)&&(this._context=context)}else _window=getWindow(element),isElement(element,_window)&&(supportsPointerEvent?(events.add(this._element,pEventTypes.down,listeners.pointerDown),events.add(this._element,pEventTypes.move,listeners.pointerHover)):(events.add(this._element,"mousedown",listeners.pointerDown),events.add(this._element,"mousemove",listeners.pointerHover),events.add(this._element,"touchstart",listeners.pointerDown),events.add(this._element,"touchmove",listeners.pointerHover)));this._doc=_window.document,contains(documents,this._doc)||listenToDocument(this._doc),interactables.push(this),this.set(options)}function warnOnce(method,message){var warned=!1;return function(){return warned||(window.console.warn(message),warned=!0),method.apply(this,arguments)}}function endAllInteractions(event){for(var i=0;i<interactions.length;i++)interactions[i].pointerEnd(event,event)}function listenToDocument(doc){if(!contains(documents,doc)){var win=doc.defaultView||doc.parentWindow;for(var eventType in delegatedEvents)events.add(doc,eventType,delegateListener),events.add(doc,eventType,delegateUseCapture,!0);supportsPointerEvent?(pEventTypes=PointerEvent===win.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"},events.add(doc,pEventTypes.down,listeners.selectorDown),events.add(doc,pEventTypes.move,listeners.pointerMove),events.add(doc,pEventTypes.over,listeners.pointerOver),events.add(doc,pEventTypes.out,listeners.pointerOut),events.add(doc,pEventTypes.up,listeners.pointerUp),events.add(doc,pEventTypes.cancel,listeners.pointerCancel),events.add(doc,pEventTypes.move,listeners.autoScrollMove)):(events.add(doc,"mousedown",listeners.selectorDown),events.add(doc,"mousemove",listeners.pointerMove),events.add(doc,"mouseup",listeners.pointerUp),events.add(doc,"mouseover",listeners.pointerOver),events.add(doc,"mouseout",listeners.pointerOut),events.add(doc,"touchstart",listeners.selectorDown),events.add(doc,"touchmove",listeners.pointerMove),events.add(doc,"touchend",listeners.pointerUp),events.add(doc,"touchcancel",listeners.pointerCancel),events.add(doc,"mousemove",listeners.autoScrollMove),events.add(doc,"touchmove",listeners.autoScrollMove)),events.add(win,"blur",endAllInteractions);try{if(win.frameElement){var parentDoc=win.frameElement.ownerDocument,parentWindow=parentDoc.defaultView;events.add(parentDoc,"mouseup",listeners.pointerEnd),events.add(parentDoc,"touchend",listeners.pointerEnd),events.add(parentDoc,"touchcancel",listeners.pointerEnd),events.add(parentDoc,"pointerup",listeners.pointerEnd),events.add(parentDoc,"MSPointerUp",listeners.pointerEnd),events.add(parentWindow,"blur",endAllInteractions)}}catch(error){interact.windowParentError=error}events.add(doc,"dragstart",function(event){for(var i=0;i<interactions.length;i++){var interaction=interactions[i];if(interaction.element&&(interaction.element===event.target||nodeContains(interaction.element,event.target)))return void interaction.checkAndPreventDefault(event,interaction.target,interaction.element)}}),events.useAttachEvent&&(events.add(doc,"selectstart",function(event){var interaction=interactions[0];interaction.currentAction()&&interaction.checkAndPreventDefault(event)}),events.add(doc,"dblclick",doOnInteractions("ie8Dblclick"))),documents.push(doc)}}function indexOf(array,target){for(var i=0,len=array.length;i<len;i++)if(array[i]===target)return i;return-1}function contains(array,target){return-1!==indexOf(array,target)}function matchesSelector(element,selector,nodeList){return ie8MatchesSelector?ie8MatchesSelector(element,selector,nodeList):(window!==realWindow&&(selector=selector.replace(/\/deep\//g," ")),element[prefixedMatchesSelector](selector))}function matchesUpTo(element,selector,limit){for(;isElement(element);){if(matchesSelector(element,selector))return!0;if((element=parentElement(element))===limit)return matchesSelector(element,selector)}return!1}if(realWindow){var pEventTypes,ie8MatchesSelector,window=function(){var el=realWindow.document.createTextNode("");return el.ownerDocument!==realWindow.document&&"function"==typeof realWindow.wrap&&realWindow.wrap(el)===el?realWindow.wrap(realWindow):realWindow}(),document=window.document,DocumentFragment=window.DocumentFragment||blank,SVGElement=window.SVGElement||blank,SVGSVGElement=window.SVGSVGElement||blank,SVGElementInstance=window.SVGElementInstance||blank,HTMLElement=window.HTMLElement||window.Element,PointerEvent=window.PointerEvent||window.MSPointerEvent,hypot=Math.hypot||function(x,y){return Math.sqrt(x*x+y*y)},tmpXY={},documents=[],interactables=[],interactions=[],dynamicDrop=!1,delegatedEvents={},defaultOptions={base:{accept:null,actionChecker:null,styleCursor:!0,preventDefault:"auto",origin:{x:0,y:0},deltaSource:"page",allowFrom:null,ignoreFrom:null,_context:document,dropChecker:null},drag:{enabled:!1,manualStart:!0,max:1/0,maxPerElement:1,snap:null,restrict:null,inertia:null,autoScroll:null,axis:"xy"},drop:{enabled:!1,accept:null,overlap:"pointer"},resize:{enabled:!1,manualStart:!1,max:1/0,maxPerElement:1,snap:null,restrict:null,inertia:null,autoScroll:null,square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},gesture:{manualStart:!1,enabled:!1,max:1/0,maxPerElement:1,restrict:null},perAction:{manualStart:!1,max:1/0,maxPerElement:1,snap:{enabled:!1,endOnly:!1,range:1/0,targets:null,offsets:null,relativePoints:null},restrict:{enabled:!1,endOnly:!1},autoScroll:{enabled:!1,container:null,margin:60,speed:300},inertia:{enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,zeroResumeDelta:!0,smoothEndDuration:300}},_holdDuration:600},autoScroll={interaction:null,i:null,x:0,y:0,scroll:function(){var vx,vy,sx,sy,options=autoScroll.interaction.target.options[autoScroll.interaction.prepared.name].autoScroll,container=options.container||getWindow(autoScroll.interaction.element),now=(new Date).getTime(),dtx=(now-autoScroll.prevTimeX)/1e3,dty=(now-autoScroll.prevTimeY)/1e3;options.velocity?(vx=options.velocity.x,vy=options.velocity.y):vx=vy=options.speed,sx=vx*dtx,sy=vy*dty,(sx>=1||sy>=1)&&(isWindow(container)?container.scrollBy(autoScroll.x*sx,autoScroll.y*sy):container&&(container.scrollLeft+=autoScroll.x*sx,container.scrollTop+=autoScroll.y*sy),sx>=1&&(autoScroll.prevTimeX=now),sy>=1&&(autoScroll.prevTimeY=now)),autoScroll.isScrolling&&(cancelFrame(autoScroll.i),autoScroll.i=reqFrame(autoScroll.scroll))},isScrolling:!1,prevTimeX:0,prevTimeY:0,start:function(interaction){autoScroll.isScrolling=!0,cancelFrame(autoScroll.i),autoScroll.interaction=interaction,autoScroll.prevTimeX=(new Date).getTime(),autoScroll.prevTimeY=(new Date).getTime(),autoScroll.i=reqFrame(autoScroll.scroll)},stop:function(){autoScroll.isScrolling=!1,cancelFrame(autoScroll.i)}},supportsTouch="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportsPointerEvent=PointerEvent&&!/Chrome/.test(navigator.userAgent),margin=supportsTouch||supportsPointerEvent?20:10,pointerMoveTolerance=1,prevTouchTime=0,maxInteractions=1/0,actionCursors=document.all&&!window.atob?{drag:"move",resizex:"e-resize",resizey:"s-resize",resizexy:"se-resize",resizetop:"n-resize",resizeleft:"w-resize",resizebottom:"s-resize",resizeright:"e-resize",resizetopleft:"se-resize",resizebottomright:"se-resize",resizetopright:"ne-resize",resizebottomleft:"ne-resize",gesture:""}:{drag:"move",resizex:"ew-resize",resizey:"ns-resize",resizexy:"nwse-resize",resizetop:"ns-resize",resizeleft:"ew-resize",resizebottom:"ns-resize",resizeright:"ew-resize",resizetopleft:"nwse-resize",resizebottomright:"nwse-resize",resizetopright:"nesw-resize",resizebottomleft:"nesw-resize",gesture:""},actionIsEnabled={drag:!0,resize:!0,gesture:!0},wheelEvent="onmousewheel"in document?"mousewheel":"wheel",eventTypes=["dragstart","dragmove","draginertiastart","dragend","dragenter","dragleave","dropactivate","dropdeactivate","dropmove","drop","resizestart","resizemove","resizeinertiastart","resizeend","gesturestart","gesturemove","gestureinertiastart","gestureend","down","move","up","cancel","tap","doubletap","hold"],globalEvents={},isOperaMobile="Opera"==navigator.appName&&supportsTouch&&navigator.userAgent.match("Presto"),isIOS7=/iP(hone|od|ad)/.test(navigator.platform)&&/OS 7[^\d]/.test(navigator.appVersion),prefixedMatchesSelector="matches"in Element.prototype?"matches":"webkitMatchesSelector"in Element.prototype?"webkitMatchesSelector":"mozMatchesSelector"in Element.prototype?"mozMatchesSelector":"oMatchesSelector"in Element.prototype?"oMatchesSelector":"msMatchesSelector",reqFrame=realWindow.requestAnimationFrame,cancelFrame=realWindow.cancelAnimationFrame,events=function(){function add(element,type,listener,useCapture){var elementIndex=indexOf(elements,element),target=targets[elementIndex];if(target||(target={events:{},typeCount:0},elementIndex=elements.push(element)-1,targets.push(target),attachedListeners.push(useAttachEvent?{supplied:[],wrapped:[],useCount:[]}:null)),target.events[type]||(target.events[type]=[],target.typeCount++),!contains(target.events[type],listener)){var ret;if(useAttachEvent){var listeners=attachedListeners[elementIndex],listenerIndex=indexOf(listeners.supplied,listener),wrapped=listeners.wrapped[listenerIndex]||function(event){event.immediatePropagationStopped||(event.target=event.srcElement,event.currentTarget=element,event.preventDefault=event.preventDefault||preventDef,event.stopPropagation=event.stopPropagation||stopProp,event.stopImmediatePropagation=event.stopImmediatePropagation||stopImmProp,/mouse|click/.test(event.type)&&(event.pageX=event.clientX+getWindow(element).document.documentElement.scrollLeft,event.pageY=event.clientY+getWindow(element).document.documentElement.scrollTop),listener(event))};ret=element[addEvent](on+type,wrapped,Boolean(useCapture)),-1===listenerIndex?(listeners.supplied.push(listener),listeners.wrapped.push(wrapped),listeners.useCount.push(1)):listeners.useCount[listenerIndex]++}else ret=element[addEvent](type,listener,useCapture||!1);return target.events[type].push(listener),ret}}function remove(element,type,listener,useCapture){var i,listeners,listenerIndex,elementIndex=indexOf(elements,element),target=targets[elementIndex],wrapped=listener;if(target&&target.events)if(useAttachEvent&&(listeners=attachedListeners[elementIndex],listenerIndex=indexOf(listeners.supplied,listener),wrapped=listeners.wrapped[listenerIndex]),"all"!==type){if(target.events[type]){var len=target.events[type].length;if("all"===listener){for(i=0;i<len;i++)remove(element,type,target.events[type][i],Boolean(useCapture));return}for(i=0;i<len;i++)if(target.events[type][i]===listener){element[removeEvent](on+type,wrapped,useCapture||!1),target.events[type].splice(i,1),useAttachEvent&&listeners&&0===--listeners.useCount[listenerIndex]&&(listeners.supplied.splice(listenerIndex,1),listeners.wrapped.splice(listenerIndex,1),listeners.useCount.splice(listenerIndex,1));break}target.events[type]&&0===target.events[type].length&&(target.events[type]=null,target.typeCount--)}target.typeCount||(targets.splice(elementIndex,1),elements.splice(elementIndex,1),attachedListeners.splice(elementIndex,1))}else for(type in target.events)target.events.hasOwnProperty(type)&&remove(element,type,"all")}function preventDef(){this.returnValue=!1}function stopProp(){this.cancelBubble=!0}function stopImmProp(){this.cancelBubble=!0,this.immediatePropagationStopped=!0}var useAttachEvent="attachEvent"in window&&!("addEventListener"in window),addEvent=useAttachEvent?"attachEvent":"addEventListener",removeEvent=useAttachEvent?"detachEvent":"removeEventListener",on=useAttachEvent?"on":"",elements=[],targets=[],attachedListeners=[];return{add:add,remove:remove,useAttachEvent:useAttachEvent,_elements:elements,_targets:targets,_attachedListeners:attachedListeners}}(),prefixedPropREs={webkit:/(Movement[XY]|Radius[XY]|RotationAngle|Force)$/};Interaction.prototype={getPageXY:function(pointer,xy){return getPageXY(pointer,xy)},getClientXY:function(pointer,xy){return getClientXY(pointer,xy)},setEventXY:function(target,ptr){return setEventXY(target,ptr,this)},pointerOver:function(pointer,event,eventTarget){function pushCurMatches(interactable,selector){interactable&&inContext(interactable,eventTarget)&&!testIgnore(interactable,eventTarget,eventTarget)&&testAllow(interactable,eventTarget,eventTarget)&&matchesSelector(eventTarget,selector)&&(curMatches.push(interactable),curMatchElements.push(eventTarget))}if(!this.prepared.name&&this.mouse){var curMatches=[],curMatchElements=[],prevTargetElement=this.element;this.addPointer(pointer),!this.target||!testIgnore(this.target,this.element,eventTarget)&&testAllow(this.target,this.element,eventTarget)||(this.target=null,this.element=null,this.matches=[],this.matchElements=[]);var elementInteractable=interactables.get(eventTarget),elementAction=elementInteractable&&!testIgnore(elementInteractable,eventTarget,eventTarget)&&testAllow(elementInteractable,eventTarget,eventTarget)&&validateAction(elementInteractable.getAction(pointer,event,this,eventTarget),elementInteractable);elementAction&&!withinInteractionLimit(elementInteractable,eventTarget,elementAction)&&(elementAction=null),elementAction?(this.target=elementInteractable,this.element=eventTarget,this.matches=[],this.matchElements=[]):(interactables.forEachSelector(pushCurMatches),this.validateSelector(pointer,event,curMatches,curMatchElements)?(this.matches=curMatches,this.matchElements=curMatchElements,this.pointerHover(pointer,event,this.matches,this.matchElements),events.add(eventTarget,supportsPointerEvent?pEventTypes.move:"mousemove",listeners.pointerHover)):this.target&&(nodeContains(prevTargetElement,eventTarget)?(this.pointerHover(pointer,event,this.matches,this.matchElements),events.add(this.element,supportsPointerEvent?pEventTypes.move:"mousemove",listeners.pointerHover)):(this.target=null,this.element=null,this.matches=[],this.matchElements=[])))}},pointerHover:function(pointer,event,eventTarget,curEventTarget,matches,matchElements){var target=this.target;if(!this.prepared.name&&this.mouse){var action;this.setEventXY(this.curCoords,[pointer]),matches?action=this.validateSelector(pointer,event,matches,matchElements):target&&(action=validateAction(target.getAction(this.pointers[0],event,this,this.element),this.target)),target&&target.options.styleCursor&&(target._doc.documentElement.style.cursor=action?getActionCursor(action):"")}else this.prepared.name&&this.checkAndPreventDefault(event,target,this.element)},pointerOut:function(pointer,event,eventTarget){this.prepared.name||(interactables.get(eventTarget)||events.remove(eventTarget,supportsPointerEvent?pEventTypes.move:"mousemove",listeners.pointerHover),this.target&&this.target.options.styleCursor&&!this.interacting()&&(this.target._doc.documentElement.style.cursor=""))},selectorDown:function(pointer,event,eventTarget,curEventTarget){function pushMatches(interactable,selector,context){var elements=ie8MatchesSelector?context.querySelectorAll(selector):void 0;inContext(interactable,element)&&!testIgnore(interactable,element,eventTarget)&&testAllow(interactable,element,eventTarget)&&matchesSelector(element,selector,elements)&&(that.matches.push(interactable),that.matchElements.push(element))}var action,that=this,eventCopy=events.useAttachEvent?extend({},event):event,element=eventTarget,pointerIndex=this.addPointer(pointer);if(this.holdTimers[pointerIndex]=setTimeout(function(){that.pointerHold(events.useAttachEvent?eventCopy:pointer,eventCopy,eventTarget,curEventTarget)},defaultOptions._holdDuration),this.pointerIsDown=!0,this.inertiaStatus.active&&this.target.selector)for(;isElement(element);){if(element===this.element&&validateAction(this.target.getAction(pointer,event,this,this.element),this.target).name===this.prepared.name)return cancelFrame(this.inertiaStatus.i),this.inertiaStatus.active=!1,void this.collectEventTargets(pointer,event,eventTarget,"down");element=parentElement(element)}if(this.interacting())return void this.collectEventTargets(pointer,event,eventTarget,"down");for(this.setEventXY(this.curCoords,[pointer]),this.downEvent=event;isElement(element)&&!action;)this.matches=[],this.matchElements=[],interactables.forEachSelector(pushMatches),action=this.validateSelector(pointer,event,this.matches,this.matchElements),element=parentElement(element);if(action)return this.prepared.name=action.name,this.prepared.axis=action.axis,this.prepared.edges=action.edges,this.collectEventTargets(pointer,event,eventTarget,"down"),this.pointerDown(pointer,event,eventTarget,curEventTarget,action);this.downTimes[pointerIndex]=(new Date).getTime(),this.downTargets[pointerIndex]=eventTarget,pointerExtend(this.downPointer,pointer),copyCoords(this.prevCoords,this.curCoords),this.pointerWasMoved=!1,this.collectEventTargets(pointer,event,eventTarget,"down")},pointerDown:function(pointer,event,eventTarget,curEventTarget,forceAction){if(!forceAction&&!this.inertiaStatus.active&&this.pointerWasMoved&&this.prepared.name)return void this.checkAndPreventDefault(event,this.target,this.element);this.pointerIsDown=!0,this.downEvent=event;var action,pointerIndex=this.addPointer(pointer);if(this.pointerIds.length>1&&this.target._element===this.element){var newAction=validateAction(forceAction||this.target.getAction(pointer,event,this,this.element),this.target);withinInteractionLimit(this.target,this.element,newAction)&&(action=newAction),this.prepared.name=null}else if(!this.prepared.name){var interactable=interactables.get(curEventTarget);interactable&&!testIgnore(interactable,curEventTarget,eventTarget)&&testAllow(interactable,curEventTarget,eventTarget)&&(action=validateAction(forceAction||interactable.getAction(pointer,event,this,curEventTarget),interactable))&&withinInteractionLimit(interactable,curEventTarget,action)&&(this.target=interactable,this.element=curEventTarget)}var target=this.target,options=target&&target.options;if(!target||!forceAction&&this.prepared.name)this.inertiaStatus.active&&curEventTarget===this.element&&validateAction(target.getAction(pointer,event,this,this.element),target).name===this.prepared.name&&(cancelFrame(this.inertiaStatus.i),this.inertiaStatus.active=!1,this.checkAndPreventDefault(event,target,this.element));else{if(action=action||validateAction(forceAction||target.getAction(pointer,event,this,curEventTarget),target,this.element),this.setEventXY(this.startCoords,this.pointers),!action)return;options.styleCursor&&(target._doc.documentElement.style.cursor=getActionCursor(action)),this.resizeAxes="resize"===action.name?action.axis:null,"gesture"===action&&this.pointerIds.length<2&&(action=null),this.prepared.name=action.name,this.prepared.axis=action.axis,this.prepared.edges=action.edges,this.snapStatus.snappedX=this.snapStatus.snappedY=this.restrictStatus.restrictedX=this.restrictStatus.restrictedY=NaN,this.downTimes[pointerIndex]=(new Date).getTime(),this.downTargets[pointerIndex]=eventTarget,pointerExtend(this.downPointer,pointer),copyCoords(this.prevCoords,this.startCoords),this.pointerWasMoved=!1,this.checkAndPreventDefault(event,target,this.element)}},setModifications:function(coords,preEnd){var target=this.target,shouldMove=!0,shouldSnap=checkSnap(target,this.prepared.name)&&(!target.options[this.prepared.name].snap.endOnly||preEnd),shouldRestrict=checkRestrict(target,this.prepared.name)&&(!target.options[this.prepared.name].restrict.endOnly||preEnd);return shouldSnap?this.setSnapping(coords):this.snapStatus.locked=!1,shouldRestrict?this.setRestriction(coords):this.restrictStatus.restricted=!1,shouldSnap&&this.snapStatus.locked&&!this.snapStatus.changed?shouldMove=shouldRestrict&&this.restrictStatus.restricted&&this.restrictStatus.changed:shouldRestrict&&this.restrictStatus.restricted&&!this.restrictStatus.changed&&(shouldMove=!1),shouldMove},setStartOffsets:function(action,interactable,element){var width,height,rect=interactable.getRect(element),origin=getOriginXY(interactable,element),snap=interactable.options[this.prepared.name].snap,restrict=interactable.options[this.prepared.name].restrict;rect?(this.startOffset.left=this.startCoords.page.x-rect.left,this.startOffset.top=this.startCoords.page.y-rect.top,this.startOffset.right=rect.right-this.startCoords.page.x,this.startOffset.bottom=rect.bottom-this.startCoords.page.y,width="width"in rect?rect.width:rect.right-rect.left,height="height"in rect?rect.height:rect.bottom-rect.top):this.startOffset.left=this.startOffset.top=this.startOffset.right=this.startOffset.bottom=0,this.snapOffsets.splice(0);var snapOffset=snap&&"startCoords"===snap.offset?{x:this.startCoords.page.x-origin.x,y:this.startCoords.page.y-origin.y}:snap&&snap.offset||{x:0,y:0};if(rect&&snap&&snap.relativePoints&&snap.relativePoints.length)for(var i=0;i<snap.relativePoints.length;i++)this.snapOffsets.push({x:this.startOffset.left-width*snap.relativePoints[i].x+snapOffset.x,y:this.startOffset.top-height*snap.relativePoints[i].y+snapOffset.y});else this.snapOffsets.push(snapOffset);rect&&restrict.elementRect?(this.restrictOffset.left=this.startOffset.left-width*restrict.elementRect.left,this.restrictOffset.top=this.startOffset.top-height*restrict.elementRect.top,this.restrictOffset.right=this.startOffset.right-width*(1-restrict.elementRect.right),this.restrictOffset.bottom=this.startOffset.bottom-height*(1-restrict.elementRect.bottom)):this.restrictOffset.left=this.restrictOffset.top=this.restrictOffset.right=this.restrictOffset.bottom=0},start:function(action,interactable,element){this.interacting()||!this.pointerIsDown||this.pointerIds.length<("gesture"===action.name?2:1)||(-1===indexOf(interactions,this)&&interactions.push(this),this.prepared.name||this.setEventXY(this.startCoords,this.pointers),this.prepared.name=action.name,this.prepared.axis=action.axis,this.prepared.edges=action.edges,this.target=interactable,this.element=element,this.setStartOffsets(action.name,interactable,element),this.setModifications(this.startCoords.page),this.prevEvent=this[this.prepared.name+"Start"](this.downEvent))},pointerMove:function(pointer,event,eventTarget,curEventTarget,preEnd){if(this.inertiaStatus.active){var pageUp=this.inertiaStatus.upCoords.page,clientUp=this.inertiaStatus.upCoords.client,inertiaPosition={pageX:pageUp.x+this.inertiaStatus.sx,pageY:pageUp.y+this.inertiaStatus.sy,clientX:clientUp.x+this.inertiaStatus.sx,clientY:clientUp.y+this.inertiaStatus.sy};this.setEventXY(this.curCoords,[inertiaPosition])}else this.recordPointer(pointer),this.setEventXY(this.curCoords,this.pointers);var dx,dy,duplicateMove=this.curCoords.page.x===this.prevCoords.page.x&&this.curCoords.page.y===this.prevCoords.page.y&&this.curCoords.client.x===this.prevCoords.client.x&&this.curCoords.client.y===this.prevCoords.client.y,pointerIndex=this.mouse?0:indexOf(this.pointerIds,getPointerId(pointer));if(this.pointerIsDown&&!this.pointerWasMoved&&(dx=this.curCoords.client.x-this.startCoords.client.x,dy=this.curCoords.client.y-this.startCoords.client.y,this.pointerWasMoved=hypot(dx,dy)>pointerMoveTolerance),duplicateMove||this.pointerIsDown&&!this.pointerWasMoved||(this.pointerIsDown&&clearTimeout(this.holdTimers[pointerIndex]),this.collectEventTargets(pointer,event,eventTarget,"move")),this.pointerIsDown){if(duplicateMove&&this.pointerWasMoved&&!preEnd)return void this.checkAndPreventDefault(event,this.target,this.element);if(setEventDeltas(this.pointerDelta,this.prevCoords,this.curCoords),this.prepared.name){if(this.pointerWasMoved&&(!this.inertiaStatus.active||pointer instanceof InteractEvent&&/inertiastart/.test(pointer.type))){if(!this.interacting()&&(setEventDeltas(this.pointerDelta,this.prevCoords,this.curCoords),"drag"===this.prepared.name)){var absX=Math.abs(dx),absY=Math.abs(dy),targetAxis=this.target.options.drag.axis,axis=absX>absY?"x":absX<absY?"y":"xy";if("xy"!==axis&&"xy"!==targetAxis&&targetAxis!==axis){this.prepared.name=null;for(var element=eventTarget;isElement(element);){var elementInteractable=interactables.get(element);if(elementInteractable&&elementInteractable!==this.target&&!elementInteractable.options.drag.manualStart&&"drag"===elementInteractable.getAction(this.downPointer,this.downEvent,this,element).name&&checkAxis(axis,elementInteractable)){this.prepared.name="drag",this.target=elementInteractable,this.element=element;break}element=parentElement(element)}if(!this.prepared.name){var thisInteraction=this,getDraggable=function(interactable,selector,context){var elements=ie8MatchesSelector?context.querySelectorAll(selector):void 0;if(interactable!==thisInteraction.target)return inContext(interactable,eventTarget)&&!interactable.options.drag.manualStart&&!testIgnore(interactable,element,eventTarget)&&testAllow(interactable,element,eventTarget)&&matchesSelector(element,selector,elements)&&"drag"===interactable.getAction(thisInteraction.downPointer,thisInteraction.downEvent,thisInteraction,element).name&&checkAxis(axis,interactable)&&withinInteractionLimit(interactable,element,"drag")?interactable:void 0};for(element=eventTarget;isElement(element);){var selectorInteractable=interactables.forEachSelector(getDraggable);if(selectorInteractable){this.prepared.name="drag",this.target=selectorInteractable,this.element=element;break}element=parentElement(element)}}}}var starting=!!this.prepared.name&&!this.interacting();if(starting&&(this.target.options[this.prepared.name].manualStart||!withinInteractionLimit(this.target,this.element,this.prepared)))return void this.stop(event);if(this.prepared.name&&this.target){starting&&this.start(this.prepared,this.target,this.element);(this.setModifications(this.curCoords.page,preEnd)||starting)&&(this.prevEvent=this[this.prepared.name+"Move"](event)),this.checkAndPreventDefault(event,this.target,this.element)}}copyCoords(this.prevCoords,this.curCoords),(this.dragging||this.resizing)&&this.autoScrollMove(pointer)}}},dragStart:function(event){var dragEvent=new InteractEvent(this,event,"drag","start",this.element);this.dragging=!0,this.target.fire(dragEvent),this.activeDrops.dropzones=[],this.activeDrops.elements=[],this.activeDrops.rects=[],this.dynamicDrop||this.setActiveDrops(this.element);var dropEvents=this.getDropEvents(event,dragEvent);return dropEvents.activate&&this.fireActiveDrops(dropEvents.activate),dragEvent},dragMove:function(event){var target=this.target,dragEvent=new InteractEvent(this,event,"drag","move",this.element),draggableElement=this.element,drop=this.getDrop(dragEvent,event,draggableElement);this.dropTarget=drop.dropzone,this.dropElement=drop.element;var dropEvents=this.getDropEvents(event,dragEvent);return target.fire(dragEvent),dropEvents.leave&&this.prevDropTarget.fire(dropEvents.leave),dropEvents.enter&&this.dropTarget.fire(dropEvents.enter),dropEvents.move&&this.dropTarget.fire(dropEvents.move),this.prevDropTarget=this.dropTarget,this.prevDropElement=this.dropElement,dragEvent},resizeStart:function(event){var resizeEvent=new InteractEvent(this,event,"resize","start",this.element);if(this.prepared.edges){var startRect=this.target.getRect(this.element);if(this.target.options.resize.square||this.target.options.resize.preserveAspectRatio){var linkedEdges=extend({},this.prepared.edges);linkedEdges.top=linkedEdges.top||linkedEdges.left&&!linkedEdges.bottom,linkedEdges.left=linkedEdges.left||linkedEdges.top&&!linkedEdges.right,linkedEdges.bottom=linkedEdges.bottom||linkedEdges.right&&!linkedEdges.top,linkedEdges.right=linkedEdges.right||linkedEdges.bottom&&!linkedEdges.left,this.prepared._linkedEdges=linkedEdges}else this.prepared._linkedEdges=null;this.target.options.resize.preserveAspectRatio&&(this.resizeStartAspectRatio=startRect.width/startRect.height),this.resizeRects={start:startRect,current:extend({},startRect),restricted:extend({},startRect),previous:extend({},startRect),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},resizeEvent.rect=this.resizeRects.restricted,resizeEvent.deltaRect=this.resizeRects.delta}return this.target.fire(resizeEvent),this.resizing=!0,resizeEvent},resizeMove:function(event){var resizeEvent=new InteractEvent(this,event,"resize","move",this.element),edges=this.prepared.edges,invert=this.target.options.resize.invert,invertible="reposition"===invert||"negate"===invert;if(edges){var dx=resizeEvent.dx,dy=resizeEvent.dy,start=this.resizeRects.start,current=this.resizeRects.current,restricted=this.resizeRects.restricted,delta=this.resizeRects.delta,previous=extend(this.resizeRects.previous,restricted),originalEdges=edges;if(this.target.options.resize.preserveAspectRatio){var resizeStartAspectRatio=this.resizeStartAspectRatio;edges=this.prepared._linkedEdges,originalEdges.left&&originalEdges.bottom||originalEdges.right&&originalEdges.top?dy=-dx/resizeStartAspectRatio:originalEdges.left||originalEdges.right?dy=dx/resizeStartAspectRatio:(originalEdges.top||originalEdges.bottom)&&(dx=dy*resizeStartAspectRatio)}else this.target.options.resize.square&&(edges=this.prepared._linkedEdges,originalEdges.left&&originalEdges.bottom||originalEdges.right&&originalEdges.top?dy=-dx:originalEdges.left||originalEdges.right?dy=dx:(originalEdges.top||originalEdges.bottom)&&(dx=dy));if(edges.top&&(current.top+=dy),edges.bottom&&(current.bottom+=dy),edges.left&&(current.left+=dx),edges.right&&(current.right+=dx),invertible){if(extend(restricted,current),"reposition"===invert){var swap;restricted.top>restricted.bottom&&(swap=restricted.top,restricted.top=restricted.bottom,restricted.bottom=swap),restricted.left>restricted.right&&(swap=restricted.left,restricted.left=restricted.right,restricted.right=swap)}}else restricted.top=Math.min(current.top,start.bottom),restricted.bottom=Math.max(current.bottom,start.top),restricted.left=Math.min(current.left,start.right),restricted.right=Math.max(current.right,start.left);restricted.width=restricted.right-restricted.left,restricted.height=restricted.bottom-restricted.top;for(var edge in restricted)delta[edge]=restricted[edge]-previous[edge];resizeEvent.edges=this.prepared.edges,resizeEvent.rect=restricted,resizeEvent.deltaRect=delta}return this.target.fire(resizeEvent),resizeEvent},gestureStart:function(event){var gestureEvent=new InteractEvent(this,event,"gesture","start",this.element);return gestureEvent.ds=0,this.gesture.startDistance=this.gesture.prevDistance=gestureEvent.distance,this.gesture.startAngle=this.gesture.prevAngle=gestureEvent.angle,this.gesture.scale=1,this.gesturing=!0,this.target.fire(gestureEvent),gestureEvent},gestureMove:function(event){if(!this.pointerIds.length)return this.prevEvent;var gestureEvent;return gestureEvent=new InteractEvent(this,event,"gesture","move",this.element),gestureEvent.ds=gestureEvent.scale-this.gesture.scale,this.target.fire(gestureEvent),this.gesture.prevAngle=gestureEvent.angle,this.gesture.prevDistance=gestureEvent.distance,gestureEvent.scale===1/0||null===gestureEvent.scale||void 0===gestureEvent.scale||isNaN(gestureEvent.scale)||(this.gesture.scale=gestureEvent.scale),gestureEvent},pointerHold:function(pointer,event,eventTarget){this.collectEventTargets(pointer,event,eventTarget,"hold")},pointerUp:function(pointer,event,eventTarget,curEventTarget){var pointerIndex=this.mouse?0:indexOf(this.pointerIds,getPointerId(pointer));clearTimeout(this.holdTimers[pointerIndex]),this.collectEventTargets(pointer,event,eventTarget,"up"),this.collectEventTargets(pointer,event,eventTarget,"tap"),this.pointerEnd(pointer,event,eventTarget,curEventTarget),this.removePointer(pointer)},pointerCancel:function(pointer,event,eventTarget,curEventTarget){var pointerIndex=this.mouse?0:indexOf(this.pointerIds,getPointerId(pointer));clearTimeout(this.holdTimers[pointerIndex]),this.collectEventTargets(pointer,event,eventTarget,"cancel"),this.pointerEnd(pointer,event,eventTarget,curEventTarget),this.removePointer(pointer)},ie8Dblclick:function(pointer,event,eventTarget){this.prevTap&&event.clientX===this.prevTap.clientX&&event.clientY===this.prevTap.clientY&&eventTarget===this.prevTap.target&&(this.downTargets[0]=eventTarget,this.downTimes[0]=(new Date).getTime(),this.collectEventTargets(pointer,event,eventTarget,"tap"))},pointerEnd:function(pointer,event,eventTarget,curEventTarget){var endEvent,target=this.target,options=target&&target.options,inertiaOptions=options&&this.prepared.name&&options[this.prepared.name].inertia,inertiaStatus=this.inertiaStatus;if(this.interacting()){if(inertiaStatus.active&&!inertiaStatus.ending)return;var pointerSpeed,now=(new Date).getTime(),inertiaPossible=!1,inertia=!1,smoothEnd=!1,endSnap=checkSnap(target,this.prepared.name)&&options[this.prepared.name].snap.endOnly,endRestrict=checkRestrict(target,this.prepared.name)&&options[this.prepared.name].restrict.endOnly,dx=0,dy=0;if(pointerSpeed=this.dragging?"x"===options.drag.axis?Math.abs(this.pointerDelta.client.vx):"y"===options.drag.axis?Math.abs(this.pointerDelta.client.vy):this.pointerDelta.client.speed:this.pointerDelta.client.speed,inertiaPossible=inertiaOptions&&inertiaOptions.enabled&&"gesture"!==this.prepared.name&&event!==inertiaStatus.startEvent,inertia=inertiaPossible&&now-this.curCoords.timeStamp<50&&pointerSpeed>inertiaOptions.minSpeed&&pointerSpeed>inertiaOptions.endSpeed,inertiaPossible&&!inertia&&(endSnap||endRestrict)){var snapRestrict={};snapRestrict.snap=snapRestrict.restrict=snapRestrict,endSnap&&(this.setSnapping(this.curCoords.page,snapRestrict),snapRestrict.locked&&(dx+=snapRestrict.dx,dy+=snapRestrict.dy)),endRestrict&&(this.setRestriction(this.curCoords.page,snapRestrict),snapRestrict.restricted&&(dx+=snapRestrict.dx,dy+=snapRestrict.dy)),(dx||dy)&&(smoothEnd=!0)}if(inertia||smoothEnd){if(copyCoords(inertiaStatus.upCoords,this.curCoords),this.pointers[0]=inertiaStatus.startEvent=new InteractEvent(this,event,this.prepared.name,"inertiastart",this.element),inertiaStatus.t0=now,target.fire(inertiaStatus.startEvent),inertia){inertiaStatus.vx0=this.pointerDelta.client.vx,inertiaStatus.vy0=this.pointerDelta.client.vy,inertiaStatus.v0=pointerSpeed,this.calcInertia(inertiaStatus);var statusObject,page=extend({},this.curCoords.page),origin=getOriginXY(target,this.element);if(page.x=page.x+inertiaStatus.xe-origin.x,page.y=page.y+inertiaStatus.ye-origin.y,statusObject={useStatusXY:!0,x:page.x,y:page.y,dx:0,dy:0,snap:null},statusObject.snap=statusObject,dx=dy=0,endSnap){var snap=this.setSnapping(this.curCoords.page,statusObject);snap.locked&&(dx+=snap.dx,dy+=snap.dy)}if(endRestrict){var restrict=this.setRestriction(this.curCoords.page,statusObject);restrict.restricted&&(dx+=restrict.dx,dy+=restrict.dy)}inertiaStatus.modifiedXe+=dx,inertiaStatus.modifiedYe+=dy,inertiaStatus.i=reqFrame(this.boundInertiaFrame)}else inertiaStatus.smoothEnd=!0,inertiaStatus.xe=dx,inertiaStatus.ye=dy,inertiaStatus.sx=inertiaStatus.sy=0,inertiaStatus.i=reqFrame(this.boundSmoothEndFrame);return void(inertiaStatus.active=!0)}(endSnap||endRestrict)&&this.pointerMove(pointer,event,eventTarget,curEventTarget,!0)}if(this.dragging){endEvent=new InteractEvent(this,event,"drag","end",this.element);var draggableElement=this.element,drop=this.getDrop(endEvent,event,draggableElement);this.dropTarget=drop.dropzone,this.dropElement=drop.element;var dropEvents=this.getDropEvents(event,endEvent);dropEvents.leave&&this.prevDropTarget.fire(dropEvents.leave),dropEvents.enter&&this.dropTarget.fire(dropEvents.enter),dropEvents.drop&&this.dropTarget.fire(dropEvents.drop),dropEvents.deactivate&&this.fireActiveDrops(dropEvents.deactivate),target.fire(endEvent)}else this.resizing?(endEvent=new InteractEvent(this,event,"resize","end",this.element),target.fire(endEvent)):this.gesturing&&(endEvent=new InteractEvent(this,event,"gesture","end",this.element),target.fire(endEvent));this.stop(event)},collectDrops:function(element){var i,drops=[],elements=[];for(element=element||this.element,i=0;i<interactables.length;i++)if(interactables[i].options.drop.enabled){var current=interactables[i],accept=current.options.drop.accept;if(!(isElement(accept)&&accept!==element||isString(accept)&&!matchesSelector(element,accept)))for(var dropElements=current.selector?current._context.querySelectorAll(current.selector):[current._element],j=0,len=dropElements.length;j<len;j++){var currentElement=dropElements[j];currentElement!==element&&(drops.push(current),elements.push(currentElement))}}return{dropzones:drops,elements:elements}},fireActiveDrops:function(event){var i,current,currentElement,prevElement;for(i=0;i<this.activeDrops.dropzones.length;i++)current=this.activeDrops.dropzones[i],currentElement=this.activeDrops.elements[i],currentElement!==prevElement&&(event.target=currentElement,current.fire(event)),prevElement=currentElement},setActiveDrops:function(dragElement){var possibleDrops=this.collectDrops(dragElement,!0);this.activeDrops.dropzones=possibleDrops.dropzones,this.activeDrops.elements=possibleDrops.elements,this.activeDrops.rects=[];for(var i=0;i<this.activeDrops.dropzones.length;i++)this.activeDrops.rects[i]=this.activeDrops.dropzones[i].getRect(this.activeDrops.elements[i])},getDrop:function(dragEvent,event,dragElement){var validDrops=[];dynamicDrop&&this.setActiveDrops(dragElement);for(var j=0;j<this.activeDrops.dropzones.length;j++){var current=this.activeDrops.dropzones[j],currentElement=this.activeDrops.elements[j],rect=this.activeDrops.rects[j];validDrops.push(current.dropCheck(dragEvent,event,this.target,dragElement,currentElement,rect)?currentElement:null)}var dropIndex=indexOfDeepestElement(validDrops);return{dropzone:this.activeDrops.dropzones[dropIndex]||null,element:this.activeDrops.elements[dropIndex]||null}},getDropEvents:function(pointerEvent,dragEvent){var dropEvents={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return this.dropElement!==this.prevDropElement&&(this.prevDropTarget&&(dropEvents.leave={target:this.prevDropElement,dropzone:this.prevDropTarget,relatedTarget:dragEvent.target,draggable:dragEvent.interactable,dragEvent:dragEvent,interaction:this,timeStamp:dragEvent.timeStamp,type:"dragleave"},dragEvent.dragLeave=this.prevDropElement,dragEvent.prevDropzone=this.prevDropTarget),this.dropTarget&&(dropEvents.enter={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:dragEvent.target,draggable:dragEvent.interactable,dragEvent:dragEvent,interaction:this,timeStamp:dragEvent.timeStamp,type:"dragenter"},dragEvent.dragEnter=this.dropElement,dragEvent.dropzone=this.dropTarget)),"dragend"===dragEvent.type&&this.dropTarget&&(dropEvents.drop={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:dragEvent.target,draggable:dragEvent.interactable,dragEvent:dragEvent,interaction:this,timeStamp:dragEvent.timeStamp,type:"drop"},dragEvent.dropzone=this.dropTarget),"dragstart"===dragEvent.type&&(dropEvents.activate={target:null,dropzone:null,relatedTarget:dragEvent.target,draggable:dragEvent.interactable,dragEvent:dragEvent,interaction:this,timeStamp:dragEvent.timeStamp,type:"dropactivate"}),"dragend"===dragEvent.type&&(dropEvents.deactivate={target:null,dropzone:null,relatedTarget:dragEvent.target,draggable:dragEvent.interactable,dragEvent:dragEvent,interaction:this,timeStamp:dragEvent.timeStamp,type:"dropdeactivate"}),"dragmove"===dragEvent.type&&this.dropTarget&&(dropEvents.move={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:dragEvent.target,draggable:dragEvent.interactable,dragEvent:dragEvent,interaction:this,dragmove:dragEvent,timeStamp:dragEvent.timeStamp,type:"dropmove"},dragEvent.dropzone=this.dropTarget),dropEvents},currentAction:function(){return this.dragging&&"drag"||this.resizing&&"resize"||this.gesturing&&"gesture"||null},interacting:function(){return this.dragging||this.resizing||this.gesturing},clearTargets:function(){this.target=this.element=null,this.dropTarget=this.dropElement=this.prevDropTarget=this.prevDropElement=null},stop:function(event){if(this.interacting()){autoScroll.stop(),this.matches=[],this.matchElements=[];var target=this.target;target.options.styleCursor&&(target._doc.documentElement.style.cursor=""),event&&isFunction(event.preventDefault)&&this.checkAndPreventDefault(event,target,this.element),this.dragging&&(this.activeDrops.dropzones=this.activeDrops.elements=this.activeDrops.rects=null)}this.clearTargets(),this.pointerIsDown=this.snapStatus.locked=this.dragging=this.resizing=this.gesturing=!1,this.prepared.name=this.prevEvent=null,this.inertiaStatus.resumeDx=this.inertiaStatus.resumeDy=0;for(var i=0;i<this.pointers.length;i++)-1===indexOf(this.pointerIds,getPointerId(this.pointers[i]))&&this.pointers.splice(i,1)},inertiaFrame:function(){var inertiaStatus=this.inertiaStatus,options=this.target.options[this.prepared.name].inertia,lambda=options.resistance,t=(new Date).getTime()/1e3-inertiaStatus.t0;if(t<inertiaStatus.te){var progress=1-(Math.exp(-lambda*t)-inertiaStatus.lambda_v0)/inertiaStatus.one_ve_v0;if(inertiaStatus.modifiedXe===inertiaStatus.xe&&inertiaStatus.modifiedYe===inertiaStatus.ye)inertiaStatus.sx=inertiaStatus.xe*progress,inertiaStatus.sy=inertiaStatus.ye*progress;else{var quadPoint=getQuadraticCurvePoint(0,0,inertiaStatus.xe,inertiaStatus.ye,inertiaStatus.modifiedXe,inertiaStatus.modifiedYe,progress);inertiaStatus.sx=quadPoint.x,inertiaStatus.sy=quadPoint.y}this.pointerMove(inertiaStatus.startEvent,inertiaStatus.startEvent),inertiaStatus.i=reqFrame(this.boundInertiaFrame)}else inertiaStatus.ending=!0,inertiaStatus.sx=inertiaStatus.modifiedXe,inertiaStatus.sy=inertiaStatus.modifiedYe,this.pointerMove(inertiaStatus.startEvent,inertiaStatus.startEvent),this.pointerEnd(inertiaStatus.startEvent,inertiaStatus.startEvent),inertiaStatus.active=inertiaStatus.ending=!1},smoothEndFrame:function(){var inertiaStatus=this.inertiaStatus,t=(new Date).getTime()-inertiaStatus.t0,duration=this.target.options[this.prepared.name].inertia.smoothEndDuration;t<duration?(inertiaStatus.sx=easeOutQuad(t,0,inertiaStatus.xe,duration),inertiaStatus.sy=easeOutQuad(t,0,inertiaStatus.ye,duration),this.pointerMove(inertiaStatus.startEvent,inertiaStatus.startEvent),inertiaStatus.i=reqFrame(this.boundSmoothEndFrame)):(inertiaStatus.ending=!0,inertiaStatus.sx=inertiaStatus.xe,inertiaStatus.sy=inertiaStatus.ye,this.pointerMove(inertiaStatus.startEvent,inertiaStatus.startEvent),this.pointerEnd(inertiaStatus.startEvent,inertiaStatus.startEvent),inertiaStatus.smoothEnd=inertiaStatus.active=inertiaStatus.ending=!1)},addPointer:function(pointer){var id=getPointerId(pointer),index=this.mouse?0:indexOf(this.pointerIds,id);return-1===index&&(index=this.pointerIds.length),this.pointerIds[index]=id,this.pointers[index]=pointer,index},removePointer:function(pointer){var id=getPointerId(pointer),index=this.mouse?0:indexOf(this.pointerIds,id);-1!==index&&(this.pointers.splice(index,1),this.pointerIds.splice(index,1),this.downTargets.splice(index,1),this.downTimes.splice(index,1),this.holdTimers.splice(index,1))},recordPointer:function(pointer){var index=this.mouse?0:indexOf(this.pointerIds,getPointerId(pointer));-1!==index&&(this.pointers[index]=pointer)},collectEventTargets:function(pointer,event,eventTarget,eventType){function collectSelectors(interactable,selector,context){var els=ie8MatchesSelector?context.querySelectorAll(selector):void 0;interactable._iEvents[eventType]&&isElement(element)&&inContext(interactable,element)&&!testIgnore(interactable,element,eventTarget)&&testAllow(interactable,element,eventTarget)&&matchesSelector(element,selector,els)&&(targets.push(interactable),elements.push(element))}var pointerIndex=this.mouse?0:indexOf(this.pointerIds,getPointerId(pointer));if("tap"!==eventType||!this.pointerWasMoved&&this.downTargets[pointerIndex]&&this.downTargets[pointerIndex]===eventTarget){for(var targets=[],elements=[],element=eventTarget;element;)interact.isSet(element)&&interact(element)._iEvents[eventType]&&(targets.push(interact(element)),elements.push(element)),interactables.forEachSelector(collectSelectors),element=parentElement(element);(targets.length||"tap"===eventType)&&this.firePointers(pointer,event,eventTarget,targets,elements,eventType)}},firePointers:function(pointer,event,eventTarget,targets,elements,eventType){var i,interval,createNewDoubleTap,pointerIndex=this.mouse?0:indexOf(this.pointerIds,getPointerId(pointer)),pointerEvent={};for("doubletap"===eventType?pointerEvent=pointer:(pointerExtend(pointerEvent,event),event!==pointer&&pointerExtend(pointerEvent,pointer),pointerEvent.preventDefault=preventOriginalDefault,pointerEvent.stopPropagation=InteractEvent.prototype.stopPropagation,pointerEvent.stopImmediatePropagation=InteractEvent.prototype.stopImmediatePropagation,pointerEvent.interaction=this,pointerEvent.timeStamp=(new Date).getTime(),pointerEvent.originalEvent=event,pointerEvent.originalPointer=pointer,pointerEvent.type=eventType,pointerEvent.pointerId=getPointerId(pointer),pointerEvent.pointerType=this.mouse?"mouse":supportsPointerEvent?isString(pointer.pointerType)?pointer.pointerType:[,,"touch","pen","mouse"][pointer.pointerType]:"touch"),"tap"===eventType&&(pointerEvent.dt=pointerEvent.timeStamp-this.downTimes[pointerIndex],interval=pointerEvent.timeStamp-this.tapTime,createNewDoubleTap=!!(this.prevTap&&"doubletap"!==this.prevTap.type&&this.prevTap.target===pointerEvent.target&&interval<500),pointerEvent.double=createNewDoubleTap,this.tapTime=pointerEvent.timeStamp),i=0;i<targets.length&&(pointerEvent.currentTarget=elements[i],pointerEvent.interactable=targets[i],targets[i].fire(pointerEvent),!(pointerEvent.immediatePropagationStopped||pointerEvent.propagationStopped&&elements[i+1]!==pointerEvent.currentTarget));i++);if(createNewDoubleTap){var doubleTap={};extend(doubleTap,pointerEvent),doubleTap.dt=interval,doubleTap.type="doubletap",this.collectEventTargets(doubleTap,event,eventTarget,"doubletap"),this.prevTap=doubleTap}else"tap"===eventType&&(this.prevTap=pointerEvent)},validateSelector:function(pointer,event,matches,matchElements){for(var i=0,len=matches.length;i<len;i++){var match=matches[i],matchElement=matchElements[i],action=validateAction(match.getAction(pointer,event,this,matchElement),match);if(action&&withinInteractionLimit(match,matchElement,action))return this.target=match,this.element=matchElement,action}},setSnapping:function(pageCoords,status){var target,page,i,snap=this.target.options[this.prepared.name].snap,targets=[];if(status=status||this.snapStatus,status.useStatusXY)page={x:status.x,y:status.y};else{var origin=getOriginXY(this.target,this.element);page=extend({},pageCoords),page.x-=origin.x,page.y-=origin.y}status.realX=page.x,status.realY=page.y,page.x=page.x-this.inertiaStatus.resumeDx,page.y=page.y-this.inertiaStatus.resumeDy;for(var len=snap.targets?snap.targets.length:0,relIndex=0;relIndex<this.snapOffsets.length;relIndex++){var relative={x:page.x-this.snapOffsets[relIndex].x,y:page.y-this.snapOffsets[relIndex].y};for(i=0;i<len;i++)(target=isFunction(snap.targets[i])?snap.targets[i](relative.x,relative.y,this):snap.targets[i])&&targets.push({x:isNumber(target.x)?target.x+this.snapOffsets[relIndex].x:relative.x,y:isNumber(target.y)?target.y+this.snapOffsets[relIndex].y:relative.y,range:isNumber(target.range)?target.range:snap.range})}var closest={target:null,inRange:!1,distance:0,range:0,dx:0,dy:0};for(i=0,len=targets.length;i<len;i++){target=targets[i];var range=target.range,dx=target.x-page.x,dy=target.y-page.y,distance=hypot(dx,dy),inRange=distance<=range;range===1/0&&closest.inRange&&closest.range!==1/0&&(inRange=!1),closest.target&&!(inRange?closest.inRange&&range!==1/0?distance/range<closest.distance/closest.range:range===1/0&&closest.range!==1/0||distance<closest.distance:!closest.inRange&&distance<closest.distance)||(range===1/0&&(inRange=!0),closest.target=target,closest.distance=distance,closest.range=range,closest.inRange=inRange,closest.dx=dx,closest.dy=dy,status.range=range)}var snapChanged;return closest.target?(snapChanged=status.snappedX!==closest.target.x||status.snappedY!==closest.target.y,status.snappedX=closest.target.x,status.snappedY=closest.target.y):(snapChanged=!0,status.snappedX=NaN,status.snappedY=NaN),status.dx=closest.dx,status.dy=closest.dy,status.changed=snapChanged||closest.inRange&&!status.locked,status.locked=closest.inRange,status},setRestriction:function(pageCoords,status){var page,target=this.target,restrict=target&&target.options[this.prepared.name].restrict,restriction=restrict&&restrict.restriction;if(!restriction)return status;status=status||this.restrictStatus,page=page=status.useStatusXY?{x:status.x,y:status.y}:extend({},pageCoords),status.snap&&status.snap.locked&&(page.x+=status.snap.dx||0,page.y+=status.snap.dy||0),page.x-=this.inertiaStatus.resumeDx,page.y-=this.inertiaStatus.resumeDy,status.dx=0,status.dy=0,status.restricted=!1;var rect,restrictedX,restrictedY;return isString(restriction)&&!(restriction="parent"===restriction?parentElement(this.element):"self"===restriction?target.getRect(this.element):closest(this.element,restriction))?status:(isFunction(restriction)&&(restriction=restriction(page.x,page.y,this.element)),isElement(restriction)&&(restriction=getElementRect(restriction)),rect=restriction,restriction?"x"in restriction&&"y"in restriction?(restrictedX=Math.max(Math.min(rect.x+rect.width-this.restrictOffset.right,page.x),rect.x+this.restrictOffset.left),restrictedY=Math.max(Math.min(rect.y+rect.height-this.restrictOffset.bottom,page.y),rect.y+this.restrictOffset.top)):(restrictedX=Math.max(Math.min(rect.right-this.restrictOffset.right,page.x),rect.left+this.restrictOffset.left),restrictedY=Math.max(Math.min(rect.bottom-this.restrictOffset.bottom,page.y),rect.top+this.restrictOffset.top)):(restrictedX=page.x,restrictedY=page.y),status.dx=restrictedX-page.x,status.dy=restrictedY-page.y,status.changed=status.restrictedX!==restrictedX||status.restrictedY!==restrictedY,status.restricted=!(!status.dx&&!status.dy),status.restrictedX=restrictedX,status.restrictedY=restrictedY,status)},checkAndPreventDefault:function(event,interactable,element){if(interactable=interactable||this.target){var options=interactable.options,prevent=options.preventDefault;if("auto"===prevent&&element&&!/^(input|select|textarea)$/i.test(event.target.nodeName)){if(/down|start/i.test(event.type)&&"drag"===this.prepared.name&&"xy"!==options.drag.axis)return;if(options[this.prepared.name]&&options[this.prepared.name].manualStart&&!this.interacting())return;return void event.preventDefault()}return"always"===prevent?void event.preventDefault():void 0}},calcInertia:function(status){var inertiaOptions=this.target.options[this.prepared.name].inertia,lambda=inertiaOptions.resistance,inertiaDur=-Math.log(inertiaOptions.endSpeed/status.v0)/lambda;status.x0=this.prevEvent.pageX,status.y0=this.prevEvent.pageY,status.t0=status.startEvent.timeStamp/1e3,status.sx=status.sy=0,status.modifiedXe=status.xe=(status.vx0-inertiaDur)/lambda,status.modifiedYe=status.ye=(status.vy0-inertiaDur)/lambda,status.te=inertiaDur,status.lambda_v0=lambda/status.v0,status.one_ve_v0=1-inertiaOptions.endSpeed/status.v0},autoScrollMove:function(pointer){if(this.interacting()&&checkAutoScroll(this.target,this.prepared.name)){if(this.inertiaStatus.active)return void(autoScroll.x=autoScroll.y=0);var top,right,bottom,left,options=this.target.options[this.prepared.name].autoScroll,container=options.container||getWindow(this.element);if(isWindow(container))left=pointer.clientX<autoScroll.margin,top=pointer.clientY<autoScroll.margin,right=pointer.clientX>container.innerWidth-autoScroll.margin,bottom=pointer.clientY>container.innerHeight-autoScroll.margin;else{var rect=getElementClientRect(container);left=pointer.clientX<rect.left+autoScroll.margin,top=pointer.clientY<rect.top+autoScroll.margin,right=pointer.clientX>rect.right-autoScroll.margin,bottom=pointer.clientY>rect.bottom-autoScroll.margin}autoScroll.x=right?1:left?-1:0,autoScroll.y=bottom?1:top?-1:0,autoScroll.isScrolling||(autoScroll.margin=options.margin,autoScroll.speed=options.speed,autoScroll.start(this))}},_updateEventTargets:function(target,currentTarget){this._eventTarget=target,this._curEventTarget=currentTarget}},InteractEvent.prototype={preventDefault:blank,stopImmediatePropagation:function(){this.immediatePropagationStopped=this.propagationStopped=!0},stopPropagation:function(){this.propagationStopped=!0}};for(var listeners={},interactionListeners=["dragStart","dragMove","resizeStart","resizeMove","gestureStart","gestureMove","pointerOver","pointerOut","pointerHover","selectorDown","pointerDown","pointerMove","pointerUp","pointerCancel","pointerEnd","addPointer","removePointer","recordPointer","autoScrollMove"],i=0,len=interactionListeners.length;i<len;i++){var name=interactionListeners[i];listeners[name]=doOnInteractions(name)}interactables.indexOfElement=function(element,context){context=context||document;for(var i=0;i<this.length;i++){var interactable=this[i];if(interactable.selector===element&&interactable._context===context||!interactable.selector&&interactable._element===element)return i}return-1},interactables.get=function(element,options){return this[this.indexOfElement(element,options&&options.context)]},interactables.forEachSelector=function(callback){for(var i=0;i<this.length;i++){var interactable=this[i];if(interactable.selector){var ret=callback(interactable,interactable.selector,interactable._context,i,this);if(void 0!==ret)return ret}}},Interactable.prototype={setOnEvents:function(action,phases){return"drop"===action?(isFunction(phases.ondrop)&&(this.ondrop=phases.ondrop),isFunction(phases.ondropactivate)&&(this.ondropactivate=phases.ondropactivate),isFunction(phases.ondropdeactivate)&&(this.ondropdeactivate=phases.ondropdeactivate),isFunction(phases.ondragenter)&&(this.ondragenter=phases.ondragenter),isFunction(phases.ondragleave)&&(this.ondragleave=phases.ondragleave),isFunction(phases.ondropmove)&&(this.ondropmove=phases.ondropmove)):(action="on"+action,isFunction(phases.onstart)&&(this[action+"start"]=phases.onstart),isFunction(phases.onmove)&&(this[action+"move"]=phases.onmove),isFunction(phases.onend)&&(this[action+"end"]=phases.onend),isFunction(phases.oninertiastart)&&(this[action+"inertiastart"]=phases.oninertiastart)),this},draggable:function(options){return isObject(options)?(this.options.drag.enabled=!1!==options.enabled,this.setPerAction("drag",options),this.setOnEvents("drag",options),/^x$|^y$|^xy$/.test(options.axis)?this.options.drag.axis=options.axis:null===options.axis&&delete this.options.drag.axis,this):isBool(options)?(this.options.drag.enabled=options,this):this.options.drag},setPerAction:function(action,options){for(var option in options)option in defaultOptions[action]&&(isObject(options[option])?(this.options[action][option]=extend(this.options[action][option]||{},options[option]),isObject(defaultOptions.perAction[option])&&"enabled"in defaultOptions.perAction[option]&&(this.options[action][option].enabled=!1!==options[option].enabled)):isBool(options[option])&&isObject(defaultOptions.perAction[option])?this.options[action][option].enabled=options[option]:void 0!==options[option]&&(this.options[action][option]=options[option]))},dropzone:function(options){return isObject(options)?(this.options.drop.enabled=!1!==options.enabled,this.setOnEvents("drop",options),/^(pointer|center)$/.test(options.overlap)?this.options.drop.overlap=options.overlap:isNumber(options.overlap)&&(this.options.drop.overlap=Math.max(Math.min(1,options.overlap),0)),"accept"in options&&(this.options.drop.accept=options.accept),"checker"in options&&(this.options.drop.checker=options.checker),this):isBool(options)?(this.options.drop.enabled=options,this):this.options.drop},dropCheck:function(dragEvent,event,draggable,draggableElement,dropElement,rect){var dropped=!1;if(!(rect=rect||this.getRect(dropElement)))return!!this.options.drop.checker&&this.options.drop.checker(dragEvent,event,dropped,this,dropElement,draggable,draggableElement);var dropOverlap=this.options.drop.overlap;if("pointer"===dropOverlap){var horizontal,vertical,page=getPageXY(dragEvent),origin=getOriginXY(draggable,draggableElement);page.x+=origin.x,page.y+=origin.y,horizontal=page.x>rect.left&&page.x<rect.right,vertical=page.y>rect.top&&page.y<rect.bottom,dropped=horizontal&&vertical}var dragRect=draggable.getRect(draggableElement);if("center"===dropOverlap){var cx=dragRect.left+dragRect.width/2,cy=dragRect.top+dragRect.height/2;dropped=cx>=rect.left&&cx<=rect.right&&cy>=rect.top&&cy<=rect.bottom}if(isNumber(dropOverlap)){dropped=Math.max(0,Math.min(rect.right,dragRect.right)-Math.max(rect.left,dragRect.left))*Math.max(0,Math.min(rect.bottom,dragRect.bottom)-Math.max(rect.top,dragRect.top))/(dragRect.width*dragRect.height)>=dropOverlap}return this.options.drop.checker&&(dropped=this.options.drop.checker(dragEvent,event,dropped,this,dropElement,draggable,draggableElement)),dropped},dropChecker:function(checker){return isFunction(checker)?(this.options.drop.checker=checker,this):null===checker?(delete this.options.getRect,this):this.options.drop.checker},accept:function(newValue){return isElement(newValue)?(this.options.drop.accept=newValue,this):trySelector(newValue)?(this.options.drop.accept=newValue,this):null===newValue?(delete this.options.drop.accept,this):this.options.drop.accept},resizable:function(options){return isObject(options)?(this.options.resize.enabled=!1!==options.enabled,this.setPerAction("resize",options),this.setOnEvents("resize",options),/^x$|^y$|^xy$/.test(options.axis)?this.options.resize.axis=options.axis:null===options.axis&&(this.options.resize.axis=defaultOptions.resize.axis),isBool(options.preserveAspectRatio)?this.options.resize.preserveAspectRatio=options.preserveAspectRatio:isBool(options.square)&&(this.options.resize.square=options.square),this):isBool(options)?(this.options.resize.enabled=options,this):this.options.resize},squareResize:function(newValue){return isBool(newValue)?(this.options.resize.square=newValue,this):null===newValue?(delete this.options.resize.square,this):this.options.resize.square},gesturable:function(options){return isObject(options)?(this.options.gesture.enabled=!1!==options.enabled,this.setPerAction("gesture",options),this.setOnEvents("gesture",options),this):isBool(options)?(this.options.gesture.enabled=options,this):this.options.gesture},autoScroll:function(options){return isObject(options)?options=extend({actions:["drag","resize"]},options):isBool(options)&&(options={actions:["drag","resize"],enabled:options}),this.setOptions("autoScroll",options)},snap:function(options){var ret=this.setOptions("snap",options);return ret===this?this:ret.drag},setOptions:function(option,options){var i,actions=options&&isArray(options.actions)?options.actions:["drag"];if(isObject(options)||isBool(options)){for(i=0;i<actions.length;i++){var action=/resize/.test(actions[i])?"resize":actions[i];if(isObject(this.options[action])){var thisOption=this.options[action][option];isObject(options)?(extend(thisOption,options),thisOption.enabled=!1!==options.enabled,"snap"===option&&("grid"===thisOption.mode?thisOption.targets=[interact.createSnapGrid(extend({offset:thisOption.gridOffset||{x:0,y:0}},thisOption.grid||{}))]:"anchor"===thisOption.mode?thisOption.targets=thisOption.anchors:"path"===thisOption.mode&&(thisOption.targets=thisOption.paths),"elementOrigin"in options&&(thisOption.relativePoints=[options.elementOrigin]))):isBool(options)&&(thisOption.enabled=options)}}return this}var ret={},allActions=["drag","resize","gesture"];for(i=0;i<allActions.length;i++)option in defaultOptions[allActions[i]]&&(ret[allActions[i]]=this.options[allActions[i]][option]);return ret},inertia:function(options){var ret=this.setOptions("inertia",options);return ret===this?this:ret.drag},getAction:function(pointer,event,interaction,element){var action=this.defaultActionChecker(pointer,interaction,element);return this.options.actionChecker?this.options.actionChecker(pointer,event,action,this,element,interaction):action},defaultActionChecker:defaultActionChecker,actionChecker:function(checker){return isFunction(checker)?(this.options.actionChecker=checker,this):null===checker?(delete this.options.actionChecker,this):this.options.actionChecker},getRect:function(element){return element=element||this._element,this.selector&&!isElement(element)&&(element=this._context.querySelector(this.selector)),getElementRect(element)},rectChecker:function(checker){return isFunction(checker)?(this.getRect=checker,this):null===checker?(delete this.options.getRect,this):this.getRect},styleCursor:function(newValue){return isBool(newValue)?(this.options.styleCursor=newValue,this):null===newValue?(delete this.options.styleCursor,this):this.options.styleCursor},preventDefault:function(newValue){return/^(always|never|auto)$/.test(newValue)?(this.options.preventDefault=newValue,this):isBool(newValue)?(this.options.preventDefault=newValue?"always":"never",this):this.options.preventDefault},origin:function(newValue){return trySelector(newValue)?(this.options.origin=newValue,this):isObject(newValue)?(this.options.origin=newValue,this):this.options.origin},deltaSource:function(newValue){return"page"===newValue||"client"===newValue?(this.options.deltaSource=newValue,this):this.options.deltaSource},restrict:function(options){if(!isObject(options))return this.setOptions("restrict",options);for(var ret,actions=["drag","resize","gesture"],i=0;i<actions.length;i++){var action=actions[i];if(action in options){var perAction=extend({actions:[action],restriction:options[action]},options);ret=this.setOptions("restrict",perAction)}}return ret},context:function(){return this._context},_context:document,ignoreFrom:function(newValue){return trySelector(newValue)?(this.options.ignoreFrom=newValue,this):isElement(newValue)?(this.options.ignoreFrom=newValue,this):this.options.ignoreFrom},allowFrom:function(newValue){return trySelector(newValue)?(this.options.allowFrom=newValue,this):isElement(newValue)?(this.options.allowFrom=newValue,this):this.options.allowFrom},element:function(){return this._element},fire:function(iEvent){if(!iEvent||!iEvent.type||!contains(eventTypes,iEvent.type))return this;var listeners,i,len,onEvent="on"+iEvent.type;if(iEvent.type in this._iEvents)for(listeners=this._iEvents[iEvent.type],i=0,len=listeners.length;i<len&&!iEvent.immediatePropagationStopped;i++)listeners[i].name,listeners[i](iEvent);if(isFunction(this[onEvent])&&(this[onEvent].name,this[onEvent](iEvent)),iEvent.type in globalEvents&&(listeners=globalEvents[iEvent.type]))for(i=0,len=listeners.length;i<len&&!iEvent.immediatePropagationStopped;i++)listeners[i].name,listeners[i](iEvent);return this},on:function(eventType,listener,useCapture){var i;if(isString(eventType)&&-1!==eventType.search(" ")&&(eventType=eventType.trim().split(/ +/)),isArray(eventType)){for(i=0;i<eventType.length;i++)this.on(eventType[i],listener,useCapture);return this}if(isObject(eventType)){for(var prop in eventType)this.on(prop,eventType[prop],listener);return this}if("wheel"===eventType&&(eventType=wheelEvent),useCapture=!!useCapture,contains(eventTypes,eventType))eventType in this._iEvents?this._iEvents[eventType].push(listener):this._iEvents[eventType]=[listener];else if(this.selector){if(!delegatedEvents[eventType])for(delegatedEvents[eventType]={selectors:[],contexts:[],listeners:[]},i=0;i<documents.length;i++)events.add(documents[i],eventType,delegateListener),events.add(documents[i],eventType,delegateUseCapture,!0);var index,delegated=delegatedEvents[eventType];for(index=delegated.selectors.length-1;index>=0&&(delegated.selectors[index]!==this.selector||delegated.contexts[index]!==this._context);index--);-1===index&&(index=delegated.selectors.length,delegated.selectors.push(this.selector),delegated.contexts.push(this._context),delegated.listeners.push([])),delegated.listeners[index].push([listener,useCapture])}else events.add(this._element,eventType,listener,useCapture);return this},off:function(eventType,listener,useCapture){var i;if(isString(eventType)&&-1!==eventType.search(" ")&&(eventType=eventType.trim().split(/ +/)),isArray(eventType)){for(i=0;i<eventType.length;i++)this.off(eventType[i],listener,useCapture);return this}if(isObject(eventType)){for(var prop in eventType)this.off(prop,eventType[prop],listener);return this}var eventList,index=-1;if(useCapture=!!useCapture,"wheel"===eventType&&(eventType=wheelEvent),contains(eventTypes,eventType))(eventList=this._iEvents[eventType])&&-1!==(index=indexOf(eventList,listener))&&this._iEvents[eventType].splice(index,1);else if(this.selector){var delegated=delegatedEvents[eventType],matchFound=!1;if(!delegated)return this;for(index=delegated.selectors.length-1;index>=0;index--)if(delegated.selectors[index]===this.selector&&delegated.contexts[index]===this._context){var listeners=delegated.listeners[index];for(i=listeners.length-1;i>=0;i--){var fn=listeners[i][0],useCap=listeners[i][1];if(fn===listener&&useCap===useCapture){listeners.splice(i,1),listeners.length||(delegated.selectors.splice(index,1),delegated.contexts.splice(index,1),delegated.listeners.splice(index,1),events.remove(this._context,eventType,delegateListener),events.remove(this._context,eventType,delegateUseCapture,!0),delegated.selectors.length||(delegatedEvents[eventType]=null)),matchFound=!0;break}}if(matchFound)break}}else events.remove(this._element,eventType,listener,useCapture);return this},set:function(options){isObject(options)||(options={}),this.options=extend({},defaultOptions.base);var i,actions=["drag","drop","resize","gesture"],methods=["draggable","dropzone","resizable","gesturable"],perActions=extend(extend({},defaultOptions.perAction),options[action]||{});for(i=0;i<actions.length;i++){var action=actions[i];this.options[action]=extend({},defaultOptions[action]),this.setPerAction(action,perActions),this[methods[i]](options[action])}var settings=["accept","actionChecker","allowFrom","deltaSource","dropChecker","ignoreFrom","origin","preventDefault","rectChecker","styleCursor"];for(i=0,len=settings.length;i<len;i++){var setting=settings[i];this.options[setting]=defaultOptions.base[setting],setting in options&&this[setting](options[setting])}return this},unset:function(){if(events.remove(this._element,"all"),isString(this.selector))for(var type in delegatedEvents)for(var delegated=delegatedEvents[type],i=0;i<delegated.selectors.length;i++){delegated.selectors[i]===this.selector&&delegated.contexts[i]===this._context&&(delegated.selectors.splice(i,1),delegated.contexts.splice(i,1),delegated.listeners.splice(i,1),delegated.selectors.length||(delegatedEvents[type]=null)),events.remove(this._context,type,delegateListener),events.remove(this._context,type,delegateUseCapture,!0);break}else events.remove(this,"all"),this.options.styleCursor&&(this._element.style.cursor="");return this.dropzone(!1),interactables.splice(indexOf(interactables,this),1),interact}},Interactable.prototype.snap=warnOnce(Interactable.prototype.snap,"Interactable#snap is deprecated. See the new documentation for snapping at http://interactjs.io/docs/snapping"),Interactable.prototype.restrict=warnOnce(Interactable.prototype.restrict,"Interactable#restrict is deprecated. See the new documentation for resticting at http://interactjs.io/docs/restriction"),Interactable.prototype.inertia=warnOnce(Interactable.prototype.inertia,"Interactable#inertia is deprecated. See the new documentation for inertia at http://interactjs.io/docs/inertia"),Interactable.prototype.autoScroll=warnOnce(Interactable.prototype.autoScroll,"Interactable#autoScroll is deprecated. See the new documentation for autoScroll at http://interactjs.io/docs/#autoscroll"),Interactable.prototype.squareResize=warnOnce(Interactable.prototype.squareResize,"Interactable#squareResize is deprecated. See http://interactjs.io/docs/#resize-square"),Interactable.prototype.accept=warnOnce(Interactable.prototype.accept,"Interactable#accept is deprecated. use Interactable#dropzone({ accept: target }) instead"),Interactable.prototype.dropChecker=warnOnce(Interactable.prototype.dropChecker,"Interactable#dropChecker is deprecated. use Interactable#dropzone({ dropChecker: checkerFunction }) instead"),Interactable.prototype.context=warnOnce(Interactable.prototype.context,"Interactable#context as a method is deprecated. It will soon be a DOM Node instead"),interact.isSet=function(element,options){return-1!==interactables.indexOfElement(element,options&&options.context)},interact.on=function(type,listener,useCapture){if(isString(type)&&-1!==type.search(" ")&&(type=type.trim().split(/ +/)),isArray(type)){for(var i=0;i<type.length;i++)interact.on(type[i],listener,useCapture);return interact}if(isObject(type)){for(var prop in type)interact.on(prop,type[prop],listener);return interact}return contains(eventTypes,type)?globalEvents[type]?globalEvents[type].push(listener):globalEvents[type]=[listener]:events.add(document,type,listener,useCapture),interact},interact.off=function(type,listener,useCapture){if(isString(type)&&-1!==type.search(" ")&&(type=type.trim().split(/ +/)),isArray(type)){for(var i=0;i<type.length;i++)interact.off(type[i],listener,useCapture);return interact}if(isObject(type)){for(var prop in type)interact.off(prop,type[prop],listener);return interact}if(contains(eventTypes,type)){var index;type in globalEvents&&-1!==(index=indexOf(globalEvents[type],listener))&&globalEvents[type].splice(index,1)}else events.remove(document,type,listener,useCapture);return interact},interact.enableDragging=warnOnce(function(newValue){return null!==newValue&&void 0!==newValue?(actionIsEnabled.drag=newValue,interact):actionIsEnabled.drag},"interact.enableDragging is deprecated and will soon be removed."),interact.enableResizing=warnOnce(function(newValue){return null!==newValue&&void 0!==newValue?(actionIsEnabled.resize=newValue,interact):actionIsEnabled.resize},"interact.enableResizing is deprecated and will soon be removed."),interact.enableGesturing=warnOnce(function(newValue){return null!==newValue&&void 0!==newValue?(actionIsEnabled.gesture=newValue,interact):actionIsEnabled.gesture},"interact.enableGesturing is deprecated and will soon be removed."),interact.eventTypes=eventTypes,interact.debug=function(){var interaction=interactions[0]||new Interaction;return{interactions:interactions,target:interaction.target,dragging:interaction.dragging,resizing:interaction.resizing,gesturing:interaction.gesturing,prepared:interaction.prepared,matches:interaction.matches,matchElements:interaction.matchElements,prevCoords:interaction.prevCoords,startCoords:interaction.startCoords,pointerIds:interaction.pointerIds,pointers:interaction.pointers,addPointer:listeners.addPointer,removePointer:listeners.removePointer,recordPointer:listeners.recordPointer,snap:interaction.snapStatus,restrict:interaction.restrictStatus,inertia:interaction.inertiaStatus,downTime:interaction.downTimes[0],downEvent:interaction.downEvent,downPointer:interaction.downPointer,prevEvent:interaction.prevEvent,Interactable:Interactable,interactables:interactables,pointerIsDown:interaction.pointerIsDown,defaultOptions:defaultOptions,defaultActionChecker:defaultActionChecker,actionCursors:actionCursors,dragMove:listeners.dragMove,resizeMove:listeners.resizeMove,gestureMove:listeners.gestureMove,pointerUp:listeners.pointerUp,pointerDown:listeners.pointerDown,pointerMove:listeners.pointerMove,pointerHover:listeners.pointerHover,eventTypes:eventTypes,events:events,globalEvents:globalEvents,delegatedEvents:delegatedEvents,prefixedPropREs:prefixedPropREs}},interact.getPointerAverage=pointerAverage,interact.getTouchBBox=touchBBox,interact.getTouchDistance=touchDistance,interact.getTouchAngle=touchAngle,interact.getElementRect=getElementRect,interact.getElementClientRect=getElementClientRect,interact.matchesSelector=matchesSelector,interact.closest=closest,interact.margin=warnOnce(function(newvalue){return isNumber(newvalue)?(margin=newvalue,interact):margin},"interact.margin is deprecated. Use interact(target).resizable({ margin: number }); instead."),interact.supportsTouch=function(){return supportsTouch},interact.supportsPointerEvent=function(){return supportsPointerEvent},interact.stop=function(event){for(var i=interactions.length-1;i>=0;i--)interactions[i].stop(event);return interact},interact.dynamicDrop=function(newValue){return isBool(newValue)?(dynamicDrop=newValue,interact):dynamicDrop},interact.pointerMoveTolerance=function(newValue){return isNumber(newValue)?(pointerMoveTolerance=newValue,this):pointerMoveTolerance},interact.maxInteractions=function(newValue){return isNumber(newValue)?(maxInteractions=newValue,this):maxInteractions},interact.createSnapGrid=function(grid){return function(x,y){var offsetX=0,offsetY=0;isObject(grid.offset)&&(offsetX=grid.offset.x,offsetY=grid.offset.y);var gridx=Math.round((x-offsetX)/grid.x),gridy=Math.round((y-offsetY)/grid.y);return{x:gridx*grid.x+offsetX,y:gridy*grid.y+offsetY,range:grid.range}}},listenToDocument(document),prefixedMatchesSelector in Element.prototype&&isFunction(Element.prototype[prefixedMatchesSelector])||(ie8MatchesSelector=function(element,selector,elems){elems=elems||element.parentNode.querySelectorAll(selector);for(var i=0,len=elems.length;i<len;i++)if(elems[i]===element)return!0;return!1}),function(){for(var lastTime=0,vendors=["ms","moz","webkit","o"],x=0;x<vendors.length&&!realWindow.requestAnimationFrame;++x)reqFrame=realWindow[vendors[x]+"RequestAnimationFrame"],cancelFrame=realWindow[vendors[x]+"CancelAnimationFrame"]||realWindow[vendors[x]+"CancelRequestAnimationFrame"];reqFrame||(reqFrame=function(callback){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id}),cancelFrame||(cancelFrame=function(id){clearTimeout(id)})}(),void 0!==module&&module.exports&&(exports=module.exports=interact),exports.interact=interact}}("undefined"==typeof window?void 0:window)},33:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(4),__webpack_require__(2),__webpack_require__(176)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,_,MailPoet){var Module={};return Module._query=function(args){return MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"automatedLatestContent",action:args.action,data:args.options||{}})},Module._cachedQuery=_.memoize(Module._query,JSON.stringify),Module.getNewsletter=function(options){return Module._query({action:"get",options:options})},Module.getPostTypes=function(){return Module._cachedQuery({action:"getPostTypes",options:{}}).then(function(response){return _.values(response.data)})},Module.getTaxonomies=function(postType){return Module._cachedQuery({action:"getTaxonomies",options:{postType:postType}}).then(function(response){return response.data})},Module.getTerms=function(options){return Module._cachedQuery({action:"getTerms",options:options}).then(function(response){return response.data})},Module.getPosts=function(options){return Module._cachedQuery({action:"getPosts",options:options}).then(function(response){return response.data})},Module.getTransformedPosts=function(options){return Module._cachedQuery({action:"getTransformedPosts",options:options}).then(function(response){return response.data})},Module.getBulkTransformedPosts=function(options){return Module._query({action:"getBulkTransformedPosts",options:options}).then(function(response){return response.data})},Module.saveNewsletter=function(options){return MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"save",data:options||{}})},Module.previewNewsletter=function(options){return MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"sendPreview",data:options||{}})},App.on("start",function(){Module.getPostTypes()}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},465:function(module,exports,__webpack_require__){"use strict";__webpack_require__(466),__webpack_require__(467),__webpack_require__(468),__webpack_require__(9),__webpack_require__(471),__webpack_require__(472),__webpack_require__(473),__webpack_require__(474),__webpack_require__(475),__webpack_require__(476),__webpack_require__(33),__webpack_require__(19),__webpack_require__(480),__webpack_require__(482),__webpack_require__(483),__webpack_require__(484),__webpack_require__(485),__webpack_require__(486),__webpack_require__(487),__webpack_require__(488),__webpack_require__(489),__webpack_require__(490),__webpack_require__(491),__webpack_require__(189),__webpack_require__(492),__webpack_require__(190),__webpack_require__(493),__webpack_require__(494),__webpack_require__(495),__webpack_require__(496),__webpack_require__(497),__webpack_require__(498),__webpack_require__(499),__webpack_require__(500)},466:function(module,exports){/**
@license Sticky-kit v1.1.2 | WTFPL | Leaf Corcoran 2015 | http://leafo.net
 */
(function(){var $,win;$=this.jQuery||window.jQuery,win=$(window),$.fn.stick_in_parent=function(opts){var doc,elm,enable_bottoming,fn,i,inner_scrolling,len,manual_spacer,offset_top,outer_width,parent_selector,recalc_every,sticky_class;for(null==opts&&(opts={}),sticky_class=opts.sticky_class,inner_scrolling=opts.inner_scrolling,recalc_every=opts.recalc_every,parent_selector=opts.parent,offset_top=opts.offset_top,manual_spacer=opts.spacer,enable_bottoming=opts.bottoming,null==offset_top&&(offset_top=0),null==parent_selector&&(parent_selector=void 0),null==inner_scrolling&&(inner_scrolling=!0),null==sticky_class&&(sticky_class="is_stuck"),doc=$(document),null==enable_bottoming&&(enable_bottoming=!0),outer_width=function(el){var computed,w;return window.getComputedStyle?(el[0],computed=window.getComputedStyle(el[0]),w=parseFloat(computed.getPropertyValue("width"))+parseFloat(computed.getPropertyValue("margin-left"))+parseFloat(computed.getPropertyValue("margin-right")),"border-box"!==computed.getPropertyValue("box-sizing")&&(w+=parseFloat(computed.getPropertyValue("border-left-width"))+parseFloat(computed.getPropertyValue("border-right-width"))+parseFloat(computed.getPropertyValue("padding-left"))+parseFloat(computed.getPropertyValue("padding-right"))),w):el.outerWidth(!0)},fn=function(elm,padding_bottom,parent_top,parent_height,top,height,el_float,detached){var bottomed,detach,fixed,last_pos,last_scroll_height,offset,parent,recalc,recalc_and_tick,recalc_counter,spacer,tick;if(!elm.data("sticky_kit")){if(elm.data("sticky_kit",!0),last_scroll_height=doc.height(),parent=elm.parent(),null!=parent_selector&&(parent=parent.closest(parent_selector)),!parent.length)throw"failed to find stick parent";return fixed=!1,bottomed=!1,spacer=null!=manual_spacer?manual_spacer&&elm.closest(manual_spacer):$("<div />"),spacer&&spacer.css("position",elm.css("position")),recalc=function(){var border_top,padding_top,restore;if(!detached)return last_scroll_height=doc.height(),border_top=parseInt(parent.css("border-top-width"),10),padding_top=parseInt(parent.css("padding-top"),10),padding_bottom=parseInt(parent.css("padding-bottom"),10),parent_top=parent.offset().top+border_top+padding_top,parent_height=parent.height(),fixed&&(fixed=!1,bottomed=!1,null==manual_spacer&&(elm.insertAfter(spacer),spacer.detach()),elm.css({position:"",top:"",width:"",bottom:""}).removeClass(sticky_class),restore=!0),top=elm.offset().top-(parseInt(elm.css("margin-top"),10)||0)-offset_top,height=elm.outerHeight(!0),el_float=elm.css("float"),spacer&&spacer.css({width:outer_width(elm),height:height,display:elm.css("display"),"vertical-align":elm.css("vertical-align"),float:el_float}),restore?tick():void 0},recalc(),last_pos=void 0,offset=offset_top,recalc_counter=recalc_every,tick=function(){var css,delta,recalced,scroll,will_bottom,win_height;if(!detached)return recalced=!1,null!=recalc_counter&&(recalc_counter-=1)<=0&&(recalc_counter=recalc_every,recalc(),recalced=!0),recalced||doc.height()===last_scroll_height||(recalc(),recalced=!0),scroll=win.scrollTop(),null!=last_pos&&(delta=scroll-last_pos),last_pos=scroll,fixed?(enable_bottoming&&(will_bottom=scroll+height+offset>parent_height+parent_top,bottomed&&!will_bottom&&(bottomed=!1,elm.css({position:"fixed",bottom:"",top:offset}).trigger("sticky_kit:unbottom"))),scroll<top&&(fixed=!1,offset=offset_top,null==manual_spacer&&("left"!==el_float&&"right"!==el_float||elm.insertAfter(spacer),spacer.detach()),css={position:"",width:"",top:""},elm.css(css).removeClass(sticky_class).trigger("sticky_kit:unstick")),inner_scrolling&&(win_height=win.height(),height+offset_top>win_height&&(bottomed||(offset-=delta,offset=Math.max(win_height-height,offset),offset=Math.min(offset_top,offset),fixed&&elm.css({top:offset+"px"}))))):scroll>top&&(fixed=!0,css={position:"fixed",top:offset},css.width="border-box"===elm.css("box-sizing")?elm.outerWidth()+"px":elm.width()+"px",elm.css(css).addClass(sticky_class),null==manual_spacer&&(elm.after(spacer),"left"!==el_float&&"right"!==el_float||spacer.append(elm)),elm.trigger("sticky_kit:stick")),fixed&&enable_bottoming&&(null==will_bottom&&(will_bottom=scroll+height+offset>parent_height+parent_top),!bottomed&&will_bottom)?(bottomed=!0,"static"===parent.css("position")&&parent.css({position:"relative"}),elm.css({position:"absolute",bottom:padding_bottom,top:"auto"}).trigger("sticky_kit:bottom")):void 0},recalc_and_tick=function(){return recalc(),tick()},detach=function(){if(detached=!0,win.off("touchmove",tick),win.off("scroll",tick),win.off("resize",recalc_and_tick),$(document.body).off("sticky_kit:recalc",recalc_and_tick),elm.off("sticky_kit:detach",detach),elm.removeData("sticky_kit"),elm.css({position:"",bottom:"",top:"",width:""}),parent.position("position",""),fixed)return null==manual_spacer&&("left"!==el_float&&"right"!==el_float||elm.insertAfter(spacer),spacer.remove()),elm.removeClass(sticky_class)},win.on("touchmove",tick),win.on("scroll",tick),win.on("resize",recalc_and_tick),$(document.body).on("sticky_kit:recalc",recalc_and_tick),elm.on("sticky_kit:detach",detach),setTimeout(tick,0)}},i=0,len=this.length;i<len;i++)elm=this[i],fn($(elm));return this}}).call(this)},467:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__,jQuery=__webpack_require__(5);!function(window){function isArraylike(obj){var length=obj.length,type=$.type(obj);return"function"!==type&&!$.isWindow(obj)&&(!(1!==obj.nodeType||!length)||("array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj))}if(!window.jQuery){var $=function(selector,context){return new $.fn.init(selector,context)};$.isWindow=function(obj){return null!=obj&&obj==obj.window},$.type=function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},$.isArray=Array.isArray||function(obj){return"array"===$.type(obj)},$.isPlainObject=function(obj){var key;if(!obj||"object"!==$.type(obj)||obj.nodeType||$.isWindow(obj))return!1;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(key in obj);return void 0===key||hasOwn.call(obj,key)},$.each=function(obj,callback,args){var i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;i<length&&!1!==callback.apply(obj[i],args);i++);else for(i in obj)if(!1===callback.apply(obj[i],args))break}else if(isArray)for(;i<length&&!1!==callback.call(obj[i],i,obj[i]);i++);else for(i in obj)if(!1===callback.call(obj[i],i,obj[i]))break;return obj},$.data=function(node,key,value){if(void 0===value){var id=node[$.expando],store=id&&cache[id];if(void 0===key)return store;if(store&&key in store)return store[key]}else if(void 0!==key){var id=node[$.expando]||(node[$.expando]=++$.uuid);return cache[id]=cache[id]||{},cache[id][key]=value,value}},$.removeData=function(node,keys){var id=node[$.expando],store=id&&cache[id];store&&$.each(keys,function(_,key){delete store[key]})},$.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"!=typeof target&&"function"!==$.type(target)&&(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&($.isPlainObject(copy)||(copyIsArray=$.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&$.isArray(src)?src:[]):clone=src&&$.isPlainObject(src)?src:{},target[name]=$.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},$.queue=function(elem,type,data){if(elem){type=(type||"fx")+"queue";var q=$.data(elem,type);return data?(!q||$.isArray(data)?q=$.data(elem,type,function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;)first[i++]=second[j++];if(len!==len)for(;void 0!==second[j];)first[i++]=second[j++];first.length=i}(ret,"string"==typeof arr?[arr]:arr):[].push.call(ret,arr)),ret}(data)):q.push(data),q):q||[]}},$.dequeue=function(elems,type){$.each(elems.nodeType?[elems]:elems,function(i,elem){type=type||"fx";var queue=$.queue(elem,type),fn=queue.shift();"inprogress"===fn&&(fn=queue.shift()),fn&&("fx"===type&&queue.unshift("inprogress"),fn.call(elem,function(){$.dequeue(elem,type)}))})},$.fn=$.prototype={init:function(selector){if(selector.nodeType)return this[0]=selector,this;throw new Error("Not a DOM node.")},offset:function(){var box=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:box.top+(window.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:box.left+(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function offsetParent(){for(var offsetParent=this.offsetParent||document;offsetParent&&"html"===!offsetParent.nodeType.toLowerCase&&"static"===offsetParent.style.position;)offsetParent=offsetParent.offsetParent;return offsetParent||document}var elem=this[0],offsetParent=offsetParent.apply(elem),offset=this.offset(),parentOffset=/^(?:body|html)$/i.test(offsetParent.nodeName)?{top:0,left:0}:$(offsetParent).offset();return offset.top-=parseFloat(elem.style.marginTop)||0,offset.left-=parseFloat(elem.style.marginLeft)||0,offsetParent.style&&(parentOffset.top+=parseFloat(offsetParent.style.borderTopWidth)||0,parentOffset.left+=parseFloat(offsetParent.style.borderLeftWidth)||0),{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}}};var cache={};$.expando="velocity"+(new Date).getTime(),$.uuid=0;for(var class2type={},hasOwn=class2type.hasOwnProperty,toString=class2type.toString,types="Boolean Number String Function Array Date RegExp Object Error".split(" "),i=0;i<types.length;i++)class2type["[object "+types[i]+"]"]=types[i].toLowerCase();$.fn.init.prototype=$.fn,window.Velocity={Utilities:$}}}(window),function(factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=factory():(__WEBPACK_AMD_DEFINE_FACTORY__=factory,void 0!==(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__)&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(function(){return function(global,window,document,undefined){function compactSparseArray(array){for(var index=-1,length=array?array.length:0,result=[];++index<length;){var value=array[index];value&&result.push(value)}return result}function sanitizeElements(elements){return Type.isWrapped(elements)?elements=[].slice.call(elements):Type.isNode(elements)&&(elements=[elements]),elements}function Data(element){var response=$.data(element,"velocity");return null===response?undefined:response}function generateStep(steps){return function(p){return Math.round(p*steps)*(1/steps)}}function generateBezier(mX1,mY1,mX2,mY2){function A(aA1,aA2){return 1-3*aA2+3*aA1}function B(aA1,aA2){return 3*aA2-6*aA1}function C(aA1){return 3*aA1}function calcBezier(aT,aA1,aA2){return((A(aA1,aA2)*aT+B(aA1,aA2))*aT+C(aA1))*aT}function getSlope(aT,aA1,aA2){return 3*A(aA1,aA2)*aT*aT+2*B(aA1,aA2)*aT+C(aA1)}function newtonRaphsonIterate(aX,aGuessT){for(var i=0;i<NEWTON_ITERATIONS;++i){var currentSlope=getSlope(aGuessT,mX1,mX2);if(0===currentSlope)return aGuessT;aGuessT-=(calcBezier(aGuessT,mX1,mX2)-aX)/currentSlope}return aGuessT}function calcSampleValues(){for(var i=0;i<kSplineTableSize;++i)mSampleValues[i]=calcBezier(i*kSampleStepSize,mX1,mX2)}function binarySubdivide(aX,aA,aB){var currentX,currentT,i=0;do{currentT=aA+(aB-aA)/2,currentX=calcBezier(currentT,mX1,mX2)-aX,currentX>0?aB=currentT:aA=currentT}while(Math.abs(currentX)>SUBDIVISION_PRECISION&&++i<SUBDIVISION_MAX_ITERATIONS);return currentT}function getTForX(aX){for(var intervalStart=0,currentSample=1,lastSample=kSplineTableSize-1;currentSample!=lastSample&&mSampleValues[currentSample]<=aX;++currentSample)intervalStart+=kSampleStepSize;--currentSample;var dist=(aX-mSampleValues[currentSample])/(mSampleValues[currentSample+1]-mSampleValues[currentSample]),guessForT=intervalStart+dist*kSampleStepSize,initialSlope=getSlope(guessForT,mX1,mX2);return initialSlope>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(aX,guessForT):0==initialSlope?guessForT:binarySubdivide(aX,intervalStart,intervalStart+kSampleStepSize)}function precompute(){_precomputed=!0,mX1==mY1&&mX2==mY2||calcSampleValues()}var NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported="Float32Array"in window;if(4!==arguments.length)return!1;for(var i=0;i<4;++i)if("number"!=typeof arguments[i]||isNaN(arguments[i])||!isFinite(arguments[i]))return!1;mX1=Math.min(mX1,1),mX2=Math.min(mX2,1),mX1=Math.max(mX1,0),mX2=Math.max(mX2,0);var mSampleValues=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize),_precomputed=!1,f=function(aX){return _precomputed||precompute(),mX1===mY1&&mX2===mY2?aX:0===aX?0:1===aX?1:calcBezier(getTForX(aX),mY1,mY2)};f.getControlPoints=function(){return[{x:mX1,y:mY1},{x:mX2,y:mY2}]};var str="generateBezier("+[mX1,mY1,mX2,mY2]+")";return f.toString=function(){return str},f}function getEasing(value,duration){var easing=value;return Type.isString(value)?Velocity.Easings[value]||(easing=!1):easing=Type.isArray(value)&&1===value.length?generateStep.apply(null,value):Type.isArray(value)&&2===value.length?generateSpringRK4.apply(null,value.concat([duration])):!(!Type.isArray(value)||4!==value.length)&&generateBezier.apply(null,value),!1===easing&&(easing=Velocity.Easings[Velocity.defaults.easing]?Velocity.defaults.easing:EASING_DEFAULT),easing}function tick(timestamp){if(timestamp){var timeCurrent=(new Date).getTime(),callsLength=Velocity.State.calls.length;callsLength>1e4&&(Velocity.State.calls=compactSparseArray(Velocity.State.calls));for(var i=0;i<callsLength;i++)if(Velocity.State.calls[i]){var callContainer=Velocity.State.calls[i],call=callContainer[0],opts=callContainer[2],timeStart=callContainer[3],firstTick=!!timeStart,tweenDummyValue=null;timeStart||(timeStart=Velocity.State.calls[i][3]=timeCurrent-16);for(var percentComplete=Math.min((timeCurrent-timeStart)/opts.duration,1),j=0,callLength=call.length;j<callLength;j++){var tweensContainer=call[j],element=tweensContainer.element;if(Data(element)){var transformPropertyExists=!1;if(opts.display!==undefined&&null!==opts.display&&"none"!==opts.display){if("flex"===opts.display){var flexValues=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];$.each(flexValues,function(i,flexValue){CSS.setPropertyValue(element,"display",flexValue)})}CSS.setPropertyValue(element,"display",opts.display)}opts.visibility!==undefined&&"hidden"!==opts.visibility&&CSS.setPropertyValue(element,"visibility",opts.visibility);for(var property in tweensContainer)if("element"!==property){var currentValue,tween=tweensContainer[property],easing=Type.isString(tween.easing)?Velocity.Easings[tween.easing]:tween.easing;if(1===percentComplete)currentValue=tween.endValue;else{var tweenDelta=tween.endValue-tween.startValue;if(currentValue=tween.startValue+tweenDelta*easing(percentComplete,opts,tweenDelta),!firstTick&&currentValue===tween.currentValue)continue}if(tween.currentValue=currentValue,"tween"===property)tweenDummyValue=currentValue;else{if(CSS.Hooks.registered[property]){var hookRoot=CSS.Hooks.getRoot(property),rootPropertyValueCache=Data(element).rootPropertyValueCache[hookRoot];rootPropertyValueCache&&(tween.rootPropertyValue=rootPropertyValueCache)}var adjustedSetData=CSS.setPropertyValue(element,property,tween.currentValue+(0===parseFloat(currentValue)?"":tween.unitType),tween.rootPropertyValue,tween.scrollData);CSS.Hooks.registered[property]&&(CSS.Normalizations.registered[hookRoot]?Data(element).rootPropertyValueCache[hookRoot]=CSS.Normalizations.registered[hookRoot]("extract",null,adjustedSetData[1]):Data(element).rootPropertyValueCache[hookRoot]=adjustedSetData[1]),"transform"===adjustedSetData[0]&&(transformPropertyExists=!0)}}opts.mobileHA&&Data(element).transformCache.translate3d===undefined&&(Data(element).transformCache.translate3d="(0px, 0px, 0px)",transformPropertyExists=!0),transformPropertyExists&&CSS.flushTransformCache(element)}}opts.display!==undefined&&"none"!==opts.display&&(Velocity.State.calls[i][2].display=!1),opts.visibility!==undefined&&"hidden"!==opts.visibility&&(Velocity.State.calls[i][2].visibility=!1),opts.progress&&opts.progress.call(callContainer[1],callContainer[1],percentComplete,Math.max(0,timeStart+opts.duration-timeCurrent),timeStart,tweenDummyValue),1===percentComplete&&completeCall(i)}}Velocity.State.isTicking&&ticker(tick)}function completeCall(callIndex,isStopped){if(!Velocity.State.calls[callIndex])return!1;for(var call=Velocity.State.calls[callIndex][0],elements=Velocity.State.calls[callIndex][1],opts=Velocity.State.calls[callIndex][2],resolver=Velocity.State.calls[callIndex][4],remainingCallsExist=!1,i=0,callLength=call.length;i<callLength;i++){var element=call[i].element;if(isStopped||opts.loop||("none"===opts.display&&CSS.setPropertyValue(element,"display",opts.display),"hidden"===opts.visibility&&CSS.setPropertyValue(element,"visibility",opts.visibility)),!0!==opts.loop&&($.queue(element)[1]===undefined||!/\.velocityQueueEntryFlag/i.test($.queue(element)[1]))&&Data(element)){Data(element).isAnimating=!1,Data(element).rootPropertyValueCache={};var transformHAPropertyExists=!1;$.each(CSS.Lists.transforms3D,function(i,transformName){var defaultValue=/^scale/.test(transformName)?1:0,currentValue=Data(element).transformCache[transformName];Data(element).transformCache[transformName]!==undefined&&new RegExp("^\\("+defaultValue+"[^.]").test(currentValue)&&(transformHAPropertyExists=!0,delete Data(element).transformCache[transformName])}),opts.mobileHA&&(transformHAPropertyExists=!0,delete Data(element).transformCache.translate3d),transformHAPropertyExists&&CSS.flushTransformCache(element),CSS.Values.removeClass(element,"velocity-animating")}if(!isStopped&&opts.complete&&!opts.loop&&i===callLength-1)try{opts.complete.call(elements,elements)}catch(error){setTimeout(function(){throw error},1)}resolver&&!0!==opts.loop&&resolver(elements),Data(element)&&!0===opts.loop&&!isStopped&&($.each(Data(element).tweensContainer,function(propertyName,tweenContainer){/^rotate/.test(propertyName)&&360===parseFloat(tweenContainer.endValue)&&(tweenContainer.endValue=0,tweenContainer.startValue=360),/^backgroundPosition/.test(propertyName)&&100===parseFloat(tweenContainer.endValue)&&"%"===tweenContainer.unitType&&(tweenContainer.endValue=0,tweenContainer.startValue=100)}),Velocity(element,"reverse",{loop:!0,delay:opts.delay})),!1!==opts.queue&&$.dequeue(element,opts.queue)}Velocity.State.calls[callIndex]=!1;for(var j=0,callsLength=Velocity.State.calls.length;j<callsLength;j++)if(!1!==Velocity.State.calls[j]){remainingCallsExist=!0;break}!1===remainingCallsExist&&(Velocity.State.isTicking=!1,delete Velocity.State.calls,Velocity.State.calls=[])}var $,IE=function(){if(document.documentMode)return document.documentMode;for(var i=7;i>4;i--){var div=document.createElement("div");if(div.innerHTML="\x3c!--[if IE "+i+"]><span></span><![endif]--\x3e",div.getElementsByTagName("span").length)return div=null,i}return undefined}(),rAFShim=function(){var timeLast=0;return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){var timeDelta,timeCurrent=(new Date).getTime();return timeDelta=Math.max(0,16-(timeCurrent-timeLast)),timeLast=timeCurrent+timeDelta,setTimeout(function(){callback(timeCurrent+timeDelta)},timeDelta)}}(),Type={isString:function(variable){return"string"==typeof variable},isArray:Array.isArray||function(variable){return"[object Array]"===Object.prototype.toString.call(variable)},isFunction:function(variable){return"[object Function]"===Object.prototype.toString.call(variable)},isNode:function(variable){return variable&&variable.nodeType},isNodeList:function(variable){return"object"==typeof variable&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(variable))&&variable.length!==undefined&&(0===variable.length||"object"==typeof variable[0]&&variable[0].nodeType>0)},isWrapped:function(variable){return variable&&(variable.jquery||window.Zepto&&window.Zepto.zepto.isZ(variable))},isSVG:function(variable){return window.SVGElement&&variable instanceof window.SVGElement},isEmptyObject:function(variable){for(var name in variable)return!1;return!0}},isJQuery=!1;if(global.fn&&global.fn.jquery?($=global,isJQuery=!0):$=window.Velocity.Utilities,IE<=8&&!isJQuery)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(IE<=7)return void(jQuery.fn.velocity=jQuery.fn.animate);var DURATION_DEFAULT=400,EASING_DEFAULT="swing",Velocity={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:window.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:document.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:$,Redirects:{},Easings:{},Promise:window.Promise,defaults:{queue:"",duration:DURATION_DEFAULT,easing:EASING_DEFAULT,begin:undefined,complete:undefined,progress:undefined,display:undefined,visibility:undefined,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(element){$.data(element,"velocity",{isSVG:Type.isSVG(element),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};window.pageYOffset!==undefined?(Velocity.State.scrollAnchor=window,Velocity.State.scrollPropertyLeft="pageXOffset",Velocity.State.scrollPropertyTop="pageYOffset"):(Velocity.State.scrollAnchor=document.documentElement||document.body.parentNode||document.body,Velocity.State.scrollPropertyLeft="scrollLeft",Velocity.State.scrollPropertyTop="scrollTop");var generateSpringRK4=function(){function springAccelerationForState(state){return-state.tension*state.x-state.friction*state.v}function springEvaluateStateWithDerivative(initialState,dt,derivative){var state={x:initialState.x+derivative.dx*dt,v:initialState.v+derivative.dv*dt,tension:initialState.tension,friction:initialState.friction};return{dx:state.v,dv:springAccelerationForState(state)}}function springIntegrateState(state,dt){var a={dx:state.v,dv:springAccelerationForState(state)},b=springEvaluateStateWithDerivative(state,.5*dt,a),c=springEvaluateStateWithDerivative(state,.5*dt,b),d=springEvaluateStateWithDerivative(state,dt,c),dxdt=1/6*(a.dx+2*(b.dx+c.dx)+d.dx),dvdt=1/6*(a.dv+2*(b.dv+c.dv)+d.dv);return state.x=state.x+dxdt*dt,state.v=state.v+dvdt*dt,state}return function springRK4Factory(tension,friction,duration){var have_duration,dt,last_state,initState={x:-1,v:0,tension:null,friction:null},path=[0],time_lapsed=0;for(tension=parseFloat(tension)||500,friction=parseFloat(friction)||20,duration=duration||null,initState.tension=tension,initState.friction=friction,have_duration=null!==duration,have_duration?(time_lapsed=springRK4Factory(tension,friction),dt=time_lapsed/duration*.016):dt=.016;;)if(last_state=springIntegrateState(last_state||initState,dt),path.push(1+last_state.x),time_lapsed+=16,!(Math.abs(last_state.x)>1e-4&&Math.abs(last_state.v)>1e-4))break;return have_duration?function(percentComplete){return path[percentComplete*(path.length-1)|0]}:time_lapsed}}();Velocity.Easings={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},spring:function(p){return 1-Math.cos(4.5*p*Math.PI)*Math.exp(6*-p)}},$.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(i,easingArray){Velocity.Easings[easingArray[0]]=generateBezier.apply(null,easingArray[1])});var CSS=Velocity.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var i=0;i<CSS.Lists.colors.length;i++){var rgbComponents="color"===CSS.Lists.colors[i]?"0 0 0 1":"255 255 255 1";CSS.Hooks.templates[CSS.Lists.colors[i]]=["Red Green Blue Alpha",rgbComponents]}var rootProperty,hookTemplate,hookNames;if(IE)for(rootProperty in CSS.Hooks.templates){hookTemplate=CSS.Hooks.templates[rootProperty],hookNames=hookTemplate[0].split(" ");var defaultValues=hookTemplate[1].match(CSS.RegEx.valueSplit);"Color"===hookNames[0]&&(hookNames.push(hookNames.shift()),defaultValues.push(defaultValues.shift()),CSS.Hooks.templates[rootProperty]=[hookNames.join(" "),defaultValues.join(" ")])}for(rootProperty in CSS.Hooks.templates){hookTemplate=CSS.Hooks.templates[rootProperty],hookNames=hookTemplate[0].split(" ");for(var i in hookNames){var fullHookName=rootProperty+hookNames[i],hookPosition=i;CSS.Hooks.registered[fullHookName]=[rootProperty,hookPosition]}}},getRoot:function(property){var hookData=CSS.Hooks.registered[property];return hookData?hookData[0]:property},cleanRootPropertyValue:function(rootProperty,rootPropertyValue){return CSS.RegEx.valueUnwrap.test(rootPropertyValue)&&(rootPropertyValue=rootPropertyValue.match(CSS.RegEx.valueUnwrap)[1]),CSS.Values.isCSSNullValue(rootPropertyValue)&&(rootPropertyValue=CSS.Hooks.templates[rootProperty][1]),rootPropertyValue},extractValue:function(fullHookName,rootPropertyValue){var hookData=CSS.Hooks.registered[fullHookName];if(hookData){var hookRoot=hookData[0],hookPosition=hookData[1];return rootPropertyValue=CSS.Hooks.cleanRootPropertyValue(hookRoot,rootPropertyValue),rootPropertyValue.toString().match(CSS.RegEx.valueSplit)[hookPosition]}return rootPropertyValue},injectValue:function(fullHookName,hookValue,rootPropertyValue){var hookData=CSS.Hooks.registered[fullHookName];if(hookData){var rootPropertyValueParts,hookRoot=hookData[0],hookPosition=hookData[1];return rootPropertyValue=CSS.Hooks.cleanRootPropertyValue(hookRoot,rootPropertyValue),rootPropertyValueParts=rootPropertyValue.toString().match(CSS.RegEx.valueSplit),rootPropertyValueParts[hookPosition]=hookValue,rootPropertyValueParts.join(" ")}return rootPropertyValue}},Normalizations:{registered:{clip:function(type,element,propertyValue){switch(type){case"name":return"clip";case"extract":var extracted;return CSS.RegEx.wrappedValueAlreadyExtracted.test(propertyValue)?extracted=propertyValue:(extracted=propertyValue.toString().match(CSS.RegEx.valueUnwrap),extracted=extracted?extracted[1].replace(/,(\s+)?/g," "):propertyValue),extracted;case"inject":return"rect("+propertyValue+")"}},blur:function(type,element,propertyValue){switch(type){case"name":return Velocity.State.isFirefox?"filter":"-webkit-filter";case"extract":var extracted=parseFloat(propertyValue);if(!extracted&&0!==extracted){var blurComponent=propertyValue.toString().match(/blur\(([0-9]+[A-z]+)\)/i);extracted=blurComponent?blurComponent[1]:0}return extracted;case"inject":return parseFloat(propertyValue)?"blur("+propertyValue+")":"none"}},opacity:function(type,element,propertyValue){if(IE<=8)switch(type){case"name":return"filter";case"extract":var extracted=propertyValue.toString().match(/alpha\(opacity=(.*)\)/i);return propertyValue=extracted?extracted[1]/100:1;case"inject":return element.style.zoom=1,parseFloat(propertyValue)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(propertyValue),10)+")"}else switch(type){case"name":return"opacity";case"extract":case"inject":return propertyValue}}},register:function(){IE<=9||Velocity.State.isGingerbread||(CSS.Lists.transformsBase=CSS.Lists.transformsBase.concat(CSS.Lists.transforms3D));for(var i=0;i<CSS.Lists.transformsBase.length;i++)!function(){var transformName=CSS.Lists.transformsBase[i];CSS.Normalizations.registered[transformName]=function(type,element,propertyValue){switch(type){case"name":return"transform";case"extract":return Data(element)===undefined||Data(element).transformCache[transformName]===undefined?/^scale/i.test(transformName)?1:0:Data(element).transformCache[transformName].replace(/[()]/g,"");case"inject":var invalid=!1;switch(transformName.substr(0,transformName.length-1)){case"translate":invalid=!/(%|px|em|rem|vw|vh|\d)$/i.test(propertyValue);break;case"scal":case"scale":Velocity.State.isAndroid&&Data(element).transformCache[transformName]===undefined&&propertyValue<1&&(propertyValue=1),invalid=!/(\d)$/i.test(propertyValue);break;case"skew":case"rotate":invalid=!/(deg|\d)$/i.test(propertyValue)}return invalid||(Data(element).transformCache[transformName]="("+propertyValue+")"),Data(element).transformCache[transformName]}}}();for(var i=0;i<CSS.Lists.colors.length;i++)!function(){var colorName=CSS.Lists.colors[i];CSS.Normalizations.registered[colorName]=function(type,element,propertyValue){switch(type){case"name":return colorName;case"extract":var extracted;if(CSS.RegEx.wrappedValueAlreadyExtracted.test(propertyValue))extracted=propertyValue;else{var converted,colorNames={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(propertyValue)?converted=colorNames[propertyValue]!==undefined?colorNames[propertyValue]:colorNames.black:CSS.RegEx.isHex.test(propertyValue)?converted="rgb("+CSS.Values.hexToRgb(propertyValue).join(" ")+")":/^rgba?\(/i.test(propertyValue)||(converted=colorNames.black),extracted=(converted||propertyValue).toString().match(CSS.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return IE<=8||3!==extracted.split(" ").length||(extracted+=" 1"),extracted;case"inject":return IE<=8?4===propertyValue.split(" ").length&&(propertyValue=propertyValue.split(/\s+/).slice(0,3).join(" ")):3===propertyValue.split(" ").length&&(propertyValue+=" 1"),(IE<=8?"rgb":"rgba")+"("+propertyValue.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(property){return property.replace(/-(\w)/g,function(match,subMatch){return subMatch.toUpperCase()})},SVGAttribute:function(property){var SVGAttributes="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(IE||Velocity.State.isAndroid&&!Velocity.State.isChrome)&&(SVGAttributes+="|transform"),new RegExp("^("+SVGAttributes+")$","i").test(property)},prefixCheck:function(property){if(Velocity.State.prefixMatches[property])return[Velocity.State.prefixMatches[property],!0];for(var vendors=["","Webkit","Moz","ms","O"],i=0,vendorsLength=vendors.length;i<vendorsLength;i++){var propertyPrefixed;if(propertyPrefixed=0===i?property:vendors[i]+property.replace(/^\w/,function(match){return match.toUpperCase()}),Type.isString(Velocity.State.prefixElement.style[propertyPrefixed]))return Velocity.State.prefixMatches[property]=propertyPrefixed,[propertyPrefixed,!0]}return[property,!1]}},Values:{hexToRgb:function(hex){var rgbParts,shortformRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,longformRegex=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return hex=hex.replace(shortformRegex,function(m,r,g,b){return r+r+g+g+b+b}),rgbParts=longformRegex.exec(hex),rgbParts?[parseInt(rgbParts[1],16),parseInt(rgbParts[2],16),parseInt(rgbParts[3],16)]:[0,0,0]},isCSSNullValue:function(value){return 0==value||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(value)},getUnitType:function(property){return/^(rotate|skew)/i.test(property)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(property)?"":"px"},getDisplayType:function(element){var tagName=element&&element.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(tagName)?"inline":/^(li)$/i.test(tagName)?"list-item":/^(tr)$/i.test(tagName)?"table-row":/^(table)$/i.test(tagName)?"table":/^(tbody)$/i.test(tagName)?"table-row-group":"block"},addClass:function(element,className){element.classList?element.classList.add(className):element.className+=(element.className.length?" ":"")+className},removeClass:function(element,className){element.classList?element.classList.remove(className):element.className=element.className.toString().replace(new RegExp("(^|\\s)"+className.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(element,property,rootPropertyValue,forceStyleLookup){function computePropertyValue(element,property){function revertDisplay(){toggleDisplay&&CSS.setPropertyValue(element,"display","none")}var computedValue=0;if(IE<=8)computedValue=$.css(element,property);else{var toggleDisplay=!1;if(/^(width|height)$/.test(property)&&0===CSS.getPropertyValue(element,"display")&&(toggleDisplay=!0,CSS.setPropertyValue(element,"display",CSS.Values.getDisplayType(element))),!forceStyleLookup){if("height"===property&&"border-box"!==CSS.getPropertyValue(element,"boxSizing").toString().toLowerCase()){var contentBoxHeight=element.offsetHeight-(parseFloat(CSS.getPropertyValue(element,"borderTopWidth"))||0)-(parseFloat(CSS.getPropertyValue(element,"borderBottomWidth"))||0)-(parseFloat(CSS.getPropertyValue(element,"paddingTop"))||0)-(parseFloat(CSS.getPropertyValue(element,"paddingBottom"))||0);return revertDisplay(),contentBoxHeight}if("width"===property&&"border-box"!==CSS.getPropertyValue(element,"boxSizing").toString().toLowerCase()){var contentBoxWidth=element.offsetWidth-(parseFloat(CSS.getPropertyValue(element,"borderLeftWidth"))||0)-(parseFloat(CSS.getPropertyValue(element,"borderRightWidth"))||0)-(parseFloat(CSS.getPropertyValue(element,"paddingLeft"))||0)-(parseFloat(CSS.getPropertyValue(element,"paddingRight"))||0);return revertDisplay(),contentBoxWidth}}var computedStyle;computedStyle=Data(element)===undefined?window.getComputedStyle(element,null):Data(element).computedStyle?Data(element).computedStyle:Data(element).computedStyle=window.getComputedStyle(element,null),"borderColor"===property&&(property="borderTopColor"),computedValue=9===IE&&"filter"===property?computedStyle.getPropertyValue(property):computedStyle[property],""!==computedValue&&null!==computedValue||(computedValue=element.style[property]),revertDisplay()}if("auto"===computedValue&&/^(top|right|bottom|left)$/i.test(property)){var position=computePropertyValue(element,"position");("fixed"===position||"absolute"===position&&/top|left/i.test(property))&&(computedValue=$(element).position()[property]+"px")}return computedValue}var propertyValue;if(CSS.Hooks.registered[property]){var hook=property,hookRoot=CSS.Hooks.getRoot(hook);rootPropertyValue===undefined&&(rootPropertyValue=CSS.getPropertyValue(element,CSS.Names.prefixCheck(hookRoot)[0])),CSS.Normalizations.registered[hookRoot]&&(rootPropertyValue=CSS.Normalizations.registered[hookRoot]("extract",element,rootPropertyValue)),propertyValue=CSS.Hooks.extractValue(hook,rootPropertyValue)}else if(CSS.Normalizations.registered[property]){var normalizedPropertyName,normalizedPropertyValue;normalizedPropertyName=CSS.Normalizations.registered[property]("name",element),"transform"!==normalizedPropertyName&&(normalizedPropertyValue=computePropertyValue(element,CSS.Names.prefixCheck(normalizedPropertyName)[0]),CSS.Values.isCSSNullValue(normalizedPropertyValue)&&CSS.Hooks.templates[property]&&(normalizedPropertyValue=CSS.Hooks.templates[property][1])),propertyValue=CSS.Normalizations.registered[property]("extract",element,normalizedPropertyValue)}if(!/^[\d-]/.test(propertyValue))if(Data(element)&&Data(element).isSVG&&CSS.Names.SVGAttribute(property))if(/^(height|width)$/i.test(property))try{propertyValue=element.getBBox()[property]}catch(error){propertyValue=0}else propertyValue=element.getAttribute(property);else propertyValue=computePropertyValue(element,CSS.Names.prefixCheck(property)[0]);return CSS.Values.isCSSNullValue(propertyValue)&&(propertyValue=0),Velocity.debug>=2&&console.log("Get "+property+": "+propertyValue),propertyValue},setPropertyValue:function(element,property,propertyValue,rootPropertyValue,scrollData){var propertyName=property;if("scroll"===property)scrollData.container?scrollData.container["scroll"+scrollData.direction]=propertyValue:"Left"===scrollData.direction?window.scrollTo(propertyValue,scrollData.alternateValue):window.scrollTo(scrollData.alternateValue,propertyValue);else if(CSS.Normalizations.registered[property]&&"transform"===CSS.Normalizations.registered[property]("name",element))CSS.Normalizations.registered[property]("inject",element,propertyValue),propertyName="transform",propertyValue=Data(element).transformCache[property];else{if(CSS.Hooks.registered[property]){var hookName=property,hookRoot=CSS.Hooks.getRoot(property);rootPropertyValue=rootPropertyValue||CSS.getPropertyValue(element,hookRoot),propertyValue=CSS.Hooks.injectValue(hookName,propertyValue,rootPropertyValue),property=hookRoot}if(CSS.Normalizations.registered[property]&&(propertyValue=CSS.Normalizations.registered[property]("inject",element,propertyValue),property=CSS.Normalizations.registered[property]("name",element)),propertyName=CSS.Names.prefixCheck(property)[0],IE<=8)try{element.style[propertyName]=propertyValue}catch(error){Velocity.debug&&console.log("Browser does not support ["+propertyValue+"] for ["+propertyName+"]")}else Data(element)&&Data(element).isSVG&&CSS.Names.SVGAttribute(property)?element.setAttribute(property,propertyValue):element.style[propertyName]=propertyValue;Velocity.debug>=2&&console.log("Set "+property+" ("+propertyName+"): "+propertyValue)}return[propertyName,propertyValue]},flushTransformCache:function(element){function getTransformFloat(transformProperty){return parseFloat(CSS.getPropertyValue(element,transformProperty))}var transformString="";if((IE||Velocity.State.isAndroid&&!Velocity.State.isChrome)&&Data(element).isSVG){var SVGTransforms={translate:[getTransformFloat("translateX"),getTransformFloat("translateY")],skewX:[getTransformFloat("skewX")],skewY:[getTransformFloat("skewY")],scale:1!==getTransformFloat("scale")?[getTransformFloat("scale"),getTransformFloat("scale")]:[getTransformFloat("scaleX"),getTransformFloat("scaleY")],rotate:[getTransformFloat("rotateZ"),0,0]};$.each(Data(element).transformCache,function(transformName){/^translate/i.test(transformName)?transformName="translate":/^scale/i.test(transformName)?transformName="scale":/^rotate/i.test(transformName)&&(transformName="rotate"),SVGTransforms[transformName]&&(transformString+=transformName+"("+SVGTransforms[transformName].join(" ")+") ",delete SVGTransforms[transformName])})}else{var transformValue,perspective;$.each(Data(element).transformCache,function(transformName){if(transformValue=Data(element).transformCache[transformName],"transformPerspective"===transformName)return perspective=transformValue,!0;9===IE&&"rotateZ"===transformName&&(transformName="rotate"),transformString+=transformName+transformValue+" "}),perspective&&(transformString="perspective"+perspective+" "+transformString)}CSS.setPropertyValue(element,"transform",transformString)}};CSS.Hooks.register(),CSS.Normalizations.register(),Velocity.hook=function(elements,arg2,arg3){var value=undefined;return elements=sanitizeElements(elements),$.each(elements,function(i,element){if(Data(element)===undefined&&Velocity.init(element),arg3===undefined)value===undefined&&(value=Velocity.CSS.getPropertyValue(element,arg2));else{var adjustedSet=Velocity.CSS.setPropertyValue(element,arg2,arg3);"transform"===adjustedSet[0]&&Velocity.CSS.flushTransformCache(element),value=adjustedSet}}),value};var animate=function(){function getChain(){return isUtility?promiseData.promise||null:elementsWrapped}function processElement(){function buildQueue(next){function parsePropertyValue(valueData,skipResolvingEasing){var endValue=undefined,easing=undefined,startValue=undefined;return Type.isArray(valueData)?(endValue=valueData[0],!Type.isArray(valueData[1])&&/^[\d-]/.test(valueData[1])||Type.isFunction(valueData[1])||CSS.RegEx.isHex.test(valueData[1])?startValue=valueData[1]:(Type.isString(valueData[1])&&!CSS.RegEx.isHex.test(valueData[1])||Type.isArray(valueData[1]))&&(easing=skipResolvingEasing?valueData[1]:getEasing(valueData[1],opts.duration),valueData[2]!==undefined&&(startValue=valueData[2]))):endValue=valueData,skipResolvingEasing||(easing=easing||opts.easing),Type.isFunction(endValue)&&(endValue=endValue.call(element,elementsIndex,elementsLength)),Type.isFunction(startValue)&&(startValue=startValue.call(element,elementsIndex,elementsLength)),[endValue||0,easing,startValue]}function separateValue(property,value){var unitType,numericValue;return numericValue=(value||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(match){return unitType=match,""}),unitType||(unitType=CSS.Values.getUnitType(property)),[numericValue,unitType]}if(opts.begin&&0===elementsIndex)try{opts.begin.call(elements,elements)}catch(error){setTimeout(function(){throw error},1)}if("scroll"===action){var scrollPositionCurrent,scrollPositionCurrentAlternate,scrollPositionEnd,scrollDirection=/^x$/i.test(opts.axis)?"Left":"Top",scrollOffset=parseFloat(opts.offset)||0;opts.container?Type.isWrapped(opts.container)||Type.isNode(opts.container)?(opts.container=opts.container[0]||opts.container,scrollPositionCurrent=opts.container["scroll"+scrollDirection],scrollPositionEnd=scrollPositionCurrent+$(element).position()[scrollDirection.toLowerCase()]+scrollOffset):opts.container=null:(scrollPositionCurrent=Velocity.State.scrollAnchor[Velocity.State["scrollProperty"+scrollDirection]],scrollPositionCurrentAlternate=Velocity.State.scrollAnchor[Velocity.State["scrollProperty"+("Left"===scrollDirection?"Top":"Left")]],scrollPositionEnd=$(element).offset()[scrollDirection.toLowerCase()]+scrollOffset),tweensContainer={scroll:{rootPropertyValue:!1,startValue:scrollPositionCurrent,currentValue:scrollPositionCurrent,endValue:scrollPositionEnd,unitType:"",easing:opts.easing,scrollData:{container:opts.container,direction:scrollDirection,alternateValue:scrollPositionCurrentAlternate}},element:element},Velocity.debug&&console.log("tweensContainer (scroll): ",tweensContainer.scroll,element)}else if("reverse"===action){if(!Data(element).tweensContainer)return void $.dequeue(element,opts.queue);"none"===Data(element).opts.display&&(Data(element).opts.display="auto"),"hidden"===Data(element).opts.visibility&&(Data(element).opts.visibility="visible"),Data(element).opts.loop=!1,Data(element).opts.begin=null,Data(element).opts.complete=null,options.easing||delete opts.easing,options.duration||delete opts.duration,opts=$.extend({},Data(element).opts,opts);var lastTweensContainer=$.extend(!0,{},Data(element).tweensContainer);for(var lastTween in lastTweensContainer)if("element"!==lastTween){var lastStartValue=lastTweensContainer[lastTween].startValue;lastTweensContainer[lastTween].startValue=lastTweensContainer[lastTween].currentValue=lastTweensContainer[lastTween].endValue,lastTweensContainer[lastTween].endValue=lastStartValue,Type.isEmptyObject(options)||(lastTweensContainer[lastTween].easing=opts.easing),Velocity.debug&&console.log("reverse tweensContainer ("+lastTween+"): "+JSON.stringify(lastTweensContainer[lastTween]),element)}tweensContainer=lastTweensContainer}else if("start"===action){var lastTweensContainer;Data(element).tweensContainer&&!0===Data(element).isAnimating&&(lastTweensContainer=Data(element).tweensContainer),$.each(propertiesMap,function(property,value){if(RegExp("^"+CSS.Lists.colors.join("$|^")+"$").test(property)){var valueData=parsePropertyValue(value,!0),endValue=valueData[0],easing=valueData[1],startValue=valueData[2];if(CSS.RegEx.isHex.test(endValue)){for(var colorComponents=["Red","Green","Blue"],endValueRGB=CSS.Values.hexToRgb(endValue),startValueRGB=startValue?CSS.Values.hexToRgb(startValue):undefined,i=0;i<colorComponents.length;i++){var dataArray=[endValueRGB[i]];easing&&dataArray.push(easing),startValueRGB!==undefined&&dataArray.push(startValueRGB[i]),propertiesMap[property+colorComponents[i]]=dataArray}delete propertiesMap[property]}}});for(var property in propertiesMap){var valueData=parsePropertyValue(propertiesMap[property]),endValue=valueData[0],easing=valueData[1],startValue=valueData[2];property=CSS.Names.camelCase(property);var rootProperty=CSS.Hooks.getRoot(property),rootPropertyValue=!1;if(Data(element).isSVG||"tween"===rootProperty||!1!==CSS.Names.prefixCheck(rootProperty)[1]||CSS.Normalizations.registered[rootProperty]!==undefined){(opts.display!==undefined&&null!==opts.display&&"none"!==opts.display||opts.visibility!==undefined&&"hidden"!==opts.visibility)&&/opacity|filter/.test(property)&&!startValue&&0!==endValue&&(startValue=0),opts._cacheValues&&lastTweensContainer&&lastTweensContainer[property]?(startValue===undefined&&(startValue=lastTweensContainer[property].endValue+lastTweensContainer[property].unitType),rootPropertyValue=Data(element).rootPropertyValueCache[rootProperty]):CSS.Hooks.registered[property]?startValue===undefined?(rootPropertyValue=CSS.getPropertyValue(element,rootProperty),startValue=CSS.getPropertyValue(element,property,rootPropertyValue)):rootPropertyValue=CSS.Hooks.templates[rootProperty][1]:startValue===undefined&&(startValue=CSS.getPropertyValue(element,property));var separatedValue,endValueUnitType,startValueUnitType,operator=!1;if(separatedValue=separateValue(property,startValue),startValue=separatedValue[0],startValueUnitType=separatedValue[1],separatedValue=separateValue(property,endValue),endValue=separatedValue[0].replace(/^([+-\/*])=/,function(match,subMatch){return operator=subMatch,""}),endValueUnitType=separatedValue[1],startValue=parseFloat(startValue)||0,endValue=parseFloat(endValue)||0,"%"===endValueUnitType&&(/^(fontSize|lineHeight)$/.test(property)?(endValue/=100,endValueUnitType="em"):/^scale/.test(property)?(endValue/=100,endValueUnitType=""):/(Red|Green|Blue)$/i.test(property)&&(endValue=endValue/100*255,endValueUnitType="")),/[\/*]/.test(operator))endValueUnitType=startValueUnitType;else if(startValueUnitType!==endValueUnitType&&0!==startValue)if(0===endValue)endValueUnitType=startValueUnitType;else{elementUnitConversionData=elementUnitConversionData||function(){var sameRatioIndicators={myParent:element.parentNode||document.body,position:CSS.getPropertyValue(element,"position"),fontSize:CSS.getPropertyValue(element,"fontSize")},samePercentRatio=sameRatioIndicators.position===callUnitConversionData.lastPosition&&sameRatioIndicators.myParent===callUnitConversionData.lastParent,sameEmRatio=sameRatioIndicators.fontSize===callUnitConversionData.lastFontSize;callUnitConversionData.lastParent=sameRatioIndicators.myParent,callUnitConversionData.lastPosition=sameRatioIndicators.position,callUnitConversionData.lastFontSize=sameRatioIndicators.fontSize;var unitRatios={};if(sameEmRatio&&samePercentRatio)unitRatios.emToPx=callUnitConversionData.lastEmToPx,unitRatios.percentToPxWidth=callUnitConversionData.lastPercentToPxWidth,unitRatios.percentToPxHeight=callUnitConversionData.lastPercentToPxHeight;else{var dummy=Data(element).isSVG?document.createElementNS("http://www.w3.org/2000/svg","rect"):document.createElement("div");Velocity.init(dummy),sameRatioIndicators.myParent.appendChild(dummy),$.each(["overflow","overflowX","overflowY"],function(i,property){Velocity.CSS.setPropertyValue(dummy,property,"hidden")}),Velocity.CSS.setPropertyValue(dummy,"position",sameRatioIndicators.position),Velocity.CSS.setPropertyValue(dummy,"fontSize",sameRatioIndicators.fontSize),Velocity.CSS.setPropertyValue(dummy,"boxSizing","content-box"),$.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(i,property){Velocity.CSS.setPropertyValue(dummy,property,"100%")}),Velocity.CSS.setPropertyValue(dummy,"paddingLeft","100em"),unitRatios.percentToPxWidth=callUnitConversionData.lastPercentToPxWidth=(parseFloat(CSS.getPropertyValue(dummy,"width",null,!0))||1)/100,unitRatios.percentToPxHeight=callUnitConversionData.lastPercentToPxHeight=(parseFloat(CSS.getPropertyValue(dummy,"height",null,!0))||1)/100,unitRatios.emToPx=callUnitConversionData.lastEmToPx=(parseFloat(CSS.getPropertyValue(dummy,"paddingLeft"))||1)/100,sameRatioIndicators.myParent.removeChild(dummy)}return null===callUnitConversionData.remToPx&&(callUnitConversionData.remToPx=parseFloat(CSS.getPropertyValue(document.body,"fontSize"))||16),null===callUnitConversionData.vwToPx&&(callUnitConversionData.vwToPx=parseFloat(window.innerWidth)/100,callUnitConversionData.vhToPx=parseFloat(window.innerHeight)/100),unitRatios.remToPx=callUnitConversionData.remToPx,unitRatios.vwToPx=callUnitConversionData.vwToPx,unitRatios.vhToPx=callUnitConversionData.vhToPx,Velocity.debug>=1&&console.log("Unit ratios: "+JSON.stringify(unitRatios),element),unitRatios}();var axis=/margin|padding|left|right|width|text|word|letter/i.test(property)||/X$/.test(property)||"x"===property?"x":"y";switch(startValueUnitType){case"%":startValue*="x"===axis?elementUnitConversionData.percentToPxWidth:elementUnitConversionData.percentToPxHeight;break;case"px":break;default:startValue*=elementUnitConversionData[startValueUnitType+"ToPx"]}switch(endValueUnitType){case"%":startValue*=1/("x"===axis?elementUnitConversionData.percentToPxWidth:elementUnitConversionData.percentToPxHeight);break;case"px":break;default:startValue*=1/elementUnitConversionData[endValueUnitType+"ToPx"]}}switch(operator){case"+":endValue=startValue+endValue;break;case"-":endValue=startValue-endValue;break;case"*":endValue*=startValue;break;case"/":endValue=startValue/endValue}tweensContainer[property]={rootPropertyValue:rootPropertyValue,startValue:startValue,currentValue:startValue,endValue:endValue,unitType:endValueUnitType,easing:easing},Velocity.debug&&console.log("tweensContainer ("+property+"): "+JSON.stringify(tweensContainer[property]),element)}else Velocity.debug&&console.log("Skipping ["+rootProperty+"] due to a lack of browser support.")}tweensContainer.element=element}tweensContainer.element&&(CSS.Values.addClass(element,"velocity-animating"),call.push(tweensContainer),""===opts.queue&&(Data(element).tweensContainer=tweensContainer,Data(element).opts=opts),Data(element).isAnimating=!0,elementsIndex===elementsLength-1?(Velocity.State.calls.push([call,elements,opts,null,promiseData.resolver]),!1===Velocity.State.isTicking&&(Velocity.State.isTicking=!0,tick())):elementsIndex++)}var elementUnitConversionData,element=this,opts=$.extend({},Velocity.defaults,options),tweensContainer={};switch(Data(element)===undefined&&Velocity.init(element),parseFloat(opts.delay)&&!1!==opts.queue&&$.queue(element,opts.queue,function(next){Velocity.velocityQueueEntryFlag=!0,Data(element).delayTimer={setTimeout:setTimeout(next,parseFloat(opts.delay)),next:next}}),opts.duration.toString().toLowerCase()){case"fast":opts.duration=200;break;case"normal":opts.duration=DURATION_DEFAULT;break;case"slow":opts.duration=600;break;default:opts.duration=parseFloat(opts.duration)||1}!1!==Velocity.mock&&(!0===Velocity.mock?opts.duration=opts.delay=1:(opts.duration*=parseFloat(Velocity.mock)||1,opts.delay*=parseFloat(Velocity.mock)||1)),opts.easing=getEasing(opts.easing,opts.duration),opts.begin&&!Type.isFunction(opts.begin)&&(opts.begin=null),opts.progress&&!Type.isFunction(opts.progress)&&(opts.progress=null),opts.complete&&!Type.isFunction(opts.complete)&&(opts.complete=null),opts.display!==undefined&&null!==opts.display&&(opts.display=opts.display.toString().toLowerCase(),"auto"===opts.display&&(opts.display=Velocity.CSS.Values.getDisplayType(element))),opts.visibility!==undefined&&null!==opts.visibility&&(opts.visibility=opts.visibility.toString().toLowerCase()),opts.mobileHA=opts.mobileHA&&Velocity.State.isMobile&&!Velocity.State.isGingerbread,!1===opts.queue?opts.delay?setTimeout(buildQueue,opts.delay):buildQueue():$.queue(element,opts.queue,function(next,clearQueue){if(!0===clearQueue)return promiseData.promise&&promiseData.resolver(elements),!0;Velocity.velocityQueueEntryFlag=!0,buildQueue(next)}),""!==opts.queue&&"fx"!==opts.queue||"inprogress"===$.queue(element)[0]||$.dequeue(element)}var isUtility,elementsWrapped,argumentIndex,elements,propertiesMap,options,syntacticSugar=arguments[0]&&(arguments[0].p||$.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||Type.isString(arguments[0].properties));if(Type.isWrapped(this)?(isUtility=!1,argumentIndex=0,elements=this,elementsWrapped=this):(isUtility=!0,argumentIndex=1,elements=syntacticSugar?arguments[0].elements||arguments[0].e:arguments[0]),elements=sanitizeElements(elements)){syntacticSugar?(propertiesMap=arguments[0].properties||arguments[0].p,options=arguments[0].options||arguments[0].o):(propertiesMap=arguments[argumentIndex],options=arguments[argumentIndex+1]);var elementsLength=elements.length,elementsIndex=0;if(!/^(stop|finish|finishAll)$/i.test(propertiesMap)&&!$.isPlainObject(options)){var startingArgumentPosition=argumentIndex+1;options={};for(var i=startingArgumentPosition;i<arguments.length;i++)Type.isArray(arguments[i])||!/^(fast|normal|slow)$/i.test(arguments[i])&&!/^\d/.test(arguments[i])?Type.isString(arguments[i])||Type.isArray(arguments[i])?options.easing=arguments[i]:Type.isFunction(arguments[i])&&(options.complete=arguments[i]):options.duration=arguments[i]}var promiseData={promise:null,resolver:null,rejecter:null};isUtility&&Velocity.Promise&&(promiseData.promise=new Velocity.Promise(function(resolve,reject){promiseData.resolver=resolve,promiseData.rejecter=reject}));var action;switch(propertiesMap){case"scroll":action="scroll";break;case"reverse":action="reverse";break;case"finish":case"finishAll":case"stop":$.each(elements,function(i,element){Data(element)&&Data(element).delayTimer&&(clearTimeout(Data(element).delayTimer.setTimeout),Data(element).delayTimer.next&&Data(element).delayTimer.next(),delete Data(element).delayTimer),"finishAll"!==propertiesMap||!0!==options&&!Type.isString(options)||($.each($.queue(element,Type.isString(options)?options:""),function(_,item){Type.isFunction(item)&&item()}),$.queue(element,Type.isString(options)?options:"",[]))});var callsToStop=[];return $.each(Velocity.State.calls,function(i,activeCall){activeCall&&$.each(activeCall[1],function(k,activeElement){var queueName=options===undefined?"":options;if(!0!==queueName&&activeCall[2].queue!==queueName&&(options!==undefined||!1!==activeCall[2].queue))return!0;$.each(elements,function(l,element){element===activeElement&&((!0===options||Type.isString(options))&&($.each($.queue(element,Type.isString(options)?options:""),function(_,item){Type.isFunction(item)&&item(null,!0)}),$.queue(element,Type.isString(options)?options:"",[])),"stop"===propertiesMap?(Data(element)&&Data(element).tweensContainer&&!1!==queueName&&$.each(Data(element).tweensContainer,function(m,activeTween){activeTween.endValue=activeTween.currentValue}),callsToStop.push(i)):"finish"!==propertiesMap&&"finishAll"!==propertiesMap||(activeCall[2].duration=1))})})}),"stop"===propertiesMap&&($.each(callsToStop,function(i,j){completeCall(j,!0)}),promiseData.promise&&promiseData.resolver(elements)),getChain();default:if(!$.isPlainObject(propertiesMap)||Type.isEmptyObject(propertiesMap)){if(Type.isString(propertiesMap)&&Velocity.Redirects[propertiesMap]){var opts=$.extend({},options),durationOriginal=opts.duration,delayOriginal=opts.delay||0;return!0===opts.backwards&&(elements=$.extend(!0,[],elements).reverse()),$.each(elements,function(elementIndex,element){parseFloat(opts.stagger)?opts.delay=delayOriginal+parseFloat(opts.stagger)*elementIndex:Type.isFunction(opts.stagger)&&(opts.delay=delayOriginal+opts.stagger.call(element,elementIndex,elementsLength)),opts.drag&&(opts.duration=parseFloat(durationOriginal)||(/^(callout|transition)/.test(propertiesMap)?1e3:DURATION_DEFAULT),opts.duration=Math.max(opts.duration*(opts.backwards?1-elementIndex/elementsLength:(elementIndex+1)/elementsLength),.75*opts.duration,200)),Velocity.Redirects[propertiesMap].call(element,element,opts||{},elementIndex,elementsLength,elements,promiseData.promise?promiseData:undefined)}),getChain()}var abortError="Velocity: First argument ("+propertiesMap+") was not a property map, a known action, or a registered redirect. Aborting.";return promiseData.promise?promiseData.rejecter(new Error(abortError)):console.log(abortError),getChain()}action="start"}var callUnitConversionData={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},call=[];$.each(elements,function(i,element){Type.isNode(element)&&processElement.call(element)});var reverseCallsCount,opts=$.extend({},Velocity.defaults,options);if(opts.loop=parseInt(opts.loop),reverseCallsCount=2*opts.loop-1,opts.loop)for(var x=0;x<reverseCallsCount;x++){var reverseOptions={delay:opts.delay,progress:opts.progress};x===reverseCallsCount-1&&(reverseOptions.display=opts.display,reverseOptions.visibility=opts.visibility,reverseOptions.complete=opts.complete),animate(elements,"reverse",reverseOptions)}return getChain()}};Velocity=$.extend(animate,Velocity),Velocity.animate=animate;var ticker=window.requestAnimationFrame||rAFShim;return Velocity.State.isMobile||document.hidden===undefined||document.addEventListener("visibilitychange",function(){document.hidden?(ticker=function(callback){return setTimeout(function(){callback(!0)},16)},tick()):ticker=window.requestAnimationFrame||rAFShim}),global.Velocity=Velocity,global!==window&&(global.fn.velocity=animate,global.fn.velocity.defaults=Velocity.defaults),$.each(["Down","Up"],function(i,direction){Velocity.Redirects["slide"+direction]=function(element,options,elementsIndex,elementsSize,elements,promiseData){var opts=$.extend({},options),begin=opts.begin,complete=opts.complete,computedValues={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},inlineValues={};opts.display===undefined&&(opts.display="Down"===direction?"inline"===Velocity.CSS.Values.getDisplayType(element)?"inline-block":"block":"none"),opts.begin=function(){begin&&begin.call(elements,elements);for(var property in computedValues){inlineValues[property]=element.style[property];var propertyValue=Velocity.CSS.getPropertyValue(element,property);computedValues[property]="Down"===direction?[propertyValue,0]:[0,propertyValue]}inlineValues.overflow=element.style.overflow,element.style.overflow="hidden"},opts.complete=function(){for(var property in inlineValues)element.style[property]=inlineValues[property];complete&&complete.call(elements,elements),promiseData&&promiseData.resolver(elements)},Velocity(element,computedValues,opts)}}),$.each(["In","Out"],function(i,direction){Velocity.Redirects["fade"+direction]=function(element,options,elementsIndex,elementsSize,elements,promiseData){var opts=$.extend({},options),propertiesMap={opacity:"In"===direction?1:0},originalComplete=opts.complete;opts.complete=elementsIndex!==elementsSize-1?opts.begin=null:function(){originalComplete&&originalComplete.call(elements,elements),promiseData&&promiseData.resolver(elements)},opts.display===undefined&&(opts.display="In"===direction?"auto":"none"),Velocity(this,propertiesMap,opts)}}),Velocity}(window.jQuery||window.Zepto||window,window,document)})},468:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _wpJsHooks=__webpack_require__(13),_wpJsHooks2=_interopRequireDefault(_wpJsHooks),_breadcrumb=__webpack_require__(21),_breadcrumb2=_interopRequireDefault(_breadcrumb),_mailpoet=__webpack_require__(2),_mailpoet2=_interopRequireDefault(_mailpoet),_react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(11),_reactDom2=_interopRequireDefault(_reactDom),_background_image_announcement=__webpack_require__(469),_background_image_announcement2=_interopRequireDefault(_background_image_announcement),_tutorial=__webpack_require__(470),_tutorial2=_interopRequireDefault(_tutorial),renderBreadcrumb=function(newsletterType){var breadcrumbContainer=document.getElementById("mailpoet_editor_breadcrumb"),breadcrumb=_wpJsHooks2.default.applyFilters("mailpoet_newsletters_editor_breadcrumb",_react2.default.createElement(_breadcrumb2.default,{step:"editor"}),newsletterType,"editor");_reactDom2.default.render(breadcrumb,breadcrumbContainer)},renderAnnouncement=function(){var container=document.getElementById("mailpoet_editor_announcement");_reactDom2.default.render(_react2.default.createElement(_background_image_announcement2.default,{username:window.config.currentUserFirstName||window.config.currentUserUsername,videoUrl:window.config.backgroundImageDemoUrl}),container)},initializeEditor=function(config){var editorContainer=document.getElementById("mailpoet_editor");editorContainer&&window.EditorApplication&&(_mailpoet2.default.Modal.loading(!0),_mailpoet2.default.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"get",data:{id:function(param){return(location.search.split(param+"=")[1]||"").split("&")[0]}("id")}}).always(function(){return _mailpoet2.default.Modal.loading(!1)}).always(function(){return(0,_tutorial2.default)()}).done(function(response){var newsletter=response.data;Promise.resolve(_wpJsHooks2.default.applyFilters("mailpoet_newsletters_editor_extend_config",config,newsletter)).then(function(extendedConfig){window.EditorApplication.start({newsletter:newsletter,config:extendedConfig})}).catch(function(){window.EditorApplication.start({newsletter:newsletter,config:config})}),renderBreadcrumb(newsletter.type),renderAnnouncement(),"sending"===newsletter.status&&newsletter.queue&&null===newsletter.queue.status&&_mailpoet2.default.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"sending_queue",action:"pause",data:{newsletter_id:newsletter.id}}).done(function(){return _mailpoet2.default.Notice.success(_mailpoet2.default.I18n.t("newsletterIsPaused"))}).fail(function(pauseFailResponse){pauseFailResponse.errors.length>0&&_mailpoet2.default.Notice.error(pauseFailResponse.errors.map(function(error){return error.message}),{scroll:!0,static:!0})})}).fail(function(response){response.errors.length>0&&_mailpoet2.default.Notice.error(response.errors.map(function(error){return error.message}),{scroll:!0,static:!0})}))};_wpJsHooks2.default.addAction("mailpoet_newsletters_editor_initialize",initializeEditor)},469:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _propTypes=__webpack_require__(3),_propTypes2=_interopRequireDefault(_propTypes),_react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_mailpoet=__webpack_require__(2),_mailpoet2=_interopRequireDefault(_mailpoet),_in_app_announcement=__webpack_require__(267),_in_app_announcement2=_interopRequireDefault(_in_app_announcement),BackgroundImageAnnouncement=function(props){return _react2.default.createElement(_in_app_announcement2.default,{validUntil:new Date("2018-10-06"),height:"700px",showOnlyOnceSlug:"background_image"},_react2.default.createElement("div",{className:"mailpoet_in_app_announcement_background_videos"},_react2.default.createElement("h2",null,_mailpoet2.default.I18n.t("announcementBackgroundImagesHeading").replace("%username%",props.username)),_react2.default.createElement("p",null,_mailpoet2.default.I18n.t("announcementBackgroundImagesMessage")),_react2.default.createElement("video",{src:props.videoUrl,controls:!0,autoPlay:!0},_react2.default.createElement("track",{kind:"captions"}))))};BackgroundImageAnnouncement.propTypes={username:_propTypes2.default.string.isRequired,videoUrl:_propTypes2.default.string.isRequired},module.exports=BackgroundImageAnnouncement},470:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(exports,"__esModule",{value:!0});var _mailpoet=__webpack_require__(2),_mailpoet2=_interopRequireDefault(_mailpoet),_moment=__webpack_require__(0),_moment2=_interopRequireDefault(_moment),displayTutorial=function(){var key="user_seen_editor_tutorial"+window.config.currentUserId;window.config.dragDemoUrlSettings||(0,_moment2.default)(window.config.installedAt).isBefore((0,_moment2.default)().subtract(7,"days"))||_mailpoet2.default.Modal.popup({template:'<div class="mailpoet_drag_and_drop_tutorial"><h2>'+_mailpoet2.default.I18n.t("tutorialVideoTitle")+'</h2><video style="height:640px;" src="'+window.config.dragDemoUrl+'" controls autoplay></video></div>',onCancel:function(){_mailpoet2.default.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"settings",action:"set",data:_defineProperty({},key,1)})}})};exports.default=displayTutorial},471:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(24),__webpack_require__(4)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,SuperModel,_){var Module={};return Module.ConfigModel=SuperModel.extend({defaults:{availableStyles:{},socialIcons:{},blockDefaults:{},sidepanelWidth:"331px",validation:{},urls:{}}}),Module._config={},Module.getConfig=function(){return Module._config},Module.setConfig=function(options){return Module._config=new Module.ConfigModel(options,{parse:!0}),Module._config},App.on("before:start",function(BeforeStartApp,options){var Application=BeforeStartApp,config=_.clone(options.config);Application.getConfig=Module.getConfig,Application.setConfig=Module.setConfig,config.blockDefaults=_.extend(config.blockDefaults,options.newsletter.body.blockDefaults||{}),Application.setConfig(config)}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},472:function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(10),__webpack_require__(24),__webpack_require__(4)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,Marionette,SuperModel,_){var Module={};return Module.StylesModel=SuperModel.extend({defaults:{text:{fontColor:"#000000",fontFamily:"Arial",fontSize:"16px"},h1:{fontColor:"#111111",fontFamily:"Arial",fontSize:"40px"},h2:{fontColor:"#222222",fontFamily:"Tahoma",fontSize:"32px"},h3:{fontColor:"#333333",fontFamily:"Verdana",fontSize:"24px"},link:{fontColor:"#21759B",textDecoration:"underline"},wrapper:{backgroundColor:"#ffffff"},body:{backgroundColor:"#cccccc"}},initialize:function(){this.on("change",function(){App.getChannel().trigger("autoSave")})}}),Module.StylesView=Marionette.View.extend({getTemplate:function(){return window.templates.styles},modelEvents:{change:"render"},serializeData:function(){return this.model.toJSON()}}),Module._globalStyles=new SuperModel,Module.getGlobalStyles=function(){return Module._globalStyles},Module.setGlobalStyles=function(options){return Module._globalStyles=new Module.StylesModel(options),Module._globalStyles},Module.getAvailableStyles=function(){return App.getConfig().get("availableStyles")},App.on("before:start",function(BeforeStartApp,options){var body,globalStyles,Application=BeforeStartApp;Application.getGlobalStyles=Module.getGlobalStyles,Application.setGlobalStyles=Module.setGlobalStyles,Application.getAvailableStyles=Module.getAvailableStyles,body=options.newsletter.body,globalStyles=_.has(body,"globalStyles")?body.globalStyles:{},this.setGlobalStyles(globalStyles)}),App.on("start",function(StartApp){var stylesView=new Module.StylesView({model:StartApp.getGlobalStyles()});StartApp._appView.showChildView("stylesRegion",stylesView)}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},473:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(33),__webpack_require__(2),__webpack_require__(18),__webpack_require__(10),__webpack_require__(24),__webpack_require__(4),__webpack_require__(5)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,CommunicationComponent,MailPoet,Backbone,Marionette,SuperModel,_,jQuery){"use strict";var SidebarView,Module={};return Module._contentWidgets=new(Backbone.Collection.extend({model:SuperModel.extend({defaults:{name:"",priority:100,widgetView:void 0}}),comparator:"priority"})),Module.registerWidget=function(widget){return Module._contentWidgets.add(widget)},Module.getWidgets=function(){return Module._contentWidgets},Module._layoutWidgets=new(Backbone.Collection.extend({model:SuperModel.extend({defaults:{name:"",priority:100,widgetView:void 0}}),comparator:"priority"})),Module.registerLayoutWidget=function(widget){return Module._layoutWidgets.add(widget)},Module.getLayoutWidgets=function(){return Module._layoutWidgets},SidebarView=Marionette.View.extend({getTemplate:function(){return window.templates.sidebar},regions:{contentRegion:".mailpoet_content_region",layoutRegion:".mailpoet_layout_region",stylesRegion:".mailpoet_styles_region",previewRegion:".mailpoet_preview_region"},events:{"click .mailpoet_sidebar_region h3, .mailpoet_sidebar_region .handlediv":function(event){var $openRegion=this.$el.find(".mailpoet_sidebar_region:not(.closed)"),$targetRegion=this.$el.find(event.target).closest(".mailpoet_sidebar_region");$openRegion.find(".mailpoet_region_content").velocity("slideUp",{duration:250,easing:"easeOut",complete:function(){$openRegion.addClass("closed")}}),$openRegion.get(0)!==$targetRegion.get(0)&&$targetRegion.find(".mailpoet_region_content").velocity("slideDown",{duration:250,easing:"easeIn",complete:function(){$targetRegion.removeClass("closed")}})}},initialize:function(){jQuery(window).on("resize",this.updateHorizontalScroll.bind(this)).on("scroll",this.updateHorizontalScroll.bind(this))},onRender:function(){this.showChildView("contentRegion",new Module.SidebarWidgetsView(App.getWidgets())),this.showChildView("layoutRegion",new Module.SidebarLayoutWidgetsView(App.getLayoutWidgets())),this.showChildView("stylesRegion",new Module.SidebarStylesView({model:App.getGlobalStyles(),availableStyles:App.getAvailableStyles()})),this.showChildView("previewRegion",new Module.SidebarPreviewView)},updateHorizontalScroll:function(){this.$el.parent().each(function(){var calculatedLeft,self=jQuery(this);"fixed"===self.css("position")?(calculatedLeft=self.parent().offset().left-jQuery(window).scrollLeft(),self.css("left",calculatedLeft+"px")):self.css("left","")})},onDomRefresh:function(){this.$el.parent().stick_in_parent({offset_top:32}),this.$el.parent().on("sticky_kit:stick",this.updateHorizontalScroll.bind(this)),this.$el.parent().on("sticky_kit:unstick",this.updateHorizontalScroll.bind(this)),this.$el.parent().on("sticky_kit:bottom",this.updateHorizontalScroll.bind(this)),this.$el.parent().on("sticky_kit:unbottom",this.updateHorizontalScroll.bind(this))}}),Module.SidebarWidgetsCollectionView=Marionette.CollectionView.extend({childView:function(item){return item.get("widgetView")}}),Module.SidebarWidgetsView=Marionette.View.extend({getTemplate:function(){return window.templates.sidebarContent},regions:{widgets:".mailpoet_region_content"},initialize:function(widgets){this.widgets=widgets},onRender:function(){this.showChildView("widgets",new Module.SidebarWidgetsCollectionView({collection:this.widgets}))}}),Module.SidebarLayoutWidgetsView=Module.SidebarWidgetsView.extend({getTemplate:function(){return window.templates.sidebarLayout}}),Module.SidebarStylesView=Marionette.View.extend({getTemplate:function(){return window.templates.sidebarStyles},behaviors:{ColorPickerBehavior:{}},events:function(){return{"change #mailpoet_text_font_color":_.partial(this.changeColorField,"text.fontColor"),"change #mailpoet_text_font_family":function(event){this.model.set("text.fontFamily",event.target.value)},"change #mailpoet_text_font_size":function(event){this.model.set("text.fontSize",event.target.value)},"change #mailpoet_h1_font_color":_.partial(this.changeColorField,"h1.fontColor"),"change #mailpoet_h1_font_family":function(event){this.model.set("h1.fontFamily",event.target.value)},"change #mailpoet_h1_font_size":function(event){this.model.set("h1.fontSize",event.target.value)},"change #mailpoet_h2_font_color":_.partial(this.changeColorField,"h2.fontColor"),"change #mailpoet_h2_font_family":function(event){this.model.set("h2.fontFamily",event.target.value)},"change #mailpoet_h2_font_size":function(event){this.model.set("h2.fontSize",event.target.value)},"change #mailpoet_h3_font_color":_.partial(this.changeColorField,"h3.fontColor"),"change #mailpoet_h3_font_family":function(event){this.model.set("h3.fontFamily",event.target.value)},"change #mailpoet_h3_font_size":function(event){this.model.set("h3.fontSize",event.target.value)},"change #mailpoet_a_font_color":_.partial(this.changeColorField,"link.fontColor"),"change #mailpoet_a_font_underline":function(event){this.model.set("link.textDecoration",event.target.checked?event.target.value:"none")},"change #mailpoet_newsletter_background_color":_.partial(this.changeColorField,"wrapper.backgroundColor"),"change #mailpoet_background_color":_.partial(this.changeColorField,"body.backgroundColor")}},templateContext:function(){return{model:this.model.toJSON(),availableStyles:this.availableStyles.toJSON()}},initialize:function(options){this.availableStyles=options.availableStyles},changeField:function(field,event){this.model.set(field,jQuery(event.target).val())},changeColorField:function(field,event){var value=jQuery(event.target).val();""===value&&(value="transparent"),this.model.set(field,value)}}),Module.SidebarPreviewView=Marionette.View.extend({getTemplate:function(){return window.templates.sidebarPreview},events:{"click .mailpoet_show_preview":"showPreview","click #mailpoet_send_preview":"sendPreview"},onBeforeDestroy:function(){this.previewView&&(this.previewView.destroy(),this.previewView=null)},showPreview:function(){var json=App.toJSON();_.isUndefined(json.body)||(json.body=JSON.stringify(json.body)),MailPoet.Modal.loading(!0),MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"showPreview",data:json}).always(function(){MailPoet.Modal.loading(!1)}).done(function(response){this.previewView=new Module.NewsletterPreviewView({previewUrl:response.meta.preview_url}),this.previewView.render(),this.previewView.$el.css("height","100%"),MailPoet.Modal.popup({template:"",element:this.previewView.$el,width:"95%",height:"94%",title:MailPoet.I18n.t("newsletterPreview"),onCancel:function(){this.previewView.destroy(),this.previewView=null}.bind(this)}),MailPoet.trackEvent("Editor > Browser Preview",{"MailPoet Free version":window.mailpoet_version})}.bind(this)).fail(function(response){response.errors.length>0&&MailPoet.Notice.error(response.errors.map(function(error){return error.message}),{scroll:!0})})},sendPreview:function(){var $emailField=this.$("#mailpoet_preview_to_email"),data={subscriber:$emailField.val(),id:App.getNewsletter().get("id")};if(data.subscriber.length<=0)return MailPoet.Notice.error(MailPoet.I18n.t("newsletterPreviewEmailMissing"),{positionAfter:$emailField,scroll:!0}),!1;MailPoet.Modal.loading(!0),App.getChannel().request("save").always(function(){CommunicationComponent.previewNewsletter(data).always(function(){MailPoet.Modal.loading(!1)}).done(function(){MailPoet.Notice.success(MailPoet.I18n.t("newsletterPreviewSent"),{scroll:!0}),MailPoet.trackEvent("Editor > Preview sent",{"MailPoet Free version":window.mailpoet_version,"Domain name":data.subscriber.substring(data.subscriber.indexOf("@")+1)})}).fail(function(response){response.errors.length>0&&MailPoet.Notice.error(response.errors.map(function(error){return error.message}),{scroll:!0,static:!0})})})}}),Module.NewsletterPreviewView=Marionette.View.extend({getTemplate:function(){return window.templates.newsletterPreview},initialize:function(options){this.previewUrl=options.previewUrl,this.width="100%",this.height="100%"},templateContext:function(){return{previewUrl:this.previewUrl,width:this.width,height:this.height}}}),App.on("before:start",function(BeforeStartApp){var Application=BeforeStartApp;Application.registerWidget=Module.registerWidget,Application.getWidgets=Module.getWidgets,Application.registerLayoutWidget=Module.registerLayoutWidget,Application.getLayoutWidgets=Module.getLayoutWidgets}),App.on("start",function(StartApp){var sidebarView=new SidebarView;StartApp._appView.showChildView("sidebarRegion",sidebarView),MailPoet.helpTooltip.show(document.getElementById("tooltip-send-preview"),{tooltipId:"tooltip-editor-send-preview",tooltip:MailPoet.I18n.t("helpTooltipSendPreview")})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},474:function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(24),__webpack_require__(4),__webpack_require__(2)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,SuperModel,_,MailPoet){var Module={};return Module.NewsletterModel=SuperModel.extend({whitelisted:["id","subject","preheader","type"],initialize:function(){this.on("change",function(){App.getChannel().trigger("autoSave")})},toJSON:function(){return _.pick(SuperModel.prototype.toJSON.call(this),this.whitelisted)}}),Module._blockTypes={},Module.registerBlockType=function(type,data){Module._blockTypes[type]=data},Module.getBlockTypeModel=function(type){if(type in Module._blockTypes)return Module._blockTypes[type].blockModel;throw new Error("Block type not supported: "+type)},Module.getBlockTypeView=function(type){if(type in Module._blockTypes)return Module._blockTypes[type].blockView;throw new Error("Block type not supported: "+type)},Module.getBody=function(){return{content:App._contentContainer.toJSON(),globalStyles:App.getGlobalStyles().toJSON(),blockDefaults:_.omit(App.getConfig().toJSON().blockDefaults,"text","image")}},Module.toJSON=function(){return _.extend({body:Module.getBody()},App.getNewsletter().toJSON())},Module.getNewsletter=function(){return Module.newsletter},Module.findModels=function(predicate){var blocks=App._contentContainer.getChildren();return _.filter(blocks,predicate)},App.on("before:start",function(Application,options){var BeforeStartApp=Application;BeforeStartApp.registerBlockType=Module.registerBlockType,BeforeStartApp.getBlockTypeModel=Module.getBlockTypeModel,BeforeStartApp.getBlockTypeView=Module.getBlockTypeView,BeforeStartApp.toJSON=Module.toJSON,BeforeStartApp.getBody=Module.getBody,BeforeStartApp.getNewsletter=Module.getNewsletter,BeforeStartApp.findModels=Module.findModels,Module.newsletter=new Module.NewsletterModel(_.omit(_.clone(options.newsletter),["body"]))}),App.on("start",function(Application,options){var StartApp=Application,body=options.newsletter.body,bodyContent=_.has(body,"content")?body.content:{};_.has(options.newsletter,"body")&&_.isObject(options.newsletter.body)||MailPoet.Notice.error(MailPoet.I18n.t("newsletterBodyIsCorrupted"),{static:!0}),StartApp._contentContainer=new(StartApp.getBlockTypeModel("container"))(bodyContent,{parse:!0}),StartApp._contentContainerView=new(StartApp.getBlockTypeView("container"))({model:StartApp._contentContainer,renderOptions:{depth:0}}),StartApp._appView.showChildView("contentRegion",StartApp._contentContainerView)}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},475:function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(18),__webpack_require__(10),__webpack_require__(4),__webpack_require__(5),__webpack_require__(2)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,Backbone,Marionette,_,jQuery,MailPoet){var Module={};return Module.HeadingView=Marionette.View.extend({getTemplate:function(){return window.templates.heading},templateContext:function(){return{model:this.model.toJSON()}},events:function(){return{"keyup .mailpoet_input_title":_.partial(this.changeField,"subject"),"keyup .mailpoet_input_preheader":_.partial(this.changeField,"preheader")}},changeField:function(field,event){this.model.set(field,jQuery(event.target).val())}}),App.on("start",function(StartApp){StartApp._appView.showChildView("headingRegion",new Module.HeadingView({model:StartApp.getNewsletter()})),MailPoet.helpTooltip.show(document.getElementById("tooltip-designer-subject-line"),{tooltipId:"tooltip-designer-subject-line-ti",tooltip:MailPoet.I18n.t("helpTooltipDesignerSubjectLine"),place:"right"}),MailPoet.helpTooltip.show(document.getElementById("tooltip-designer-preheader"),{tooltipId:"tooltip-designer-preheader-ti",tooltip:MailPoet.I18n.t("helpTooltipDesignerPreheader")})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},476:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(33),__webpack_require__(2),__webpack_require__(179),__webpack_require__(18),__webpack_require__(10),__webpack_require__(5),__webpack_require__(477),__webpack_require__(478),__webpack_require__(294),__webpack_require__(4),__webpack_require__(5)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,CommunicationComponent,MailPoet,Notice,Backbone,Marionette,jQuery,Blob,FileSaver,Thumbnail,_,$){"use strict";var saveTimeout,Module={};return Module.save=function(){var json=App.toJSON(),editorTop=$("#mailpoet_editor_top");return _.isUndefined(json.body)||(json.body=JSON.stringify(json.body)),App.getChannel().trigger("beforeEditorSave",json),CommunicationComponent.saveNewsletter(json).done(function(response){void 0!==response.success&&!0===response.success||void 0!==response.error&&(0===response.error.length?MailPoet.Notice.error(MailPoet.I18n.t("templateSaveFailed"),{positionAfter:editorTop,scroll:!0}):$(response.error).each(function(i,error){MailPoet.Notice.error(error,{positionAfter:editorTop,scroll:!0})})),_.isUndefined(json.body)||(json.body=JSON.parse(json.body)),App.getChannel().trigger("afterEditorSave",json,response)}).fail(function(response){App.getChannel().trigger("afterEditorSave",{},response)})},Module.saveTemplate=function(options){return Thumbnail.fromNewsletter(App.toJSON()).then(function(thumbnail){var data=_.extend(options||{},{thumbnail:thumbnail,body:JSON.stringify(App.getBody()),categories:JSON.stringify(["saved",App.getNewsletter().get("type")])});return MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletterTemplates",action:"save",data:data})})},Module.exportTemplate=function(options){return Thumbnail.fromNewsletter(App.toJSON()).then(function(thumbnail){var data=_.extend(options||{},{thumbnail:thumbnail,body:App.getBody(),categories:JSON.stringify(["saved",App.getNewsletter().get("type")])}),blob=new Blob([JSON.stringify(data)],{type:"application/json;charset=utf-8"});FileSaver.saveAs(blob,"template.json"),MailPoet.trackEvent("Editor > Template exported",{"MailPoet Free version":window.mailpoet_version})})},Module.SaveView=Marionette.View.extend({getTemplate:function(){return window.templates.save},templateContext:function(){return{wrapperClass:this.wrapperClass}},events:{"click .mailpoet_save_button":"save","click .mailpoet_save_show_options":"toggleSaveOptions","click .mailpoet_save_next":"next","click .mailpoet_save_template":"showSaveAsTemplate","click .mailpoet_save_as_template":"saveAsTemplate","click .mailpoet_save_export":"showExportTemplate","click .mailpoet_export_template":"exportTemplate"},initialize:function(){this.setDropdownDirectionDown(),App.getChannel().on("beforeEditorSave",this.beforeSave,this),App.getChannel().on("afterEditorSave",this.afterSave,this)},setDropdownDirectionDown:function(){this.wrapperClass="mailpoet_save_dropdown_down"},setDropdownDirectionUp:function(){this.wrapperClass="mailpoet_save_dropdown_up"},onRender:function(){this.validateNewsletter(App.toJSON())},save:function(){this.hideSaveOptions(),App.getChannel().request("save")},beforeSave:function(){this.$(".mailpoet_autosaved_at").text(MailPoet.I18n.t("saving"))},afterSave:function(json){this.validateNewsletter(json),this.$(".mailpoet_editor_last_saved").removeClass("mailpoet_hidden"),this.$(".mailpoet_autosaved_at").text("")},showSaveOptions:function(){this.$(".mailpoet_save_show_options").addClass("mailpoet_save_show_options_active"),this.$(".mailpoet_save_options").removeClass("mailpoet_hidden"),this.hideSaveAsTemplate(),this.hideExportTemplate()},hideSaveOptions:function(){this.$(".mailpoet_save_show_options").removeClass("mailpoet_save_show_options_active"),this.$(".mailpoet_save_options").addClass("mailpoet_hidden"),this.hideSaveAsTemplate(),this.hideExportTemplate()},toggleSaveOptions:function(){this.$(".mailpoet_save_show_options").hasClass("mailpoet_save_show_options_active")?this.hideSaveOptions():this.showSaveOptions()},showSaveAsTemplate:function(){this.$(".mailpoet_save_as_template_container").removeClass("mailpoet_hidden")},hideSaveAsTemplate:function(){this.$(".mailpoet_save_as_template_container").addClass("mailpoet_hidden")},saveAsTemplate:function(){var templateName=this.$(".mailpoet_save_as_template_name").val(),editorTop=$("#mailpoet_editor_top");""===templateName?MailPoet.Notice.error(MailPoet.I18n.t("templateNameMissing"),{positionAfter:editorTop,scroll:!0}):(Module.saveTemplate({name:templateName}).then(function(){MailPoet.Notice.success(MailPoet.I18n.t("templateSaved"),{positionAfter:editorTop,scroll:!0}),MailPoet.trackEvent("Editor > Template saved",{"MailPoet Free version":window.mailpoet_version})}).catch(function(){MailPoet.Notice.error(MailPoet.I18n.t("templateSaveFailed"),{positionAfter:editorTop,scroll:!0})}),this.hideSaveOptions())},showExportTemplate:function(){this.$(".mailpoet_export_template_container").removeClass("mailpoet_hidden")},hideExportTemplate:function(){this.$(".mailpoet_export_template_container").addClass("mailpoet_hidden")},exportTemplate:function(){var templateName=this.$(".mailpoet_export_template_name").val(),editorTop=$("#mailpoet_editor_top");""===templateName?MailPoet.Notice.error(MailPoet.I18n.t("templateNameMissing"),{positionAfter:editorTop,scroll:!0}):(Module.exportTemplate({name:templateName}),this.hideExportTemplate())},next:function(){this.hideSaveOptions(),this.$(".mailpoet_save_next").hasClass("button-disabled")||(Module._cancelAutosave(),Module.save().done(function(){window.location.href=App.getConfig().get("urls.send")}))},validateNewsletter:function(jsonObject){var body="";return App._contentContainer.isValid()?(jsonObject&&jsonObject.body&&jsonObject.body.content&&(body=JSON.stringify(jsonObject.body.content)),App.getConfig().get("validation.validateUnsubscribeLinkPresent")&&body.indexOf("[link:subscription_unsubscribe_url]")<0&&body.indexOf("[link:subscription_unsubscribe]")<0?void this.showValidationError(MailPoet.I18n.t("unsubscribeLinkMissing")):"notification"===App.getNewsletter().get("type")&&body.indexOf('"type":"automatedLatestContent"')<0&&body.indexOf('"type":"automatedLatestContentLayout"')<0?void this.showValidationError(MailPoet.I18n.t("automatedLatestContentMissing")):void this.hideValidationError()):void this.showValidationError(App._contentContainer.validationError)},showValidationError:function(message){var $el=this.$(".mailpoet_save_error");$el.text(message),$el.removeClass("mailpoet_hidden"),this.$(".mailpoet_save_next").addClass("button-disabled")},hideValidationError:function(){this.$(".mailpoet_save_error").addClass("mailpoet_hidden"),this.$(".mailpoet_save_next").removeClass("button-disabled")}}),Module.autoSave=function(){Module._cancelAutosave(),saveTimeout=setTimeout(function(){App.getChannel().request("save").always(function(){Module._cancelAutosave()})},1e3)},Module._cancelAutosave=function(){saveTimeout&&(clearTimeout(saveTimeout),saveTimeout=void 0)},Module.beforeExitWithUnsavedChanges=function(e){var message,event;if(saveTimeout)return message=MailPoet.I18n.t("unsavedChangesWillBeLost"),event=e||window.event,event&&(event.returnValue=message),message},App.on("before:start",function(BeforeStartApp){var Application=BeforeStartApp;Application.save=Module.save,Application.getChannel().on("autoSave",Module.autoSave),window.onbeforeunload=Module.beforeExitWithUnsavedChanges,Application.getChannel().reply("save",Application.save)}),App.on("start",function(BeforeStartApp){var topSaveView=new Module.SaveView,bottomSaveView=new Module.SaveView;bottomSaveView.setDropdownDirectionUp(),BeforeStartApp._appView.showChildView("topRegion",topSaveView),BeforeStartApp._appView.showChildView("bottomRegion",bottomSaveView)}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},477:function(module,exports){/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
!function(view){"use strict";if(view.URL=view.URL||view.webkitURL,view.Blob&&view.URL)try{return void new Blob}catch(e){}var BlobBuilder=view.BlobBuilder||view.WebKitBlobBuilder||view.MozBlobBuilder||function(view){var get_class=function(object){return Object.prototype.toString.call(object).match(/^\[object\s(.*)\]$/)[1]},FakeBlobBuilder=function(){this.data=[]},FakeBlob=function(data,type,encoding){this.data=data,this.size=data.length,this.type=type,this.encoding=encoding},FBB_proto=FakeBlobBuilder.prototype,FB_proto=FakeBlob.prototype,FileReaderSync=view.FileReaderSync,FileException=function(type){this.code=this[this.name=type]},file_ex_codes="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),file_ex_code=file_ex_codes.length,real_URL=view.URL||view.webkitURL||view,real_create_object_URL=real_URL.createObjectURL,real_revoke_object_URL=real_URL.revokeObjectURL,URL=real_URL,btoa=view.btoa,atob=view.atob,ArrayBuffer=view.ArrayBuffer,Uint8Array=view.Uint8Array,origin=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(FakeBlob.fake=FB_proto.fake=!0;file_ex_code--;)FileException.prototype[file_ex_codes[file_ex_code]]=file_ex_code+1;return real_URL.createObjectURL||(URL=view.URL=function(uri){var uri_origin,uri_info=document.createElementNS("http://www.w3.org/1999/xhtml","a");return uri_info.href=uri,"origin"in uri_info||("data:"===uri_info.protocol.toLowerCase()?uri_info.origin=null:(uri_origin=uri.match(origin),uri_info.origin=uri_origin&&uri_origin[1])),uri_info}),URL.createObjectURL=function(blob){var data_URI_header,type=blob.type;return null===type&&(type="application/octet-stream"),blob instanceof FakeBlob?(data_URI_header="data:"+type,"base64"===blob.encoding?data_URI_header+";base64,"+blob.data:"URI"===blob.encoding?data_URI_header+","+decodeURIComponent(blob.data):btoa?data_URI_header+";base64,"+btoa(blob.data):data_URI_header+","+encodeURIComponent(blob.data)):real_create_object_URL?real_create_object_URL.call(real_URL,blob):void 0},URL.revokeObjectURL=function(object_URL){"data:"!==object_URL.substring(0,5)&&real_revoke_object_URL&&real_revoke_object_URL.call(real_URL,object_URL)},FBB_proto.append=function(data){var bb=this.data;if(Uint8Array&&(data instanceof ArrayBuffer||data instanceof Uint8Array)){for(var str="",buf=new Uint8Array(data),i=0,buf_len=buf.length;i<buf_len;i++)str+=String.fromCharCode(buf[i]);bb.push(str)}else if("Blob"===get_class(data)||"File"===get_class(data)){if(!FileReaderSync)throw new FileException("NOT_READABLE_ERR");var fr=new FileReaderSync;bb.push(fr.readAsBinaryString(data))}else data instanceof FakeBlob?"base64"===data.encoding&&atob?bb.push(atob(data.data)):"URI"===data.encoding?bb.push(decodeURIComponent(data.data)):"raw"===data.encoding&&bb.push(data.data):("string"!=typeof data&&(data+=""),bb.push(unescape(encodeURIComponent(data))))},FBB_proto.getBlob=function(type){return arguments.length||(type=null),new FakeBlob(this.data.join(""),type,"raw")},FBB_proto.toString=function(){return"[object BlobBuilder]"},FB_proto.slice=function(start,end,type){var args=arguments.length;return args<3&&(type=null),new FakeBlob(this.data.slice(start,args>1?end:this.data.length),type,this.encoding)},FB_proto.toString=function(){return"[object Blob]"},FB_proto.close=function(){this.size=0,delete this.data},FakeBlobBuilder}(view);view.Blob=function(blobParts,options){var type=options?options.type||"":"",builder=new BlobBuilder;if(blobParts)for(var i=0,len=blobParts.length;i<len;i++)Uint8Array&&blobParts[i]instanceof Uint8Array?builder.append(blobParts[i].buffer):builder.append(blobParts[i]);var blob=builder.getBlob(type);return!blob.slice&&blob.webkitSlice&&(blob.slice=blob.webkitSlice),blob};var getPrototypeOf=Object.getPrototypeOf||function(object){return object.__proto__};view.Blob.prototype=getPrototypeOf(new view.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),module.exports=window.Blob},478:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__,saveAs=saveAs||function(view){"use strict";if(!(void 0===view||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,click=function(node){var event=new MouseEvent("click");node.dispatchEvent(event)},is_safari=/constructor/i.test(view.HTMLElement)||view.safari,is_chrome_ios=/CriOS\/[\d]+/.test(navigator.userAgent),throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},revoke=function(file){var revoker=function(){"string"==typeof file?get_URL().revokeObjectURL(file):file.remove()};setTimeout(revoker,4e4)},dispatch=function(filesaver,event_types,event){event_types=[].concat(event_types);for(var i=event_types.length;i--;){var listener=filesaver["on"+event_types[i]];if("function"==typeof listener)try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}},auto_bom=function(blob){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)?new Blob([String.fromCharCode(65279),blob],{type:blob.type}):blob},FileSaver=function(blob,name,no_auto_bom){no_auto_bom||(blob=auto_bom(blob));var object_url,filesaver=this,type=blob.type,force="application/octet-stream"===type,dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "))};if(filesaver.readyState=filesaver.INIT,can_use_save_link)return object_url=get_URL().createObjectURL(blob),void setTimeout(function(){save_link.href=object_url,save_link.download=name,click(save_link),dispatch_all(),revoke(object_url),filesaver.readyState=filesaver.DONE});!function(){if((is_chrome_ios||force&&is_safari)&&view.FileReader){var reader=new FileReader;return reader.onloadend=function(){var url=is_chrome_ios?reader.result:reader.result.replace(/^data:[^;]*;/,"data:attachment/file;");view.open(url,"_blank")||(view.location.href=url),url=void 0,filesaver.readyState=filesaver.DONE,dispatch_all()},reader.readAsDataURL(blob),void(filesaver.readyState=filesaver.INIT)}if(object_url||(object_url=get_URL().createObjectURL(blob)),force)view.location.href=object_url;else{view.open(object_url,"_blank")||(view.location.href=object_url)}filesaver.readyState=filesaver.DONE,dispatch_all(),revoke(object_url)}()},FS_proto=FileSaver.prototype,saveAs=function(blob,name,no_auto_bom){return new FileSaver(blob,name||blob.name||"download",no_auto_bom)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(blob,name,no_auto_bom){return name=name||blob.name||"download",no_auto_bom||(blob=auto_bom(blob)),navigator.msSaveOrOpenBlob(blob,name)}:(FS_proto.abort=function(){},FS_proto.readyState=FS_proto.INIT=0,FS_proto.WRITING=1,FS_proto.DONE=2,FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null,saveAs)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==module&&module.exports?module.exports.saveAs=saveAs:null!==__webpack_require__(479)&&null!==__webpack_require__(29)&&void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){return saveAs}.call(exports,__webpack_require__,exports,module))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},479:function(module,exports){module.exports=function(){throw new Error("define cannot be used indirect")}},480:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(19),__webpack_require__(2),__webpack_require__(481)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,BehaviorsLookup,MailPoet){BehaviorsLookup.ColorPickerBehavior=Marionette.Behavior.extend({onRender:function(){var that=this;this.view.$(".mailpoet_color").each(function(){var $input=that.view.$(this),updateColorInput=function(color){color&&color.getAlpha()>0?$input.val(color.toString("hex6")):$input.val(""),$input.trigger("change")};$input.spectrum({clickoutFiresChange:!0,showInput:!0,showInitial:!0,showPalette:!0,showSelectionPalette:!0,palette:[],localStorageKey:"newsletter_editor.spectrum.palette",preferredFormat:"hex6",allowEmpty:!0,chooseText:MailPoet.I18n.t("selectColor"),cancelText:MailPoet.I18n.t("cancelColorSelection"),change:updateColorInput,move:updateColorInput,hide:updateColorInput})})}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},481:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(factory){"use strict";__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(5)],__WEBPACK_AMD_DEFINE_FACTORY__=factory,void 0!==(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(function($,undefined){"use strict";function paletteTemplate(p,color,className,opts){for(var html=[],i=0;i<p.length;i++){var current=p[i];if(current){var tiny=tinycolor(current),c=tiny.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(color,current)?" sp-thumb-active":"";var formattedString=tiny.toString(opts.preferredFormat||"rgb"),swatchStyle=rgbaSupport?"background-color:"+tiny.toRgbString():"filter:"+tiny.toFilter();html.push('<span title="'+formattedString+'" data-color="'+tiny.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+swatchStyle+';" /></span>')}else{html.push($("<div />").append($('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",opts.noColorSelectedText)).html())}}return"<div class='sp-cf "+className+"'>"+html.join("")+"</div>"}function hideAll(){for(var i=0;i<spectrums.length;i++)spectrums[i]&&spectrums[i].hide()}function instanceOptions(o,callbackContext){var opts=$.extend({},defaultOpts,o);return opts.callbacks={move:bind(opts.move,callbackContext),change:bind(opts.change,callbackContext),show:bind(opts.show,callbackContext),hide:bind(opts.hide,callbackContext),beforeShow:bind(opts.beforeShow,callbackContext)},opts}function spectrum(element,o){function applyOptions(){if(opts.showPaletteOnly&&(opts.showPalette=!0),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),opts.palette){palette=opts.palette.slice(0),paletteArray=$.isArray(palette[0])?palette:[palette],paletteLookup={};for(var i=0;i<paletteArray.length;i++)for(var j=0;j<paletteArray[i].length;j++){var rgb=tinycolor(paletteArray[i][j]).toRgbString();paletteLookup[rgb]=!0}}container.toggleClass("sp-flat",flat),container.toggleClass("sp-input-disabled",!opts.showInput),container.toggleClass("sp-alpha-enabled",opts.showAlpha),container.toggleClass("sp-clear-enabled",allowEmpty),container.toggleClass("sp-buttons-disabled",!opts.showButtons),container.toggleClass("sp-palette-buttons-disabled",!opts.togglePaletteOnly),container.toggleClass("sp-palette-disabled",!opts.showPalette),container.toggleClass("sp-palette-only",opts.showPaletteOnly),container.toggleClass("sp-initial-disabled",!opts.showInitial),container.addClass(opts.className).addClass(opts.containerClassName),reflow()}function updateSelectionPaletteFromStorage(){if(localStorageKey&&window.localStorage){try{var oldPalette=window.localStorage[localStorageKey].split(",#");oldPalette.length>1&&(delete window.localStorage[localStorageKey],$.each(oldPalette,function(i,c){addColorToSelectionPalette(c)}))}catch(e){}try{selectionPalette=window.localStorage[localStorageKey].split(";")}catch(e){}}}function addColorToSelectionPalette(color){if(showSelectionPalette){var rgb=tinycolor(color).toRgbString();if(!paletteLookup[rgb]&&-1===$.inArray(rgb,selectionPalette))for(selectionPalette.push(rgb);selectionPalette.length>maxSelectionSize;)selectionPalette.shift();if(localStorageKey&&window.localStorage)try{window.localStorage[localStorageKey]=selectionPalette.join(";")}catch(e){}}}function getUniqueSelectionPalette(){var unique=[];if(opts.showPalette)for(var i=0;i<selectionPalette.length;i++){var rgb=tinycolor(selectionPalette[i]).toRgbString();paletteLookup[rgb]||unique.push(selectionPalette[i])}return unique.reverse().slice(0,opts.maxSelectionSize)}function drawPalette(){var currentColor=get(),html=$.map(paletteArray,function(palette,i){return paletteTemplate(palette,currentColor,"sp-palette-row sp-palette-row-"+i,opts)});updateSelectionPaletteFromStorage(),selectionPalette&&html.push(paletteTemplate(getUniqueSelectionPalette(),currentColor,"sp-palette-row sp-palette-row-selection",opts)),paletteContainer.html(html.join(""))}function drawInitial(){if(opts.showInitial){var initial=colorOnShow,current=get();initialColorContainer.html(paletteTemplate([initial,current],current,"sp-palette-row-initial",opts))}}function dragStart(){(dragHeight<=0||dragWidth<=0||slideHeight<=0)&&reflow(),isDragging=!0,container.addClass(draggingClass),shiftMovementDirection=null,boundElement.trigger("dragstart.spectrum",[get()])}function dragStop(){isDragging=!1,container.removeClass(draggingClass),boundElement.trigger("dragstop.spectrum",[get()])}function setFromTextInput(){var value=textInput.val();if(null!==value&&""!==value||!allowEmpty){var tiny=tinycolor(value);tiny.isValid()?(set(tiny),updateOriginalInput(!0)):textInput.addClass("sp-validation-error")}else set(null),updateOriginalInput(!0)}function toggle(){visible?hide():show()}function show(){var event=$.Event("beforeShow.spectrum");if(visible)return void reflow();boundElement.trigger(event,[get()]),!1===callbacks.beforeShow(get())||event.isDefaultPrevented()||(hideAll(),visible=!0,$(doc).bind("keydown.spectrum",onkeydown),$(doc).bind("click.spectrum",clickout),$(window).bind("resize.spectrum",resize),replacer.addClass("sp-active"),container.removeClass("sp-hidden"),reflow(),updateUI(),colorOnShow=get(),drawInitial(),callbacks.show(colorOnShow),boundElement.trigger("show.spectrum",[colorOnShow]))}function onkeydown(e){27===e.keyCode&&hide()}function clickout(e){2!=e.button&&(isDragging||(clickoutFiresChange?updateOriginalInput(!0):revert(),hide()))}function hide(){visible&&!flat&&(visible=!1,$(doc).unbind("keydown.spectrum",onkeydown),$(doc).unbind("click.spectrum",clickout),$(window).unbind("resize.spectrum",resize),replacer.removeClass("sp-active"),container.addClass("sp-hidden"),callbacks.hide(get()),boundElement.trigger("hide.spectrum",[get()]))}function revert(){set(colorOnShow,!0)}function set(color,ignoreFormatChange){if(tinycolor.equals(color,get()))return void updateUI();var newColor,newHsv;!color&&allowEmpty?isEmpty=!0:(isEmpty=!1,newColor=tinycolor(color),newHsv=newColor.toHsv(),currentHue=newHsv.h%360/360,currentSaturation=newHsv.s,currentValue=newHsv.v,currentAlpha=newHsv.a),updateUI(),newColor&&newColor.isValid()&&!ignoreFormatChange&&(currentPreferredFormat=opts.preferredFormat||newColor.getFormat())}function get(opts){return opts=opts||{},allowEmpty&&isEmpty?null:tinycolor.fromRatio({h:currentHue,s:currentSaturation,v:currentValue,a:Math.round(100*currentAlpha)/100},{format:opts.format||currentPreferredFormat})}function isValid(){return!textInput.hasClass("sp-validation-error")}function move(){updateUI(),callbacks.move(get()),boundElement.trigger("move.spectrum",[get()])}function updateUI(){textInput.removeClass("sp-validation-error"),updateHelperLocations();var flatColor=tinycolor.fromRatio({h:currentHue,s:1,v:1});dragger.css("background-color",flatColor.toHexString());var format=currentPreferredFormat;currentAlpha<1&&(0!==currentAlpha||"name"!==format)&&("hex"!==format&&"hex3"!==format&&"hex6"!==format&&"name"!==format||(format="rgb"));var realColor=get({format:format}),displayColor="";if(previewElement.removeClass("sp-clear-display"),previewElement.css("background-color","transparent"),!realColor&&allowEmpty)previewElement.addClass("sp-clear-display");else{var realHex=realColor.toHexString(),realRgb=realColor.toRgbString();if(rgbaSupport||1===realColor.alpha?previewElement.css("background-color",realRgb):(previewElement.css("background-color","transparent"),previewElement.css("filter",realColor.toFilter())),opts.showAlpha){var rgb=realColor.toRgb();rgb.a=0;var realAlpha=tinycolor(rgb).toRgbString(),gradient="linear-gradient(left, "+realAlpha+", "+realHex+")";IE?alphaSliderInner.css("filter",tinycolor(realAlpha).toFilter({gradientType:1},realHex)):(alphaSliderInner.css("background","-webkit-"+gradient),alphaSliderInner.css("background","-moz-"+gradient),alphaSliderInner.css("background","-ms-"+gradient),alphaSliderInner.css("background","linear-gradient(to right, "+realAlpha+", "+realHex+")"))}displayColor=realColor.toString(format)}opts.showInput&&textInput.val(displayColor),opts.showPalette&&drawPalette(),drawInitial()}function updateHelperLocations(){var s=currentSaturation,v=currentValue;if(allowEmpty&&isEmpty)alphaSlideHelper.hide(),slideHelper.hide(),dragHelper.hide();else{alphaSlideHelper.show(),slideHelper.show(),dragHelper.show();var dragX=s*dragWidth,dragY=dragHeight-v*dragHeight;dragX=Math.max(-dragHelperHeight,Math.min(dragWidth-dragHelperHeight,dragX-dragHelperHeight)),dragY=Math.max(-dragHelperHeight,Math.min(dragHeight-dragHelperHeight,dragY-dragHelperHeight)),dragHelper.css({top:dragY+"px",left:dragX+"px"});var alphaX=currentAlpha*alphaWidth;alphaSlideHelper.css({left:alphaX-alphaSlideHelperWidth/2+"px"});var slideY=currentHue*slideHeight;slideHelper.css({top:slideY-slideHelperHeight+"px"})}}function updateOriginalInput(fireCallback){var color=get(),displayColor="",hasChanged=!tinycolor.equals(color,colorOnShow);color&&(displayColor=color.toString(currentPreferredFormat),addColorToSelectionPalette(color)),isInput&&boundElement.val(displayColor),fireCallback&&hasChanged&&(callbacks.change(color),boundElement.trigger("change",[color]))}function reflow(){visible&&(dragWidth=dragger.width(),dragHeight=dragger.height(),dragHelperHeight=dragHelper.height(),slideWidth=slider.width(),slideHeight=slider.height(),slideHelperHeight=slideHelper.height(),alphaWidth=alphaSlider.width(),alphaSlideHelperWidth=alphaSlideHelper.width(),flat||(container.css("position","absolute"),opts.offset?container.offset(opts.offset):container.offset(getOffset(container,offsetElement))),updateHelperLocations(),opts.showPalette&&drawPalette(),boundElement.trigger("reflow.spectrum"))}function destroy(){boundElement.show(),offsetElement.unbind("click.spectrum touchstart.spectrum"),container.remove(),replacer.remove(),spectrums[spect.id]=null}function option(optionName,optionValue){return optionName===undefined?$.extend({},opts):optionValue===undefined?opts[optionName]:(opts[optionName]=optionValue,"preferredFormat"===optionName&&(currentPreferredFormat=opts.preferredFormat),void applyOptions())}function enable(){disabled=!1,boundElement.attr("disabled",!1),offsetElement.removeClass("sp-disabled")}function disable(){hide(),disabled=!0,boundElement.attr("disabled",!0),offsetElement.addClass("sp-disabled")}function setOffset(coord){opts.offset=coord,reflow()}var opts=instanceOptions(o,element),flat=opts.flat,showSelectionPalette=opts.showSelectionPalette,localStorageKey=opts.localStorageKey,theme=opts.theme,callbacks=opts.callbacks,resize=throttle(reflow,10),visible=!1,isDragging=!1,dragWidth=0,dragHeight=0,dragHelperHeight=0,slideHeight=0,slideWidth=0,alphaWidth=0,alphaSlideHelperWidth=0,slideHelperHeight=0,currentHue=0,currentSaturation=0,currentValue=0,currentAlpha=1,palette=[],paletteArray=[],paletteLookup={},selectionPalette=opts.selectionPalette.slice(0),maxSelectionSize=opts.maxSelectionSize,draggingClass="sp-dragging",shiftMovementDirection=null,doc=element.ownerDocument,boundElement=(doc.body,$(element)),disabled=!1,container=$(markup,doc).addClass(theme),pickerContainer=container.find(".sp-picker-container"),dragger=container.find(".sp-color"),dragHelper=container.find(".sp-dragger"),slider=container.find(".sp-hue"),slideHelper=container.find(".sp-slider"),alphaSliderInner=container.find(".sp-alpha-inner"),alphaSlider=container.find(".sp-alpha"),alphaSlideHelper=container.find(".sp-alpha-handle"),textInput=container.find(".sp-input"),paletteContainer=container.find(".sp-palette"),initialColorContainer=container.find(".sp-initial"),cancelButton=container.find(".sp-cancel"),clearButton=container.find(".sp-clear"),chooseButton=container.find(".sp-choose"),toggleButton=container.find(".sp-palette-toggle"),isInput=boundElement.is("input"),isInputTypeColor=isInput&&"color"===boundElement.attr("type")&&inputTypeColorSupport(),shouldReplace=isInput&&!flat,replacer=shouldReplace?$(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName):$([]),offsetElement=shouldReplace?replacer:boundElement,previewElement=replacer.find(".sp-preview-inner"),initialColor=opts.color||isInput&&boundElement.val(),colorOnShow=!1,currentPreferredFormat=opts.preferredFormat,clickoutFiresChange=!opts.showButtons||opts.clickoutFiresChange,isEmpty=!initialColor,allowEmpty=opts.allowEmpty&&!isInputTypeColor;!function(){function paletteElementClick(e){return e.data&&e.data.ignore?(set($(e.target).closest(".sp-thumb-el").data("color")),move()):(set($(e.target).closest(".sp-thumb-el").data("color")),move(),updateOriginalInput(!0),opts.hideAfterPaletteSelect&&hide()),!1}if(IE&&container.find("*:not(input)").attr("unselectable","on"),applyOptions(),shouldReplace&&boundElement.after(replacer).hide(),allowEmpty||clearButton.hide(),flat)boundElement.after(container).hide();else{var appendTo="parent"===opts.appendTo?boundElement.parent():$(opts.appendTo);1!==appendTo.length&&(appendTo=$("body")),appendTo.append(container)}updateSelectionPaletteFromStorage(),offsetElement.bind("click.spectrum touchstart.spectrum",function(e){disabled||toggle(),e.stopPropagation(),$(e.target).is("input")||e.preventDefault()}),(boundElement.is(":disabled")||!0===opts.disabled)&&disable(),container.click(stopPropagation),textInput.change(setFromTextInput),textInput.bind("paste",function(){setTimeout(setFromTextInput,1)}),textInput.keydown(function(e){13==e.keyCode&&setFromTextInput()}),cancelButton.text(opts.cancelText),cancelButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),revert(),hide()}),clearButton.attr("title",opts.clearText),clearButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),isEmpty=!0,move(),flat&&updateOriginalInput(!0)}),chooseButton.text(opts.chooseText),chooseButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),IE&&textInput.is(":focus")&&textInput.trigger("change"),isValid()&&(updateOriginalInput(!0),hide())}),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),toggleButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),opts.showPaletteOnly=!opts.showPaletteOnly,opts.showPaletteOnly||flat||container.css("left","-="+(pickerContainer.outerWidth(!0)+5)),applyOptions()}),draggable(alphaSlider,function(dragX,dragY,e){currentAlpha=dragX/alphaWidth,isEmpty=!1,e.shiftKey&&(currentAlpha=Math.round(10*currentAlpha)/10),move()},dragStart,dragStop),draggable(slider,function(dragX,dragY){currentHue=parseFloat(dragY/slideHeight),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),draggable(dragger,function(dragX,dragY,e){if(e.shiftKey){if(!shiftMovementDirection){var oldDragX=currentSaturation*dragWidth,oldDragY=dragHeight-currentValue*dragHeight,furtherFromX=Math.abs(dragX-oldDragX)>Math.abs(dragY-oldDragY);shiftMovementDirection=furtherFromX?"x":"y"}}else shiftMovementDirection=null;var setSaturation=!shiftMovementDirection||"x"===shiftMovementDirection,setValue=!shiftMovementDirection||"y"===shiftMovementDirection;setSaturation&&(currentSaturation=parseFloat(dragX/dragWidth)),setValue&&(currentValue=parseFloat((dragHeight-dragY)/dragHeight)),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),initialColor?(set(initialColor),updateUI(),currentPreferredFormat=opts.preferredFormat||tinycolor(initialColor).format,addColorToSelectionPalette(initialColor)):updateUI(),flat&&show();var paletteEvent=IE?"mousedown.spectrum":"click.spectrum touchstart.spectrum";paletteContainer.delegate(".sp-thumb-el",paletteEvent,paletteElementClick),initialColorContainer.delegate(".sp-thumb-el:nth-child(1)",paletteEvent,{ignore:!0},paletteElementClick)}();var spect={show:show,hide:hide,toggle:toggle,reflow:reflow,option:option,enable:enable,disable:disable,offset:setOffset,set:function(c){set(c),updateOriginalInput()},get:get,destroy:destroy,container:container};return spect.id=spectrums.push(spect)-1,spect}function getOffset(picker,input){var dpWidth=picker.outerWidth(),dpHeight=picker.outerHeight(),inputHeight=input.outerHeight(),doc=picker[0].ownerDocument,docElem=doc.documentElement,viewWidth=docElem.clientWidth+$(doc).scrollLeft(),viewHeight=docElem.clientHeight+$(doc).scrollTop(),offset=input.offset();return offset.top+=inputHeight,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight-0):0),offset}function noop(){}function stopPropagation(e){e.stopPropagation()}function bind(func,obj){var slice=Array.prototype.slice,args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)))}}function draggable(element,onmove,onstart,onstop){function prevent(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function move(e){if(dragging){if(IE&&doc.documentMode<9&&!e.button)return stop();var t0=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0],pageX=t0&&t0.pageX||e.pageX,pageY=t0&&t0.pageY||e.pageY,dragX=Math.max(0,Math.min(pageX-offset.left,maxWidth)),dragY=Math.max(0,Math.min(pageY-offset.top,maxHeight));hasTouch&&prevent(e),onmove.apply(element,[dragX,dragY,e])}}function start(e){(e.which?3==e.which:2==e.button)||dragging||!1!==onstart.apply(element,arguments)&&(dragging=!0,maxHeight=$(element).height(),maxWidth=$(element).width(),offset=$(element).offset(),$(doc).bind(duringDragEvents),$(doc.body).addClass("sp-dragging"),move(e),prevent(e))}function stop(){dragging&&($(doc).unbind(duringDragEvents),$(doc.body).removeClass("sp-dragging"),setTimeout(function(){onstop.apply(element,arguments)},0)),dragging=!1}onmove=onmove||function(){},onstart=onstart||function(){},onstop=onstop||function(){};var doc=document,dragging=!1,offset={},maxHeight=0,maxWidth=0,hasTouch="ontouchstart"in window,duringDragEvents={};duringDragEvents.selectstart=prevent,duringDragEvents.dragstart=prevent,duringDragEvents["touchmove mousemove"]=move,duringDragEvents["touchend mouseup"]=stop,$(element).bind("touchstart mousedown",start)}function throttle(func,wait,debounce){var timeout;return function(){var context=this,args=arguments,throttler=function(){timeout=null,func.apply(context,args)};debounce&&clearTimeout(timeout),!debounce&&timeout||(timeout=setTimeout(throttler,wait))}}function inputTypeColorSupport(){return $.fn.spectrum.inputTypeColorSupport()}var defaultOpts={beforeShow:noop,move:noop,change:noop,show:noop,hide:noop,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},spectrums=[],IE=!!/msie/i.exec(window.navigator.userAgent),rgbaSupport=function(){function contains(str,substr){return!!~(""+str).indexOf(substr)}var elem=document.createElement("div"),style=elem.style;return style.cssText="background-color:rgba(0,0,0,.5)",contains(style.backgroundColor,"rgba")||contains(style.backgroundColor,"hsla")}(),replaceInput=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),markup=function(){var gradientFix="";if(IE)for(var i=1;i<=6;i++)gradientFix+="<div class='sp-"+i+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",gradientFix,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();$.fn.spectrum=function(opts,extra){if("string"==typeof opts){var returnValue=this,args=Array.prototype.slice.call(arguments,1);return this.each(function(){var spect=spectrums[$(this).data("spectrum.id")];if(spect){var method=spect[opts];if(!method)throw new Error("Spectrum: no such method: '"+opts+"'");"get"==opts?returnValue=spect.get():"container"==opts?returnValue=spect.container:"option"==opts?returnValue=spect.option.apply(spect,args):"destroy"==opts?(spect.destroy(),$(this).removeData("spectrum.id")):method.apply(spect,args)}}),returnValue}return this.spectrum("destroy").each(function(){var options=$.extend({},opts,$(this).data()),spect=spectrum(this,options);$(this).data("spectrum.id",spect.id)})},$.fn.spectrum.load=!0,$.fn.spectrum.loadOpts={},$.fn.spectrum.draggable=draggable,$.fn.spectrum.defaults=defaultOpts,$.fn.spectrum.inputTypeColorSupport=function inputTypeColorSupport(){if(void 0===inputTypeColorSupport._cachedResult){var colorInput=$("<input type='color'/>")[0];inputTypeColorSupport._cachedResult="color"===colorInput.type&&""!==colorInput.value}return inputTypeColorSupport._cachedResult},$.spectrum={},$.spectrum.localization={},$.spectrum.palettes={},$.fn.spectrum.processNativeColorInputs=function(){var colorInputs=$("input[type=color]");colorInputs.length&&!inputTypeColorSupport()&&colorInputs.spectrum({preferredFormat:"hex6"})},function(){function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,ok=!1,format=!1;return"string"==typeof color&&(color=stringInputToObject(color)),"object"==typeof color&&(color.hasOwnProperty("r")&&color.hasOwnProperty("g")&&color.hasOwnProperty("b")?(rgb=rgbToRgb(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("v")?(color.s=convertToPercentage(color.s),color.v=convertToPercentage(color.v),rgb=hsvToRgb(color.h,color.s,color.v),ok=!0,format="hsv"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("l")&&(color.s=convertToPercentage(color.s),color.l=convertToPercentage(color.l),rgb=hslToRgb(color.h,color.s,color.l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a)),a=boundAlpha(a),{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,l:l}}function hslToRgb(h,s,l){function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var r,g,b;if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,v:v}}function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6;return{r:255*[v,q,p,p,t,v][mod],g:255*[t,v,v,q,p,p][mod],b:255*[p,p,t,v,v,q][mod]}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToHex(r,g,b,a){return[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))].join("")}function desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(-amount/100*255))),rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(-amount/100*255))),rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(-amount/100*255))),tinycolor(rgb)}function darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(mathRound(hsl.h)+amount)%360;return hsl.h=hue<0?360+hue:hue,tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h:h,s:s,v:v})),v=(v+modification)%1;return ret}function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function bound01(n,max){isOnePointZero(n)&&(n="100%");var processPercent=isPercentage(n);return n=mathMin(max,mathMax(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function isOnePointZero(n){return"string"==typeof n&&-1!=n.indexOf(".")&&1===parseFloat(n)}function isPercentage(n){return"string"==typeof n&&-1!=n.indexOf("%")}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return n<=1&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};var match;return(match=matchers.rgb.exec(color))?{r:match[1],g:match[2],b:match[3]}:(match=matchers.rgba.exec(color))?{r:match[1],g:match[2],b:match[3],a:match[4]}:(match=matchers.hsl.exec(color))?{h:match[1],s:match[2],l:match[3]}:(match=matchers.hsla.exec(color))?{h:match[1],s:match[2],l:match[3],a:match[4]}:(match=matchers.hsv.exec(color))?{h:match[1],s:match[2],v:match[3]}:(match=matchers.hsva.exec(color))?{h:match[1],s:match[2],v:match[3],a:match[4]}:(match=matchers.hex8.exec(color))?{a:convertHexToDecimal(match[1]),r:parseIntFromHex(match[2]),g:parseIntFromHex(match[3]),b:parseIntFromHex(match[4]),format:named?"name":"hex8"}:(match=matchers.hex6.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"}:!!(match=matchers.hex3.exec(color))&&{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"}}var trimLeft=/^[\s,#]+/,trimRight=/\s+$/,tinyCounter=0,math=Math,mathRound=math.round,mathMin=math.min,mathMax=math.max,mathRandom=math.random,tinycolor=function(color,opts){if(color=color||"",opts=opts||{},color instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=inputToRGB(color);this._originalInput=color,this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=mathRound(this._r)),this._g<1&&(this._g=mathRound(this._g)),this._b<1&&(this._b=mathRound(this._b)),this._ok=rgb.ok,this._tc_id=tinyCounter++};tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},setAlpha:function(value){return this._a=boundAlpha(value),this._roundA=mathRound(100*this._a)/100,this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b),h=mathRound(360*hsv.h),s=mathRound(100*hsv.s),v=mathRound(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b),h=mathRound(360*hsl.h),s=mathRound(100*hsl.s),l=mathRound(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(){return rgbaToHex(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(100*bound01(this._r,255))+"%",g:mathRound(100*bound01(this._g,255))+"%",b:mathRound(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%)":"rgba("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(secondColor){var hex8String="#"+rgbaToHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){secondHex8String=tinycolor(secondColor).toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0;return formatSet||!hasAlpha||"hex"!==format&&"hex6"!==format&&"hex3"!==format&&"name"!==format?("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),"hex"!==format&&"hex6"!==format||(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString()):"name"===format&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(color,opts){if("object"==typeof color){var newColor={};for(var i in color)color.hasOwnProperty(i)&&(newColor[i]="a"===i?color[i]:convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return!(!color1||!color2)&&tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var w1,rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100,w=2*p-1,a=rgb2.a-rgb1.a;w1=w*a==-1?w:(w+a)/(1+w*a),w1=(w1+1)/2;var w2=1-w1,rgba={r:rgb2.r*w1+rgb1.r*w2,g:rgb2.g*w1+rgb1.g*w2,b:rgb2.b*w1+rgb1.b*w2,a:rgb2.a*p+rgb1.a*(1-p)};return tinycolor(rgba)},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2),rgb1=c1.toRgb(),rgb2=c2.toRgb(),brightnessA=c1.getBrightness(),brightnessB=c2.getBrightness(),colorDiff=Math.max(rgb1.r,rgb2.r)-Math.min(rgb1.r,rgb2.r)+Math.max(rgb1.g,rgb2.g)-Math.min(rgb1.g,rgb2.g)+Math.max(rgb1.b,rgb2.b)-Math.min(rgb1.b,rgb2.b);return{brightness:Math.abs(brightnessA-brightnessB),color:colorDiff}},tinycolor.isReadable=function(color1,color2){var readability=tinycolor.readability(color1,color2);return readability.brightness>125&&readability.color>500},tinycolor.mostReadable=function(baseColor,colorList){for(var bestColor=null,bestScore=0,bestIsReadable=!1,i=0;i<colorList.length;i++){var readability=tinycolor.readability(baseColor,colorList[i]),readable=readability.brightness>125&&readability.color>500,score=readability.brightness/125*3+readability.color/500;(readable&&!bestIsReadable||readable&&bestIsReadable&&score>bestScore||!readable&&!bestIsReadable&&score>bestScore)&&(bestIsReadable=readable,bestScore=score,bestColor=tinycolor(colorList[i]))}return bestColor};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=function(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}(names),matchers=function(){var CSS_UNIT="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=tinycolor}(),$(function(){$.fn.spectrum.load&&$.fn.spectrum.processNativeColorInputs()})})},482:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(4),__webpack_require__(5),__webpack_require__(19),__webpack_require__(271)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,_,jQuery,BL,interact){BL.ContainerDropZoneBehavior=Marionette.Behavior.extend({defaults:{columnLimit:3},onRender:function(){_.isObject(this.view.options.renderOptions)&&!0===this.view.options.renderOptions.disableDragAndDrop||this.addDropZone()},addDropZone:function(){var acceptableElementSelector,that=this,view=this.view,domElement=that.$el.get(0);if(0===this.view.renderOptions.depth)acceptableElementSelector=".mailpoet_droppable_block.mailpoet_droppable_layout_block";else{if(2!==this.view.renderOptions.depth)return;acceptableElementSelector=".mailpoet_droppable_block:not(.mailpoet_droppable_layout_block)"}interact(domElement).dropzone({accept:acceptableElementSelector,overlap:"pointer",ondragenter:function(){view.$el.addClass("mailpoet_drop_active")},ondragleave:function(){that.cleanup()},ondropmove:function(event){var marker,targetModel,targetView,targetElement,topOffset,leftOffset,isLastBlockInsertion,$targetBlock,margin,dropPosition=that.getDropPosition(event.dragmove.pageX,event.dragmove.pageY,view.$el,view.model.get("orientation"),view.model.get("blocks").length),element=view.$el,markerWidth="",markerHeight="",containerOffset=element.offset(),viewCollection=that.getCollection();void 0!==dropPosition&&(element.find(".mailpoet_drop_marker").remove(),viewCollection.isEmpty()||(0===viewCollection.length?(targetElement=element.find(view.childViewContainer),topOffset=targetElement.offset().top-element.offset().top,leftOffset=targetElement.offset().left-element.offset().left,markerWidth=targetElement.width(),markerHeight=targetElement.height()):(isLastBlockInsertion=that.getCollection().length===dropPosition.index,targetModel=isLastBlockInsertion?viewCollection.at(dropPosition.index-1):viewCollection.at(dropPosition.index),targetView=that.getChildren().findByModel(targetModel),targetElement=targetView.$el,topOffset=targetElement.offset().top-containerOffset.top,leftOffset=targetElement.offset().left-containerOffset.left,"normal"===dropPosition.insertionType?("after"===dropPosition.position&&("vertical"===view.model.get("orientation")?topOffset+=targetElement.outerHeight(!0):leftOffset+=targetElement.outerWidth()),"vertical"===view.model.get("orientation")?markerWidth=targetElement.outerWidth():markerHeight=targetElement.outerHeight()):("after"===dropPosition.position&&("vertical"===view.model.get("orientation")?leftOffset+=targetElement.outerWidth():topOffset+=targetElement.outerHeight()),"vertical"===view.model.get("orientation")?markerHeight=targetElement.outerHeight(!0):markerWidth=targetElement.outerWidth(!0))),marker=jQuery('<div class="mailpoet_drop_marker"></div>'),0===dropPosition.index&&marker.addClass("mailpoet_drop_marker_first"),viewCollection.length-1===dropPosition.index&&marker.addClass("mailpoet_drop_marker_last"),dropPosition.index>0&&viewCollection.length-1>dropPosition.index&&marker.addClass("mailpoet_drop_marker_middle"),marker.addClass("mailpoet_drop_marker_"+dropPosition.position),$targetBlock="before"===dropPosition.position?that.getChildren().findByModel(viewCollection.at(dropPosition.index-1)).$el:that.getChildren().findByModel(viewCollection.at(dropPosition.index)).$el,margin=$targetBlock.outerHeight(!0)-$targetBlock.outerHeight(),marker.css("top",topOffset-margin/2),marker.css("left",leftOffset),marker.css("width",markerWidth),marker.css("height",markerHeight),element.append(marker)))},ondrop:function(event){var droppedView,index,tempCollection,tempCollection2,tempModel,dropPosition=that.getDropPosition(event.dragEvent.pageX,event.dragEvent.pageY,view.$el,view.model.get("orientation"),view.model.get("blocks").length),droppableModel=event.draggable.getDropModel(),viewCollection=that.getCollection();void 0!==dropPosition&&("normal"===dropPosition.insertionType?(index="after"===dropPosition.position?dropPosition.index+1:dropPosition.index,"horizontal"===view.model.get("orientation")&&"container"!==droppableModel.get("type")?(tempCollection=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"}),tempCollection.get("blocks").add(droppableModel),viewCollection.add(tempCollection,{at:index})):viewCollection.add(droppableModel,{at:index}),droppedView=that.getChildren().findByModel(droppableModel)):(tempModel=viewCollection.at(dropPosition.index),tempCollection=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"===view.model.get("orientation")?"horizontal":"vertical"}),viewCollection.remove(tempModel),"horizontal"===tempCollection.get("orientation")?("before"===dropPosition.position&&(tempCollection2=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"}),tempCollection2.get("blocks").add(droppableModel),tempCollection.get("blocks").add(tempCollection2)),tempCollection2=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"}),tempCollection2.get("blocks").add(tempModel),tempCollection.get("blocks").add(tempCollection2),"after"===dropPosition.position&&(tempCollection2=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"}),tempCollection2.get("blocks").add(droppableModel),tempCollection.get("blocks").add(tempCollection2))):("before"===dropPosition.position&&tempCollection.get("blocks").add(droppableModel),tempCollection.get("blocks").add(tempModel),"after"===dropPosition.position&&tempCollection.get("blocks").add(droppableModel)),viewCollection.add(tempCollection,{at:dropPosition.index}),droppedView=that.getChildren().findByModel(tempCollection).children.findByModel(droppableModel)),event.draggable.onDrop({dropBehavior:that,droppedModel:droppableModel,droppedView:droppedView}),that.cleanup())}})},cleanup:function(){this.view.$el.removeClass("mailpoet_drop_active"),this.view.$(".mailpoet_drop_marker").remove()},getDropPosition:function(eventX,eventY,isUnsafe){var relativeOffset,elementLength,insertionType,index,position,indexAndPosition,SPECIAL_AREA_INSERTION_WIDTH=0,element=this.view.$el,orientation=this.view.model.get("orientation"),elementOffset=element.offset(),elementPageX=elementOffset.left,elementPageY=elementOffset.top,elementWidth=element.outerWidth(!0),elementHeight=element.outerHeight(!0),relativeX=eventX-elementPageX,relativeY=eventY-elementPageY,canAcceptNormalInsertion=this._canAcceptNormalInsertion(),canAcceptSpecialInsertion=this._canAcceptSpecialInsertion(),unsafe=!!isUnsafe;return 0===this.getCollection().length?{insertionType:"normal",index:0,position:"inside"}:("vertical"===orientation?(relativeOffset=relativeX,elementLength=elementWidth):(relativeOffset=relativeY,elementLength=elementHeight),canAcceptSpecialInsertion&&!canAcceptNormalInsertion&&(SPECIAL_AREA_INSERTION_WIDTH=.5),relativeOffset<=elementLength*SPECIAL_AREA_INSERTION_WIDTH&&(unsafe||canAcceptSpecialInsertion)?(insertionType="special",position="before",index=this._computeSpecialIndex(eventX,eventY)):relativeOffset>elementLength*(1-SPECIAL_AREA_INSERTION_WIDTH)&&(unsafe||canAcceptSpecialInsertion)?(insertionType="special",position="after",index=this._computeSpecialIndex(eventX,eventY)):(indexAndPosition=this._computeNormalIndex(eventX,eventY),insertionType="normal",position=indexAndPosition.position,index=indexAndPosition.index),unsafe||"vertical"!==orientation||"special"!==insertionType||"horizontal"!==this.getCollection().at(index).get("orientation")||(indexAndPosition=this._computeNormalIndex(eventX,eventY),insertionType="normal",position=indexAndPosition.position,index=indexAndPosition.index),"horizontal"!==orientation||"special"!==insertionType?{insertionType:insertionType,index:index,position:position}:void 0)},_computeNormalIndex:function(eventX,eventY){var eventOffset,closeOffset,elementDimension,index=this._computeCellIndex(eventX,eventY),targetView=this.getChildren().findByModel(this.getCollection().at(index)),orientation=this.view.model.get("orientation"),element=targetView.$el;return"vertical"===orientation?(eventOffset=eventY,closeOffset=element.offset().top,elementDimension=element.outerHeight(!0)):(eventOffset=eventX,closeOffset=element.offset().left,elementDimension=element.outerWidth(!0)),eventOffset<=closeOffset+elementDimension/2?{index:index,position:"before"}:{index:index,position:"after"}},_computeSpecialIndex:function(eventX,eventY){return this._computeCellIndex(eventX,eventY)},_computeCellIndex:function(eventX,eventY){var orientation=this.view.model.get("orientation"),eventOffset="vertical"===orientation?eventY:eventX,resultView=this.getChildren().find(function(view){var closeOffset,farOffset,element=view.$el;return"vertical"===orientation?(closeOffset=element.offset().top,farOffset=element.outerHeight(!0)):(closeOffset=element.offset().left,farOffset=element.outerWidth(!0)),farOffset+=closeOffset,closeOffset<=eventOffset&&eventOffset<=farOffset});return"object"==typeof resultView?resultView._index:0},_canAcceptNormalInsertion:function(){var orientation=this.view.model.get("orientation"),depth=this.view.renderOptions.depth,childCount=this.getChildren().length;return"vertical"===orientation||"horizontal"===orientation&&1===depth&&childCount<this.options.columnLimit},_canAcceptSpecialInsertion:function(){var orientation=this.view.model.get("orientation"),depth=this.view.renderOptions.depth,childCount=this.getChildren().length;return 0===depth||1===depth&&"horizontal"===orientation&&childCount<=this.options.columnLimit},getCollectionView:function(){return this.view.getChildView("blocks")},getChildren:function(){return this.getCollectionView().children},getCollection:function(){return this.getCollectionView().collection}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},483:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(4),__webpack_require__(5),__webpack_require__(19),__webpack_require__(271)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,_,jQuery,BehaviorsLookup,interact){BehaviorsLookup.DraggableBehavior=Marionette.Behavior.extend({defaults:{cloneOriginal:!1,hideOriginal:!1,ignoreSelector:".mailpoet_ignore_drag, .mailpoet_ignore_drag *",onDragSubstituteBy:void 0,getDropModel:function(){throw new Error("Missing 'drop' function for DraggableBehavior")},onDrop:function(){},testAttachToInstance:function(){return!0}},onRender:function(){var interactable,that=this;this.options.testAttachToInstance(this.view.model,this.view)&&(interactable=interact(this.$el.get(0),{ignoreFrom:this.options.ignoreSelector}).draggable({max:1/0,autoScroll:!0,onstart:function(startEvent){var centerXOffset,centerYOffset,tempClone,clone,$clone,event=startEvent;!0===that.options.cloneOriginal&&(_.isFunction(that.options.onDragSubstituteBy)&&(tempClone=that.options.onDragSubstituteBy(that)),clone=tempClone||event.target.cloneNode(!0),jQuery(event.target),$clone=jQuery(clone),$clone.addClass("mailpoet_droppable_active"),$clone.css("position","absolute"),$clone.css("top",0),$clone.css("left",0),document.body.appendChild(clone),centerXOffset=$clone.width()/2,centerYOffset=$clone.height()/2,$clone.css("top",event.pageY-centerYOffset),$clone.css("left",event.pageX-centerXOffset),event.interaction.element=clone,!0===that.options.hideOriginal&&that.view.$el.addClass("mailpoet_hidden"))},onmove:function(event){var target=event.target,x=(parseFloat(target.getAttribute("data-x"))||0)+event.dx,y=(parseFloat(target.getAttribute("data-y"))||0)+event.dy;target.style.transform="translate("+x+"px, "+y+"px)",target.style.webkitTransform=target.style.transform,target.setAttribute("data-x",x),target.setAttribute("data-y",y)},onend:function(event){var target=event.target;target.style.transform="",target.style.webkitTransform=target.style.transform,target.removeAttribute("data-x"),target.removeAttribute("data-y"),jQuery(event.interaction.element).addClass("mailpoet_droppable_active"),!0===that.options.cloneOriginal&&(jQuery(target).remove(),!0===that.options.hideOriginal&&that.view.$el.removeClass("mailpoet_hidden"))}}).preventDefault("auto").styleCursor(!1).actionChecker(function(pointer,event,action){return 0!==event.button?null:action}),void 0!==this.options.drop?interactable.getDropModel=this.options.drop:interactable.getDropModel=this.view.getDropFunc(),interactable.onDrop=function(opts){var options=opts;_.isObject(options)&&(options.dragBehavior=that),that.options.onDrop.apply(that,[options])})}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},484:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(19)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,BehaviorsLookup){BehaviorsLookup.HighlightContainerBehavior=Marionette.Behavior.extend({events:{"mouseenter @ui.tools":"enableHighlight","mouseleave @ui.tools":"disableHighlight"},enableHighlight:function(){this.$el.addClass("mailpoet_highlight")},disableHighlight:function(){this.view._isBeingEdited||this.$el.removeClass("mailpoet_highlight")}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},485:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(19)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,BehaviorsLookup){BehaviorsLookup.HighlightEditingBehavior=Marionette.Behavior.extend({modelEvents:{startEditing:"enableHighlight",stopEditing:"disableHighlight"},enableHighlight:function(){this.view._isBeingEdited=!0,this.$el.addClass("mailpoet_highlight")},disableHighlight:function(){this.view._isBeingEdited=!1,this.$el.removeClass("mailpoet_highlight")}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},486:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(4),__webpack_require__(19),__webpack_require__(5)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,_,BehaviorsLookup,jQuery){BehaviorsLookup.MediaManagerBehavior=Marionette.Behavior.extend({ui:{"select-image":".mailpoet_field_image_select_image","address-input":".mailpoet_field_image_address"},events:{"click @ui.select-image":"showMediaManager","input @ui.address-input":"changeAddress"},initialize:function(){this.view.options.showImageManager&&this.showMediaManager()},changeAddress:function(event){var src=jQuery(event.target).val(),image=new Image;if(!src&&this.options.onSelect)return void this.view[this.options.onSelect]({src:null,width:null,height:null});image.onload=function(){this.options.onSelect&&this.view[this.options.onSelect]({src:src,width:image.naturalWidth+"px",height:image.naturalHeight+"px"})}.bind(this),image.src=src},showMediaManager:function(){var MediaManager,theFrame,that=this;if(this._mediaManager)return this._mediaManager.resetSelections(),void this._mediaManager.open();MediaManager=window.wp.media.view.MediaFrame.Select.extend({initialize:function(){window.wp.media.view.MediaFrame.prototype.initialize.apply(this,arguments),_.defaults(this.options,{multiple:!0,editing:!1,state:"insert"}),this.createSelection(),this.createStates(),this.bindHandlers(),this.createIframeStates(),this.$el.addClass("hide-title")},resetSelections:function(){this.state().get("selection").reset()},createQuery:function(options){return window.wp.media.query(options)},createStates:function(){var options=this.options;this.states.add([new window.wp.media.controller.Library({id:"insert",title:"Add images",priority:20,toolbar:"main-insert",filterable:"image",library:this.createQuery(options.library),multiple:!!options.multiple&&"reset",editable:!1,allowLocalEdits:!1,displaySettings:!1,displayUserSettings:!1})]),window.wp.media.view.settings.post.featuredImageId&&this.states.add(new window.wp.media.controller.FeaturedImage)},bindHandlers:function(){var handlers;this.on("router:create:browse",this.createRouter,this),this.on("router:render:browse",this.browseRouter,this),this.on("content:create:browse",this.browseContent,this),this.on("content:render:upload",this.uploadContent,this),this.on("toolbar:create:select",this.createSelectToolbar,this),this.on("menu:create:gallery",this.createMenu,this),this.on("toolbar:create:main-insert",this.createToolbar,this),this.on("toolbar:create:main-gallery",this.createToolbar,this),this.on("toolbar:create:main-embed",this.mainEmbedToolbar,this),this.on("updateExcluded",this.browseContent,this),handlers={content:{embed:"embedContent","edit-selection":"editSelectionContent"},toolbar:{"main-insert":"mainInsertToolbar"}},_.each(handlers,function(regionHandlers,region){_.each(regionHandlers,function(callback,handler){this.on(region+":render:"+handler,this[callback],this)},this)},this)},uploadContent:function(){window.wp.media.view.MediaFrame.Select.prototype.uploadContent.apply(this,arguments),this.$el.addClass("hide-toolbar")},embedContent:function(){var view=new window.wp.media.view.Embed({controller:this,model:this.state()}).render();this.content.set(view),view.url.focus()},editSelectionContent:function(){var view,state=this.state(),selection=state.get("selection");view=new window.wp.media.view.AttachmentsBrowser({controller:this,collection:selection,selection:selection,model:state,sortable:!0,search:!1,dragInfo:!0,AttachmentView:window.wp.media.view.Attachment.EditSelection}).render(),view.toolbar.set("backToLibrary",{text:"Return to library",priority:-100,click:function(){this.controller.content.mode("browse")}}),this.content.set(view)},selectionStatusToolbar:function(view){var editable=this.state().get("editable");view.set("selection",new window.wp.media.view.Selection({controller:this,collection:this.state().get("selection"),priority:-40,editable:editable&&function(){this.controller.content.mode("edit-selection")}}).render())},mainInsertToolbar:function(view){var controller=this;this.selectionStatusToolbar(view),view.set("insert",{style:"primary",priority:80,text:"Select Image",requires:{selection:!0},click:function(){var state=controller.state(),selection=state.get("selection");controller.close(),state.trigger("insert",selection).reset()}})},mainEmbedToolbar:function(toolbar){toolbar.view=new window.wp.media.view.Toolbar.Embed({controller:this,text:"Add images"})}}),theFrame=new MediaManager({id:"mailpoet-media-manager",frame:"select",title:"Select image",editing:!1,multiple:!1,library:{type:"image"},displaySettings:!1,button:{text:"Select"}}),this._mediaManager=theFrame,this._mediaManager.on("insert",function(){theFrame.state().get("selection").each(function(attachment){var sizes=attachment.get("sizes"),increasingByWidthDifference=_.sortBy(_.keys(sizes),function(size){return Math.abs(1320-sizes[size].width)}),bestWidth=sizes[_.first(increasingByWidthDifference)].width,imagesOfBestWidth=_.filter(_.values(sizes),function(size){return size.width===bestWidth}),mainSize=_.max(imagesOfBestWidth,function(size){return size.height});that.options.onSelect&&that.view[that.options.onSelect]({height:mainSize.height+"px",width:mainSize.width+"px",src:mainSize.url,alt:""!==attachment.get("alt")&&void 0!==attachment.get("alt")?attachment.get("alt"):attachment.get("title")})})}),this._mediaManager.open()},onBeforeDestroy:function(){"object"==typeof this._mediaManager&&this._mediaManager.remove()}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},487:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(19),__webpack_require__(271)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,BehaviorsLookup,interact){BehaviorsLookup.ResizableBehavior=Marionette.Behavior.extend({defaults:{elementSelector:null,resizeHandleSelector:!0,transformationFunction:function(y){return y},minLength:0,maxLength:1/0,modelField:"styles.block.height",onResize:function(event){var currentLength=parseFloat(this.view.model.get(this.options.modelField)),newLength=currentLength+this.options.transformationFunction(event.dy);newLength=Math.min(this.options.maxLength,Math.max(this.options.minLength,newLength)),this.view.model.set(this.options.modelField,newLength+"px")}},events:{mouseenter:"showResizeHandle",mouseleave:"hideResizeHandle"},onRender:function(){this.attachResize(),!0!==this.isBeingResized&&this.hideResizeHandle()},attachResize:function(){var domElement,that=this;domElement=null===this.options.elementSelector?this.view.$el.get(0):this.view.$(this.options.elementSelector).get(0),interact(domElement).resizable({edges:{top:!1,left:!1,right:!1,bottom:"string"==typeof this.options.resizeHandleSelector?this.view.$(this.options.resizeHandleSelector).get(0):this.options.resizeHandleSelector}}).on("resizestart",function(){that.isBeingResized=!0,that.$el.addClass("mailpoet_resize_active")}).on("resizemove",function(event){return that.options.onResize.bind(that)(event)}).on("resizeend",function(){that.isBeingResized=null,that.$el.removeClass("mailpoet_resize_active")})},showResizeHandle:function(){"string"==typeof this.options.resizeHandleSelector&&this.view.$(this.options.resizeHandleSelector).removeClass("mailpoet_hidden")},hideResizeHandle:function(){"string"==typeof this.options.resizeHandleSelector&&this.view.$(this.options.resizeHandleSelector).addClass("mailpoet_hidden")}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},488:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(4),__webpack_require__(19)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,_,BehaviorsLookup){BehaviorsLookup.SortableBehavior=Marionette.Behavior.extend({onRender:function(){var collection=this.view.collection;_.isFunction(this.$el.sortable)&&this.$el.sortable({cursor:"move",start:function(event,ui){ui.item.data("previousIndex",ui.item.index())},end:function(event,ui){ui.item.removeData("previousIndex")},update:function(event,ui){var previousIndex=ui.item.data("previousIndex"),newIndex=ui.item.index(),model=collection.at(previousIndex);collection.remove(model),collection.add(model,{at:newIndex})},items:this.options.items})}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},489:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(5),__webpack_require__(19)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,jQuery,BehaviorsLookup){BehaviorsLookup.ShowSettingsBehavior=Marionette.Behavior.extend({defaults:{ignoreFrom:""},events:{"click .mailpoet_content":"showSettings"},showSettings:function(event){this.isIgnoredElement(event.target)||this.view.triggerMethod("showSettings")},isIgnoredElement:function(element){return this.options.ignoreFrom&&this.options.ignoreFrom.length>0&&jQuery(element).is(this.options.ignoreFrom)}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},490:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10),__webpack_require__(4),__webpack_require__(19)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Marionette,_,BehaviorsLookup){BehaviorsLookup.TextEditorBehavior=Marionette.Behavior.extend({defaults:{selector:".mailpoet_content",toolbar1:"bold italic link unlink forecolor mailpoet_shortcodes",toolbar2:"",validElements:"p[class|style],span[class|style],a[href|class|title|target|style],strong[class|style],em[class|style],strike,br",invalidElements:"script",blockFormats:"Paragraph=p",plugins:"link textcolor colorpicker mailpoet_shortcodes",configurationFilter:function(originalConfig){return originalConfig}},onDomRefresh:function(){var that=this;!0!==this.view.disableTextEditor&&this.$(this.options.selector).tinymce(this.options.configurationFilter({inline:!0,menubar:!1,toolbar1:this.options.toolbar1,toolbar2:this.options.toolbar2,browser_spellcheck:!0,valid_elements:this.options.validElements,invalid_elements:this.options.invalidElements,block_formats:this.options.blockFormats,relative_urls:!1,remove_script_host:!1,convert_urls:!0,urlconverter_callback:function(url){return url.match(/\[.+\]/g)?url:this.documentBaseURI.toAbsolute(url,this.settings.remove_script_host)},plugins:this.options.plugins,setup:function(editor){editor.on("change",function(){that.view.triggerMethod("text:editor:change",editor.getContent())}),editor.on("click",function(e){editor.focus(),that._isActivationClick&&(editor.selection.setRng(window.tinymce.dom.RangeUtils.getCaretRangeFromPoint(e.clientX,e.clientY,editor.getDoc())),that._isActivationClick=!1)}),editor.on("focus",function(){that.view.triggerMethod("text:editor:focus"),that._isActivationClick=!0}),editor.on("blur",function(){that.view.triggerMethod("text:editor:blur")})}}))}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},491:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(18),__webpack_require__(10),__webpack_require__(4),__webpack_require__(5),__webpack_require__(9),__webpack_require__(16)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Backbone,Marionette,_,jQuery,App,BaseBlock){"use strict";var BlockCollection,Module={},base=BaseBlock;return BlockCollection=Backbone.Collection.extend({model:base.BlockModel,initialize:function(){this.on("add change remove",function(){App.getChannel().trigger("autoSave")})},parse:function(response){return _.map(response,function(block){return new(App.getBlockTypeModel(block.type))(block,{parse:!0})})}}),Module.ContainerBlockModel=base.BlockModel.extend({relations:{blocks:BlockCollection},defaults:function(){return this._getDefaults({type:"container",columnLayout:!1,orientation:"vertical",image:{src:null,display:"scale"},styles:{block:{backgroundColor:"transparent"}},blocks:new BlockCollection},App.getConfig().get("blockDefaults.container"))},_updateDefaults:function(){},validate:function(){var invalidBlock=this.get("blocks").find(function(block){return!block.isValid()});if(invalidBlock)return invalidBlock.validationError},parse:function(response){return"container"===response.type&&_.has(response,"blocks")&&response.blocks.constructor===Array&&(response.blocks=new BlockCollection(response.blocks,{parse:!0})),response},getChildren:function(){var models=this.get("blocks").map(function(model){return[model,model.getChildren()]});return _.flatten(models)}}),Module.ContainerBlocksView=Marionette.CollectionView.extend({className:"mailpoet_container",childView:function(model){return App.getBlockTypeView(model.get("type"))},childViewOptions:function(){var newRenderOptions=_.clone(this.renderOptions);return void 0!==newRenderOptions.depth&&(newRenderOptions.depth+=1),{renderOptions:newRenderOptions}},emptyView:function(){return Module.ContainerBlockEmptyView},emptyViewOptions:function(){return{renderOptions:this.renderOptions}},initialize:function(options){this.renderOptions=options.renderOptions}}),Module.ContainerBlockView=base.BlockView.extend({regions:_.extend({},base.BlockView.prototype.regions,{blocks:{el:"> .mailpoet_container",replaceElement:!0}}),className:"mailpoet_block mailpoet_container_block mailpoet_droppable_block mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.containerBlock},events:_.extend({},base.BlockView.prototype.events,{"click .mailpoet_newsletter_layer_selector":"toggleEditingLayer"}),ui:{tools:"> .mailpoet_tools"},behaviors:_.extend({},base.BlockView.prototype.behaviors,{ContainerDropZoneBehavior:{},DraggableBehavior:{cloneOriginal:!0,hideOriginal:!0,onDrop:function(options){options.dragBehavior.view.model.destroy()},onDragSubstituteBy:function(behavior){var WidgetView,node;if(_.isFunction(behavior.view.onDragSubstituteBy))return WidgetView=new(behavior.view.onDragSubstituteBy()),WidgetView.render(),node=WidgetView.$el.get(0).cloneNode(!0),WidgetView.destroy(),node},testAttachToInstance:function(model,view){return 1===view.renderOptions.depth}},HighlightContainerBehavior:{}}),onDragSubstituteBy:function(){if(1===this.renderOptions.depth){if(3===this.model.get("blocks").length)return Module.ThreeColumnContainerWidgetView;if(2===this.model.get("blocks").length)return Module.TwoColumnContainerWidgetView}return Module.OneColumnContainerWidgetView},initialize:function(options){base.BlockView.prototype.initialize.apply(this,arguments),this.renderOptions=_.defaults(options.renderOptions||{},{})},onRender:function(){var columnLayout,classIrregular="";this.toolsView=new Module.ContainerBlockToolsView({model:this.model,tools:{settings:1===this.renderOptions.depth,delete:1===this.renderOptions.depth,duplicate:!0,move:1===this.renderOptions.depth,layerSelector:!1}}),this.showChildView("toolsRegion",this.toolsView),this.showChildView("blocks",new Module.ContainerBlocksView({collection:this.model.get("blocks"),renderOptions:this.renderOptions})),columnLayout=this.model.get("columnLayout"),"string"==typeof columnLayout&&(classIrregular="mailpoet_irregular_width_contents_container column_layout_"+columnLayout),this.$("> .mailpoet_container").attr("class","mailpoet_container mailpoet_container_"+this.model.get("orientation")+" "+classIrregular)},showTools:function(){1!==this.renderOptions.depth||this.$el.hasClass("mailpoet_container_layer_active")||(this.$(this.ui.tools).addClass("mailpoet_display_tools"),this.toolsView.triggerMethod("showTools"))},hideTools:function(){1!==this.renderOptions.depth||this.$el.hasClass("mailpoet_container_layer_active")||(this.$(this.ui.tools).removeClass("mailpoet_display_tools"),this.toolsView.triggerMethod("hideTools"))},toggleEditingLayer:function(event){var that=this,$toggleButton=this.$("> .mailpoet_tools .mailpoet_newsletter_layer_selector"),$overlay=jQuery(".mailpoet_layer_overlay"),$container=this.$("> .mailpoet_container"),disableContainerLayer=function(){that.$el.removeClass("mailpoet_container_layer_active"),$toggleButton.removeClass("mailpoet_container_layer_active"),$container.removeClass("mailpoet_layer_highlight"),$overlay.hide(),$overlay.off("click")};$toggleButton.hasClass("mailpoet_container_layer_active")?disableContainerLayer():function(){that.$el.addClass("mailpoet_container_layer_active"),$toggleButton.addClass("mailpoet_container_layer_active"),$container.addClass("mailpoet_layer_highlight"),$overlay.click(disableContainerLayer),$overlay.show()}(),event.stopPropagation()}}),Module.ContainerBlockEmptyView=Marionette.View.extend({getTemplate:function(){return window.templates.containerEmpty},initialize:function(options){this.renderOptions=_.defaults(options.renderOptions||{},{})},templateContext:function(){return{isRoot:0===this.renderOptions.depth,emptyContainerMessage:this.renderOptions.emptyContainerMessage||""}}}),Module.ContainerBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.ContainerBlockSettingsView}}),Module.ContainerBlockSettingsView=base.BlockSettingsView.extend({behaviors:_.extend({},base.BlockSettingsView.prototype.behaviors,{MediaManagerBehavior:{onSelect:"onImageSelect"}}),getTemplate:function(){return window.templates.containerBlockSettings},events:function(){return{"change .mailpoet_field_container_background_color":_.partial(this.changeColorField,"styles.block.backgroundColor"),"click .mailpoet_done_editing":"close","change .mailpoet_field_display_type":"changeDisplayType"}},initialize:function(){base.BlockSettingsView.prototype.initialize.apply(this,arguments),this._columnsSettingsView=new Module.ContainerBlockColumnsSettingsView({collection:this.model.get("blocks")})},changeDisplayType:function(event){this.model.get("image").set("display",event.target.value),this.model.trigger("change")},onImageSelect:function(image){this.model.set("image.src",image.src),this.model.trigger("change"),this.render()}}),Module.ContainerBlockColumnsSettingsView=Marionette.CollectionView.extend({childView:function(){return Module.ContainerBlockColumnSettingsView},childViewOptions:function(model,index){return{columnIndex:index}}}),Module.ContainerBlockColumnSettingsView=Marionette.View.extend({getTemplate:function(){return window.templates.containerBlockColumnSettings},initialize:function(options){this.columnNumber=(options.columnIndex||0)+1},templateContext:function(){return{model:this.model.toJSON(),columnNumber:this.columnNumber}}}),Module.OneColumnContainerWidgetView=base.WidgetView.extend({className:base.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.oneColumnLayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.ContainerBlockModel({orientation:"horizontal",blocks:[new Module.ContainerBlockModel]})}}}}),Module.TwoColumnContainerWidgetView=base.WidgetView.extend({className:base.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.twoColumnLayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.ContainerBlockModel({orientation:"horizontal",blocks:[new Module.ContainerBlockModel,new Module.ContainerBlockModel]})}}}}),Module.ThreeColumnContainerWidgetView=base.WidgetView.extend({className:base.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.threeColumnLayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.ContainerBlockModel({orientation:"horizontal",blocks:[new Module.ContainerBlockModel,new Module.ContainerBlockModel,new Module.ContainerBlockModel]})}}}}),Module.TwoColumn12ContainerWidgetView=base.WidgetView.extend({className:base.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.twoColumn12LayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){var block=new Module.ContainerBlockModel({orientation:"horizontal",blocks:[new Module.ContainerBlockModel,new Module.ContainerBlockModel]});return block.set("columnLayout","1_2"),block}}}}),Module.TwoColumn21ContainerWidgetView=base.WidgetView.extend({className:base.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.twoColumn21LayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){var block=new Module.ContainerBlockModel({orientation:"horizontal",blocks:[new Module.ContainerBlockModel,new Module.ContainerBlockModel]});return block.set("columnLayout","2_1"),block}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("container",{blockModel:Module.ContainerBlockModel,blockView:Module.ContainerBlockView}),BeforeStartApp.registerLayoutWidget({name:"oneColumnLayout",priority:100,widgetView:Module.OneColumnContainerWidgetView}),BeforeStartApp.registerLayoutWidget({name:"twoColumnLayout",priority:100,widgetView:Module.TwoColumnContainerWidgetView}),BeforeStartApp.registerLayoutWidget({name:"threeColumnLayout",priority:100,widgetView:Module.ThreeColumnContainerWidgetView}),BeforeStartApp.registerLayoutWidget({name:"twoColumn12Layout",priority:100,widgetView:Module.TwoColumn12ContainerWidgetView}),BeforeStartApp.registerLayoutWidget({name:"twoColumn21Layout",priority:100,widgetView:Module.TwoColumn21ContainerWidgetView})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},492:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(4),__webpack_require__(2),__webpack_require__(5)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,_,MailPoet,jQuery){"use strict";var ImageWidgetView,Module={},base=BaseBlock;return Module.ImageBlockModel=base.BlockModel.extend({defaults:function(){return this._getDefaults({type:"image",link:"",src:"",alt:"An image of...",fullWidth:!0,width:"64px",height:"64px",styles:{block:{textAlign:"center"}}},App.getConfig().get("blockDefaults.image"))},_updateDefaults:function(){}}),Module.ImageBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_image_block mailpoet_droppable_block",getTemplate:function(){return window.templates.imageBlock},onDragSubstituteBy:function(){return Module.ImageWidgetView},templateContext:function(){return _.extend({imageMissingSrc:App.getConfig().get("urls.imageMissing")},base.BlockView.prototype.templateContext.apply(this))},behaviors:_.extend({},base.BlockView.prototype.behaviors,{ResizableBehavior:{elementSelector:".mailpoet_image",resizeHandleSelector:".mailpoet_image_resize_handle",onResize:function(event){var corner=this.$(".mailpoet_image").offset(),width=event.pageX-corner.left;this.view.model.set("width",width+"px")}},ShowSettingsBehavior:{ignoreFrom:".mailpoet_image_resize_handle"}}),onRender:function(){this.toolsView=new Module.ImageBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView),this.model.get("fullWidth")?this.$el.addClass("mailpoet_full_image"):this.$el.removeClass("mailpoet_full_image"),this.$(".mailpoet_content").css("width",this.model.get("width"))}}),Module.ImageBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.ImageBlockSettingsView}}),Module.ImageBlockSettingsView=base.BlockSettingsView.extend({behaviors:_.extend({},base.BlockSettingsView.prototype.behaviors,{MediaManagerBehavior:{onSelect:"onImageSelect"}}),onRender:function(){MailPoet.helpTooltip.show(document.getElementById("tooltip-designer-full-width"),{tooltipId:"tooltip-editor-full-width",tooltip:MailPoet.I18n.t("helpTooltipDesignerFullWidth")}),MailPoet.helpTooltip.show(document.getElementById("tooltip-designer-ideal-width"),{tooltipId:"tooltip-editor-ideal-width",tooltip:MailPoet.I18n.t("helpTooltipDesignerIdealWidth")})},getTemplate:function(){return window.templates.imageBlockSettings},events:function(){return{"input .mailpoet_field_image_link":_.partial(this.changeField,"link"),"input .mailpoet_field_image_alt_text":_.partial(this.changeField,"alt"),"change .mailpoet_field_image_full_width":_.partial(this.changeBoolCheckboxField,"fullWidth"),"change .mailpoet_field_image_alignment":_.partial(this.changeField,"styles.block.textAlign"),"click .mailpoet_done_editing":"close","input .mailpoet_field_image_width":_.partial(this.updateValueAndCall,".mailpoet_field_image_width_input",_.partial(this.changePixelField,"width").bind(this)),"change .mailpoet_field_image_width":_.partial(this.updateValueAndCall,".mailpoet_field_image_width_input",_.partial(this.changePixelField,"width").bind(this)),"input .mailpoet_field_image_width_input":_.partial(this.updateValueAndCall,".mailpoet_field_image_width",_.partial(this.changePixelField,"width").bind(this))}},modelEvents:function(){return{"change:maxWidth":"updateMaxWidth","change:width":"updateWidth"}},updateValueAndCall:function(fieldToUpdate,callable,event){this.$(fieldToUpdate).val(jQuery(event.target).val()),callable(event)},updateMaxWidth:function(){var maxWidth=parseInt(this.model.get("maxWidth"),10);this.$(".mailpoet_field_image_width").attr("max",maxWidth),this.$(".mailpoet_field_image_width_input").attr("max",maxWidth)},updateWidth:function(){var width=parseInt(this.model.get("width"),10);this.$(".mailpoet_field_image_width").val(width),this.$(".mailpoet_field_image_width_input").val(width)},onImageSelect:function(image){null===image.src?this.model.set({src:""}):this.model.set(image),this.render()}}),ImageWidgetView=base.WidgetView.extend({getTemplate:function(){return window.templates.imageInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.ImageBlockModel},onDrop:function(options){options.droppedView.triggerMethod("showSettings",{showImageManager:!0})}}}}),Module.ImageWidgetView=ImageWidgetView,App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("image",{blockModel:Module.ImageBlockModel,blockView:Module.ImageBlockView}),BeforeStartApp.registerWidget({name:"image",widgetView:Module.ImageWidgetView,priority:91})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},493:function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(4),__webpack_require__(2)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,_,MailPoet){var Module={},base=BaseBlock;return Module.TextBlockModel=base.BlockModel.extend({defaults:function(){return this._getDefaults({type:"text",text:"Edit this to insert text"},App.getConfig().get("blockDefaults.text"))},_updateDefaults:function(){}}),Module.TextBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_text_block mailpoet_droppable_block",getTemplate:function(){return window.templates.textBlock},modelEvents:_.omit(base.BlockView.prototype.modelEvents,"change"),behaviors:_.extend({},base.BlockView.prototype.behaviors,{TextEditorBehavior:{toolbar1:"formatselect bold italic forecolor | link unlink",toolbar2:"alignleft aligncenter alignright alignjustify | bullist numlist blockquote | code mailpoet_shortcodes",validElements:"p[class|style],span[class|style],a[href|class|title|target|style],h1[class|style],h2[class|style],h3[class|style],ol[class|style],ul[class|style],li[class|style],strong[class|style],em[class|style],strike,br,blockquote[class|style],table[class|style],tr[class|style],th[class|style],td[class|style]",invalidElements:"script",blockFormats:"Heading 1=h1;Heading 2=h2;Heading 3=h3;Paragraph=p",plugins:"link lists code textcolor colorpicker mailpoet_shortcodes paste",configurationFilter:function(originalSettings){return _.extend({},originalSettings,{mailpoet_shortcodes:App.getConfig().get("shortcodes").toJSON(),mailpoet_shortcodes_window_title:MailPoet.I18n.t("shortcodesWindowTitle")})}}}),initialize:function(options){base.BlockView.prototype.initialize.apply(this,arguments),this.renderOptions=_.defaults(options.renderOptions||{},{disableTextEditor:!1}),this.disableTextEditor=this.renderOptions.disableTextEditor},onDragSubstituteBy:function(){return Module.TextWidgetView},onRender:function(){this.toolsView=new Module.TextBlockToolsView({model:this.model,tools:{settings:!1}}),this.showChildView("toolsRegion",this.toolsView)},onTextEditorChange:function(newContent){this.model.set("text",newContent)},onTextEditorFocus:function(){this.disableDragging(),this.disableShowingTools()},onTextEditorBlur:function(){this.enableDragging(),this.enableShowingTools()}}),Module.TextBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.TextBlockSettingsView}}),Module.TextBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.textBlockSettings}}),Module.TextWidgetView=base.WidgetView.extend({getTemplate:function(){return window.templates.textInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.TextBlockModel}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("text",{blockModel:Module.TextBlockModel,blockView:Module.TextBlockView}),BeforeStartApp.registerWidget({name:"text",widgetView:Module.TextWidgetView,priority:90})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},494:function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(4)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,_){var Module={},base=BaseBlock;return Module.SpacerBlockModel=base.BlockModel.extend({defaults:function(){return this._getDefaults({type:"spacer",styles:{block:{backgroundColor:"transparent",height:"40px"}}},App.getConfig().get("blockDefaults.spacer"))}}),Module.SpacerBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_spacer_block mailpoet_droppable_block",getTemplate:function(){return window.templates.spacerBlock},behaviors:_.defaults({ResizableBehavior:{elementSelector:".mailpoet_spacer",resizeHandleSelector:".mailpoet_resize_handle",minLength:20,modelField:"styles.block.height"},ShowSettingsBehavior:{ignoreFrom:".mailpoet_resize_handle"}},base.BlockView.prototype.behaviors),modelEvents:_.omit(base.BlockView.prototype.modelEvents,"change"),onDragSubstituteBy:function(){return Module.SpacerWidgetView},initialize:function(){base.BlockView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:styles.block.backgroundColor",this.render),this.listenTo(this.model,"change:styles.block.height",this.changeHeight)},onRender:function(){this.toolsView=new Module.SpacerBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)},changeHeight:function(){this.$(".mailpoet_spacer").css("height",this.model.get("styles.block.height")),this.$(".mailpoet_resize_handle_text").text(this.model.get("styles.block.height"))},onBeforeDestroy:function(){this.stopListening(this.model)}}),Module.SpacerBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.SpacerBlockSettingsView}}),Module.SpacerBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.spacerBlockSettings},events:function(){return{"change .mailpoet_field_spacer_background_color":_.partial(this.changeColorField,"styles.block.backgroundColor"),"click .mailpoet_done_editing":"close"}}}),Module.SpacerWidgetView=base.WidgetView.extend({getTemplate:function(){return window.templates.spacerInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.SpacerBlockModel}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("spacer",{blockModel:Module.SpacerBlockModel,blockView:Module.SpacerBlockView}),BeforeStartApp.registerWidget({name:"spacer",widgetView:Module.SpacerWidgetView,priority:94})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},495:function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(4),__webpack_require__(2)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,_,MailPoet){var Module={},base=BaseBlock;return Module.FooterBlockModel=base.BlockModel.extend({defaults:function(){return this._getDefaults({type:"footer",text:'<a href="[link:subscription_unsubscribe_url]">Unsubscribe</a> | <a href="[link:subscription_manage_url]">Manage subscription</a><br /><b>Add your postal address here!</b>',styles:{block:{backgroundColor:"transparent"},text:{fontColor:"#000000",fontFamily:"Arial",fontSize:"12px",textAlign:"center"},link:{fontColor:"#0000ff",textDecoration:"none"}}},App.getConfig().get("blockDefaults.footer"))},_updateDefaults:function(){App.getConfig().set("blockDefaults.footer",_.omit(this.toJSON(),"text"))}}),Module.FooterBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_footer_block mailpoet_droppable_block",getTemplate:function(){return window.templates.footerBlock},modelEvents:_.extend({"change:styles.block.backgroundColor change:styles.text.fontColor change:styles.text.fontFamily change:styles.text.fontSize change:styles.text.textAlign change:styles.link.fontColor change:styles.link.textDecoration":"render"},_.omit(base.BlockView.prototype.modelEvents,"change")),behaviors:_.extend({},base.BlockView.prototype.behaviors,{TextEditorBehavior:{configurationFilter:function(originalSettings){return _.extend({},originalSettings,{mailpoet_shortcodes:App.getConfig().get("shortcodes").toJSON(),mailpoet_shortcodes_window_title:MailPoet.I18n.t("shortcodesWindowTitle")})}}}),onDragSubstituteBy:function(){return Module.FooterWidgetView},onRender:function(){this.toolsView=new Module.FooterBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)},onTextEditorChange:function(newContent){this.model.set("text",newContent)},onTextEditorFocus:function(){this.disableDragging(),this.disableShowingTools()},onTextEditorBlur:function(){this.enableDragging(),this.enableShowingTools()}}),Module.FooterBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.FooterBlockSettingsView}}),Module.FooterBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.footerBlockSettings},events:function(){return{"change .mailpoet_field_footer_text_color":_.partial(this.changeColorField,"styles.text.fontColor"),"change .mailpoet_field_footer_text_font_family":_.partial(this.changeField,"styles.text.fontFamily"),"change .mailpoet_field_footer_text_size":_.partial(this.changeField,"styles.text.fontSize"),"change #mailpoet_field_footer_link_color":_.partial(this.changeColorField,"styles.link.fontColor"),"change #mailpoet_field_footer_link_underline":function(event){this.model.set("styles.link.textDecoration",event.target.checked?event.target.value:"none")},"change .mailpoet_field_footer_background_color":_.partial(this.changeColorField,"styles.block.backgroundColor"),"change .mailpoet_field_footer_alignment":_.partial(this.changeField,"styles.text.textAlign"),"click .mailpoet_done_editing":"close"}},templateContext:function(){return _.extend({},base.BlockView.prototype.templateContext.apply(this,arguments),{availableStyles:App.getAvailableStyles().toJSON()})}}),Module.FooterWidgetView=base.WidgetView.extend({getTemplate:function(){return window.templates.footerInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.FooterBlockModel}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("footer",{blockModel:Module.FooterBlockModel,blockView:Module.FooterBlockView}),BeforeStartApp.registerWidget({name:"footer",widgetView:Module.FooterWidgetView,priority:99})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},496:function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(4),__webpack_require__(2)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,_,MailPoet){var Module={},base=BaseBlock;return Module.HeaderBlockModel=base.BlockModel.extend({defaults:function(){return this._getDefaults({type:"header",text:'Display problems? <a href="[link:newsletter_view_in_browser_url]">View it in your browser</a>',styles:{block:{backgroundColor:"transparent"},text:{fontColor:"#000000",fontFamily:"Arial",fontSize:"12px",textAlign:"center"},link:{fontColor:"#0000ff",textDecoration:"underline"}}},App.getConfig().get("blockDefaults.header"))},_updateDefaults:function(){App.getConfig().set("blockDefaults.header",_.omit(this.toJSON(),"text"))}}),Module.HeaderBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_header_block mailpoet_droppable_block",getTemplate:function(){return window.templates.headerBlock},modelEvents:_.extend({"change:styles.block.backgroundColor change:styles.text.fontColor change:styles.text.fontFamily change:styles.text.fontSize change:styles.text.textAlign change:styles.link.fontColor change:styles.link.textDecoration":"render"},_.omit(base.BlockView.prototype.modelEvents,"change")),behaviors:_.extend({},base.BlockView.prototype.behaviors,{TextEditorBehavior:{configurationFilter:function(originalSettings){return _.extend({},originalSettings,{mailpoet_shortcodes:App.getConfig().get("shortcodes").toJSON(),mailpoet_shortcodes_window_title:MailPoet.I18n.t("shortcodesWindowTitle")})}}}),onDragSubstituteBy:function(){return Module.HeaderWidgetView},onRender:function(){this.toolsView=new Module.HeaderBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)},onTextEditorChange:function(newContent){this.model.set("text",newContent)},onTextEditorFocus:function(){this.disableDragging(),this.disableShowingTools()},onTextEditorBlur:function(){this.enableDragging(),this.enableShowingTools()}}),Module.HeaderBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.HeaderBlockSettingsView}}),Module.HeaderBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.headerBlockSettings},events:function(){return{"change .mailpoet_field_header_text_color":_.partial(this.changeColorField,"styles.text.fontColor"),"change .mailpoet_field_header_text_font_family":_.partial(this.changeField,"styles.text.fontFamily"),"change .mailpoet_field_header_text_size":_.partial(this.changeField,"styles.text.fontSize"),"change #mailpoet_field_header_link_color":_.partial(this.changeColorField,"styles.link.fontColor"),"change #mailpoet_field_header_link_underline":function(event){this.model.set("styles.link.textDecoration",event.target.checked?event.target.value:"none")},"change .mailpoet_field_header_background_color":_.partial(this.changeColorField,"styles.block.backgroundColor"),"change .mailpoet_field_header_alignment":_.partial(this.changeField,"styles.text.textAlign"),"click .mailpoet_done_editing":"close"}},templateContext:function(){return _.extend({},base.BlockView.prototype.templateContext.apply(this,arguments),{availableStyles:App.getAvailableStyles().toJSON()})}}),Module.HeaderWidgetView=base.WidgetView.extend({getTemplate:function(){return window.templates.headerInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.HeaderBlockModel}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("header",{blockModel:Module.HeaderBlockModel,blockView:Module.HeaderBlockView}),BeforeStartApp.registerWidget({name:"header",widgetView:Module.HeaderWidgetView,priority:98})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},497:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(189),__webpack_require__(190),__webpack_require__(33),__webpack_require__(2),__webpack_require__(24),__webpack_require__(4),__webpack_require__(5)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,ButtonBlock,DividerBlock,CommunicationComponent,MailPoet,SuperModel,_,jQuery){"use strict";var Module={},base=BaseBlock;return Module.ALCSupervisor=SuperModel.extend({initialize:function(){this.listenTo(App.getChannel(),"automatedLatestContentRefresh",_.debounce(this.refresh,500))},refresh:function(){var blocks,models=App.findModels(function(model){return"automatedLatestContent"===model.get("type")})||[];0!==models.length&&(blocks=_.map(models,function(model){return model.toJSON()}),CommunicationComponent.getBulkTransformedPosts({blocks:blocks}).then(_.partial(this.refreshBlocks,models)))},refreshBlocks:function(models,renderedBlocks){_.each(_.zip(models,renderedBlocks),function(args){var model=args[0],contents=args[1];model.trigger("refreshPosts",contents)})}}),Module.AutomatedLatestContentBlockModel=base.BlockModel.extend({stale:["_container"],defaults:function(){return this._getDefaults({type:"automatedLatestContent",withLayout:!1,amount:"5",contentType:"post",terms:[],inclusionType:"include",displayType:"excerpt",titleFormat:"h1",titleAlignment:"left",titleIsLink:!1,imageFullWidth:!1,featuredImagePosition:"belowTitle",showAuthor:"no",authorPrecededBy:"Author:",showCategories:"no",categoriesPrecededBy:"Categories:",readMoreType:"button",readMoreText:"Read more",readMoreButton:{text:"Read more",url:"[postLink]"},sortBy:"newest",showDivider:!0,divider:{},_container:new(App.getBlockTypeModel("container"))},App.getConfig().get("blockDefaults.automatedLatestContent"))},relations:function(){return{readMoreButton:App.getBlockTypeModel("button"),divider:App.getBlockTypeModel("divider"),_container:App.getBlockTypeModel("container")}},initialize:function(){base.BlockView.prototype.initialize.apply(this,arguments),this.on("change:amount change:contentType change:terms change:inclusionType change:displayType change:titleFormat change:featuredImagePosition change:titleAlignment change:titleIsLink change:imageFullWidth change:showAuthor change:authorPrecededBy change:showCategories change:categoriesPrecededBy change:readMoreType change:readMoreText change:sortBy change:showDivider",this._handleChanges,this),this.listenTo(this.get("readMoreButton"),"change",this._handleChanges),this.listenTo(this.get("divider"),"change",this._handleChanges),this.on("add remove update reset",this._handleChanges),this.on("refreshPosts",this.updatePosts,this)},updatePosts:function(posts){this.get("_container.blocks").reset(posts,{parse:!0})},_handleChanges:function(){this._updateDefaults(),App.getChannel().trigger("automatedLatestContentRefresh")}}),Module.AutomatedLatestContentBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_automated_latest_content_block mailpoet_droppable_block",initialize:function(){function replaceButtonStylesHandler(data){this.model.set({readMoreButton:data})}App.getChannel().on("replaceAllButtonStyles",replaceButtonStylesHandler.bind(this))},getTemplate:function(){return window.templates.automatedLatestContentBlock},regions:{toolsRegion:".mailpoet_tools",postsRegion:".mailpoet_automated_latest_content_block_posts"},modelEvents:_.extend(_.omit(base.BlockView.prototype.modelEvents,"change"),{postsChanged:"render"}),events:_.extend(base.BlockView.prototype.events,{"click .mailpoet_automated_latest_content_block_overlay":"showSettings"}),onDragSubstituteBy:function(){return Module.AutomatedLatestContentWidgetView},onRender:function(){var ContainerView=App.getBlockTypeView("container"),renderOptions={disableTextEditor:!0,disableDragAndDrop:!0,emptyContainerMessage:MailPoet.I18n.t("noPostsToDisplay")};this.toolsView=new Module.AutomatedLatestContentBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView),this.showChildView("postsRegion",new ContainerView({model:this.model.get("_container"),renderOptions:renderOptions}))}}),Module.AutomatedLatestContentBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.AutomatedLatestContentBlockSettingsView}}),Module.AutomatedLatestContentBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.automatedLatestContentBlockSettings},events:function(){return{"click .mailpoet_automated_latest_content_hide_display_options":"toggleDisplayOptions","click .mailpoet_automated_latest_content_show_display_options":"toggleDisplayOptions","click .mailpoet_automated_latest_content_select_button":"showButtonSettings","click .mailpoet_automated_latest_content_select_divider":"showDividerSettings","change .mailpoet_automated_latest_content_read_more_type":"changeReadMoreType","change .mailpoet_automated_latest_content_display_type":"changeDisplayType","change .mailpoet_automated_latest_content_title_format":"changeTitleFormat","change .mailpoet_automated_latest_content_title_as_links":_.partial(this.changeBoolField,"titleIsLink"),"change .mailpoet_automated_latest_content_show_divider":_.partial(this.changeBoolField,"showDivider"),"input .mailpoet_automated_latest_content_show_amount":_.partial(this.changeField,"amount"),"change .mailpoet_automated_latest_content_content_type":_.partial(this.changeField,"contentType"),"change .mailpoet_automated_latest_content_include_or_exclude":_.partial(this.changeField,"inclusionType"),"change .mailpoet_automated_latest_content_title_alignment":_.partial(this.changeField,"titleAlignment"),"change .mailpoet_automated_latest_content_image_full_width":_.partial(this.changeBoolField,"imageFullWidth"),"change .mailpoet_automated_latest_content_featured_image_position":_.partial(this.changeField,"featuredImagePosition"),"change .mailpoet_automated_latest_content_show_author":_.partial(this.changeField,"showAuthor"),"input .mailpoet_automated_latest_content_author_preceded_by":_.partial(this.changeField,"authorPrecededBy"),"change .mailpoet_automated_latest_content_show_categories":_.partial(this.changeField,"showCategories"),"input .mailpoet_automated_latest_content_categories":_.partial(this.changeField,"categoriesPrecededBy"),"input .mailpoet_automated_latest_content_read_more_text":_.partial(this.changeField,"readMoreText"),"change .mailpoet_automated_latest_content_sort_by":_.partial(this.changeField,"sortBy"),"click .mailpoet_done_editing":"close"}},onRender:function(){var that=this;CommunicationComponent.getPostTypes().done(_.bind(this._updateContentTypes,this)),this.$(".mailpoet_automated_latest_content_categories_and_tags").select2({multiple:!0,allowClear:!0,placeholder:MailPoet.I18n.t("categoriesAndTags"),ajax:{data:function(params){return{term:params.term,page:params.page||1}},transport:function(options,success,failure){var taxonomies,termsPromise,promise=CommunicationComponent.getTaxonomies(that.model.get("contentType")).then(function(tax){return taxonomies=tax,termsPromise=CommunicationComponent.getTerms({search:options.data.term,page:options.data.page,taxonomies:_.keys(taxonomies)}).then(function(terms){return{taxonomies:taxonomies,terms:terms}})});return promise.then(success),promise.fail(failure),promise},processResults:function(data){return{results:_.map(data.terms,function(item){return _.defaults({text:data.taxonomies[item.taxonomy].labels.singular_name+": "+item.name,id:item.term_id},item)}),pagination:{more:100===data.terms.length}}}}}).on({"select2:select":function(event){var terms=that.model.get("terms");terms.add(event.params.data),that.model.set("terms",terms.toJSON())},"select2:unselect":function(event){var terms=that.model.get("terms");terms.remove(event.params.data),that.model.set("terms",terms.toJSON())}}).trigger("change")},toggleDisplayOptions:function(){var el=this.$(".mailpoet_automated_latest_content_display_options"),showControl=this.$(".mailpoet_automated_latest_content_show_display_options");el.hasClass("mailpoet_closed")?(el.removeClass("mailpoet_closed"),showControl.addClass("mailpoet_hidden")):(el.addClass("mailpoet_closed"),showControl.removeClass("mailpoet_hidden"))},showButtonSettings:function(){new ButtonBlock.ButtonBlockSettingsView({model:this.model.get("readMoreButton"),renderOptions:{displayFormat:"subpanel",hideLink:!0,hideApplyToAll:!0}}).render()},showDividerSettings:function(){new DividerBlock.DividerBlockSettingsView({model:this.model.get("divider"),renderOptions:{displayFormat:"subpanel",hideApplyToAll:!0}}).render()},changeReadMoreType:function(event){var value=jQuery(event.target).val();"link"===value?(this.$(".mailpoet_automated_latest_content_read_more_text").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_select_button").addClass("mailpoet_hidden")):"button"===value&&(this.$(".mailpoet_automated_latest_content_read_more_text").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_select_button").removeClass("mailpoet_hidden")),this.changeField("readMoreType",event)},changeDisplayType:function(event){var value=jQuery(event.target).val();"titleOnly"===value?(this.$(".mailpoet_automated_latest_content_title_as_list").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_full_width_option").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_separator").addClass("mailpoet_hidden")):(this.$(".mailpoet_automated_latest_content_title_as_list").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_full_width_option").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_separator").removeClass("mailpoet_hidden"),"ul"===this.model.get("titleFormat")&&(this.model.set("titleFormat","h1"),this.$(".mailpoet_automated_latest_content_title_format").val(["h1"]),this.$(".mailpoet_automated_latest_content_title_as_link").removeClass("mailpoet_hidden"))),"excerpt"===value?this.$(".mailpoet_automated_latest_content_featured_image_position_container").removeClass("mailpoet_hidden"):this.$(".mailpoet_automated_latest_content_featured_image_position_container").addClass("mailpoet_hidden"),this.changeField("displayType",event)},changeTitleFormat:function(event){"ul"===jQuery(event.target).val()?(this.$(".mailpoet_automated_latest_content_non_title_list_options").addClass("mailpoet_hidden"),this.model.set("titleIsLink",!0),this.$(".mailpoet_automated_latest_content_title_as_link").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_as_links").val(["true"])):(this.$(".mailpoet_automated_latest_content_non_title_list_options").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_as_link").removeClass("mailpoet_hidden")),this.changeField("titleFormat",event)},_updateContentTypes:function(postTypes){var select=this.$(".mailpoet_automated_latest_content_content_type"),selectedValue=this.model.get("contentType");select.find("option").remove(),_.each(postTypes,function(type){select.append(jQuery("<option>",{value:type.name,text:type.label}))}),select.val(selectedValue)}}),Module.AutomatedLatestContentWidgetView=base.WidgetView.extend({getTemplate:function(){return window.templates.automatedLatestContentInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.AutomatedLatestContentBlockModel({},{parse:!0})},onDrop:function(options){options.droppedView.triggerMethod("showSettings")}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("automatedLatestContent",{blockModel:Module.AutomatedLatestContentBlockModel,blockView:Module.AutomatedLatestContentBlockView})}),App.on("start",function(StartApp){var Application=StartApp;Application._ALCSupervisor=new Module.ALCSupervisor,Application._ALCSupervisor.refresh()}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},498:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(189),__webpack_require__(190),__webpack_require__(33),__webpack_require__(2),__webpack_require__(24),__webpack_require__(4),__webpack_require__(5)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,ButtonBlock,DividerBlock,CommunicationComponent,MailPoet,SuperModel,_,jQuery){"use strict";var Module={},base=BaseBlock;return Module.ALCLayoutSupervisor=SuperModel.extend({initialize:function(){this.listenTo(App.getChannel(),"automatedLatestContentLayoutRefresh",_.debounce(this.refresh,500))},refresh:function(){var blocks,models=App.findModels(function(model){return"automatedLatestContentLayout"===model.get("type")})||[];0!==models.length&&(blocks=_.map(models,function(model){return model.toJSON()}),CommunicationComponent.getBulkTransformedPosts({blocks:blocks}).then(_.partial(this.refreshBlocks,models)))},refreshBlocks:function(models,renderedBlocks){_.each(_.zip(models,renderedBlocks),function(args){var model=args[0],contents=args[1];model.trigger("refreshPosts",contents)})}}),Module.AutomatedLatestContentLayoutBlockModel=base.BlockModel.extend({stale:["_container"],defaults:function(){return this._getDefaults({type:"automatedLatestContentLayout",withLayout:!0,amount:"5",contentType:"post",terms:[],inclusionType:"include",displayType:"excerpt",titleFormat:"h1",titleAlignment:"left",titleIsLink:!1,imageFullWidth:!1,featuredImagePosition:"centered",showAuthor:"no",authorPrecededBy:"Author:",showCategories:"no",categoriesPrecededBy:"Categories:",readMoreType:"button",readMoreText:"Read more",readMoreButton:{text:"Read more",url:"[postLink]"},sortBy:"newest",showDivider:!0,divider:{},_container:new(App.getBlockTypeModel("container"))},App.getConfig().get("blockDefaults.automatedLatestContentLayout"))},relations:function(){return{readMoreButton:App.getBlockTypeModel("button"),divider:App.getBlockTypeModel("divider"),_container:App.getBlockTypeModel("container")}},initialize:function(){base.BlockView.prototype.initialize.apply(this,arguments),this.on("change:amount change:contentType change:terms change:inclusionType change:displayType change:titleFormat change:featuredImagePosition change:titleAlignment change:titleIsLink change:imageFullWidth change:showAuthor change:authorPrecededBy change:showCategories change:categoriesPrecededBy change:readMoreType change:readMoreText change:sortBy change:showDivider",this._handleChanges,this),this.listenTo(this.get("readMoreButton"),"change",this._handleChanges),this.listenTo(this.get("divider"),"change",this._handleChanges),this.on("add remove update reset",this._handleChanges),this.on("refreshPosts",this.updatePosts,this)},updatePosts:function(posts){this.get("_container.blocks").reset(posts,{parse:!0})},_handleChanges:function(){this._updateDefaults(),App.getChannel().trigger("automatedLatestContentLayoutRefresh")}}),Module.AutomatedLatestContentLayoutBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_automated_latest_content_block mailpoet_droppable_block",initialize:function(){function replaceButtonStylesHandler(data){this.model.set({readMoreButton:data})}App.getChannel().on("replaceAllButtonStyles",replaceButtonStylesHandler.bind(this))},getTemplate:function(){return window.templates.automatedLatestContentLayoutBlock},regions:{toolsRegion:".mailpoet_tools",postsRegion:".mailpoet_automated_latest_content_block_posts"},modelEvents:_.extend(_.omit(base.BlockView.prototype.modelEvents,"change"),{postsChanged:"render"}),events:_.extend(base.BlockView.prototype.events,{"click .mailpoet_automated_latest_content_block_overlay":"showSettings"}),onDragSubstituteBy:function(){return Module.AutomatedLatestContentLayoutWidgetView},onRender:function(){var ContainerView=App.getBlockTypeView("container"),renderOptions={disableTextEditor:!0,disableDragAndDrop:!0,emptyContainerMessage:MailPoet.I18n.t("noPostsToDisplay")};this.toolsView=new Module.AutomatedLatestContentLayoutBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView),this.showChildView("postsRegion",new ContainerView({model:this.model.get("_container"),renderOptions:renderOptions}))}}),Module.AutomatedLatestContentLayoutBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.AutomatedLatestContentLayoutBlockSettingsView}}),Module.AutomatedLatestContentLayoutBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.automatedLatestContentLayoutBlockSettings},events:function(){return{"click .mailpoet_automated_latest_content_hide_display_options":"toggleDisplayOptions","click .mailpoet_automated_latest_content_show_display_options":"toggleDisplayOptions","click .mailpoet_automated_latest_content_select_button":"showButtonSettings","click .mailpoet_automated_latest_content_select_divider":"showDividerSettings","change .mailpoet_automated_latest_content_read_more_type":"changeReadMoreType","change .mailpoet_automated_latest_content_display_type":"changeDisplayType","change .mailpoet_automated_latest_content_title_format":"changeTitleFormat","change .mailpoet_automated_latest_content_title_as_links":_.partial(this.changeBoolField,"titleIsLink"),"change .mailpoet_automated_latest_content_show_divider":_.partial(this.changeBoolField,"showDivider"),"input .mailpoet_automated_latest_content_show_amount":_.partial(this.changeField,"amount"),"change .mailpoet_automated_latest_content_content_type":_.partial(this.changeField,"contentType"),"change .mailpoet_automated_latest_content_include_or_exclude":_.partial(this.changeField,"inclusionType"),"change .mailpoet_automated_latest_content_title_alignment":_.partial(this.changeField,"titleAlignment"),"change .mailpoet_automated_latest_content_image_full_width":_.partial(this.changeBoolField,"imageFullWidth"),"change .mailpoet_automated_latest_content_featured_image_position":_.partial(this.changeField,"featuredImagePosition"),"change .mailpoet_automated_latest_content_show_author":_.partial(this.changeField,"showAuthor"),"input .mailpoet_automated_latest_content_author_preceded_by":_.partial(this.changeField,"authorPrecededBy"),"change .mailpoet_automated_latest_content_show_categories":_.partial(this.changeField,"showCategories"),"input .mailpoet_automated_latest_content_categories":_.partial(this.changeField,"categoriesPrecededBy"),"input .mailpoet_automated_latest_content_read_more_text":_.partial(this.changeField,"readMoreText"),"change .mailpoet_automated_latest_content_sort_by":_.partial(this.changeField,"sortBy"),"click .mailpoet_done_editing":"close"}},onRender:function(){var that=this;CommunicationComponent.getPostTypes().done(_.bind(this._updateContentTypes,this)),this.$(".mailpoet_automated_latest_content_categories_and_tags").select2({multiple:!0,allowClear:!0,placeholder:MailPoet.I18n.t("categoriesAndTags"),ajax:{data:function(params){return{term:params.term,page:params.page||1}},transport:function(options,success,failure){var taxonomies,termsPromise,promise=CommunicationComponent.getTaxonomies(that.model.get("contentType")).then(function(tax){return taxonomies=tax,termsPromise=CommunicationComponent.getTerms({search:options.data.term,page:options.data.page,taxonomies:_.keys(taxonomies)}).then(function(terms){return{taxonomies:taxonomies,terms:terms}})});return promise.then(success),promise.fail(failure),promise},processResults:function(data){return{results:_.map(data.terms,function(item){return _.defaults({text:data.taxonomies[item.taxonomy].labels.singular_name+": "+item.name,id:item.term_id},item)}),pagination:{more:100===data.terms.length}}}}}).on({"select2:select":function(event){var terms=that.model.get("terms");terms.add(event.params.data),that.model.set("terms",terms.toJSON())},"select2:unselect":function(event){var terms=that.model.get("terms");terms.remove(event.params.data),that.model.set("terms",terms.toJSON())}}).trigger("change")},toggleDisplayOptions:function(){var el=this.$(".mailpoet_automated_latest_content_display_options"),showControl=this.$(".mailpoet_automated_latest_content_show_display_options");el.hasClass("mailpoet_closed")?(el.removeClass("mailpoet_closed"),showControl.addClass("mailpoet_hidden")):(el.addClass("mailpoet_closed"),showControl.removeClass("mailpoet_hidden"))},showButtonSettings:function(){new ButtonBlock.ButtonBlockSettingsView({model:this.model.get("readMoreButton"),renderOptions:{displayFormat:"subpanel",hideLink:!0,hideApplyToAll:!0}}).render()},showDividerSettings:function(){new DividerBlock.DividerBlockSettingsView({model:this.model.get("divider"),renderOptions:{displayFormat:"subpanel",hideApplyToAll:!0}}).render()},changeReadMoreType:function(event){var value=jQuery(event.target).val();"link"===value?(this.$(".mailpoet_automated_latest_content_read_more_text").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_select_button").addClass("mailpoet_hidden")):"button"===value&&(this.$(".mailpoet_automated_latest_content_read_more_text").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_select_button").removeClass("mailpoet_hidden")),this.changeField("readMoreType",event)},changeDisplayType:function(event){var value=jQuery(event.target).val();"titleOnly"===value?(this.$(".mailpoet_automated_latest_content_title_as_list").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_full_width_option").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_separator").addClass("mailpoet_hidden")):(this.$(".mailpoet_automated_latest_content_title_as_list").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_full_width_option").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_separator").removeClass("mailpoet_hidden"),"ul"===this.model.get("titleFormat")&&(this.model.set("titleFormat","h1"),this.$(".mailpoet_automated_latest_content_title_format").val(["h1"]),this.$(".mailpoet_automated_latest_content_title_as_link").removeClass("mailpoet_hidden"))),"excerpt"===value?this.$(".mailpoet_automated_latest_content_featured_image_position_container").removeClass("mailpoet_hidden"):this.$(".mailpoet_automated_latest_content_featured_image_position_container").addClass("mailpoet_hidden"),this.changeField("displayType",event)},changeTitleFormat:function(event){"ul"===jQuery(event.target).val()?(this.$(".mailpoet_automated_latest_content_non_title_list_options").addClass("mailpoet_hidden"),this.model.set("titleIsLink",!0),this.$(".mailpoet_automated_latest_content_title_as_link").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_as_links").val(["true"])):(this.$(".mailpoet_automated_latest_content_non_title_list_options").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_as_link").removeClass("mailpoet_hidden")),this.changeField("titleFormat",event)},_updateContentTypes:function(postTypes){var select=this.$(".mailpoet_automated_latest_content_content_type"),selectedValue=this.model.get("contentType");select.find("option").remove(),_.each(postTypes,function(type){select.append(jQuery("<option>",{value:type.name,text:type.label}))}),select.val(selectedValue)}}),Module.AutomatedLatestContentLayoutWidgetView=base.WidgetView.extend({className:base.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.automatedLatestContentLayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.AutomatedLatestContentLayoutBlockModel({},{parse:!0})},onDrop:function(options){options.droppedView.triggerMethod("showSettings")}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("automatedLatestContentLayout",{blockModel:Module.AutomatedLatestContentLayoutBlockModel,blockView:Module.AutomatedLatestContentLayoutBlockView}),BeforeStartApp.registerWidget({name:"automatedLatestContentLayout",widgetView:Module.AutomatedLatestContentLayoutWidgetView,priority:97})}),App.on("start",function(StartApp){var Application=StartApp;Application._ALCLayoutSupervisor=new Module.ALCLayoutSupervisor,Application._ALCLayoutSupervisor.refresh()}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},499:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(18),__webpack_require__(10),__webpack_require__(270),__webpack_require__(4),__webpack_require__(5),__webpack_require__(2),__webpack_require__(9),__webpack_require__(33),__webpack_require__(16),__webpack_require__(189),__webpack_require__(190),__webpack_require__(284)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Backbone,Marionette,Radio,_,jQuery,MailPoet,App,CommunicationComponent,BaseBlock,ButtonBlock,DividerBlock){"use strict";var PostsDisplayOptionsSettingsView,SinglePostSelectionSettingsView,EmptyPostSelectionSettingsView,PostSelectionSettingsView,PostsSelectionCollectionView,Module={},base=BaseBlock;return Module.PostsBlockModel=base.BlockModel.extend({stale:["_selectedPosts","_availablePosts","_transformedPosts"],defaults:function(){return this._getDefaults({type:"posts",withLayout:!0,amount:"10",offset:0,contentType:"post",postStatus:"publish",terms:[],search:"",inclusionType:"include",displayType:"excerpt",titleFormat:"h1",titleAlignment:"left",titleIsLink:!1,imageFullWidth:!1,featuredImagePosition:"centered",showAuthor:"no",authorPrecededBy:"Author:",showCategories:"no",categoriesPrecededBy:"Categories:",readMoreType:"link",readMoreText:"Read more",readMoreButton:{text:"Read more",url:"[postLink]"},sortBy:"newest",showDivider:!0,divider:{},_selectedPosts:[],_availablePosts:[],_transformedPosts:new(App.getBlockTypeModel("container"))},App.getConfig().get("blockDefaults.posts"))},relations:function(){return{readMoreButton:App.getBlockTypeModel("button"),divider:App.getBlockTypeModel("divider"),_selectedPosts:Backbone.Collection,_availablePosts:Backbone.Collection,_transformedPosts:App.getBlockTypeModel("container")}},initialize:function(){var refreshAvailablePosts=_.debounce(this.fetchAvailablePosts.bind(this),500),refreshTransformedPosts=_.debounce(this._refreshTransformedPosts.bind(this),500);_.extend(this,Radio.Requests),this.fetchAvailablePosts(),this.on("change",this._updateDefaults,this),this.on("change:amount change:contentType change:terms change:inclusionType change:postStatus change:search change:sortBy",refreshAvailablePosts),this.on("loadMorePosts",this._loadMorePosts,this),this.listenTo(this.get("_selectedPosts"),"add remove reset",refreshTransformedPosts),this.on("change:displayType change:titleFormat change:featuredImagePosition change:titleAlignment change:titleIsLink change:imageFullWidth change:showAuthor change:authorPrecededBy change:showCategories change:categoriesPrecededBy change:readMoreType change:readMoreText change:showDivider",refreshTransformedPosts),this.listenTo(this.get("readMoreButton"),"change",refreshTransformedPosts),this.listenTo(this.get("divider"),"change",refreshTransformedPosts),this.on("insertSelectedPosts",this._insertSelectedPosts,this)},fetchAvailablePosts:function(){var that=this;this.set("offset",0),CommunicationComponent.getPosts(this.toJSON()).done(function(posts){that.get("_availablePosts").reset(posts),that.get("_selectedPosts").reset(),that.trigger("change:_availablePosts")}).fail(function(){MailPoet.Notice.error(MailPoet.I18n.t("failedToFetchAvailablePosts"))})},_loadMorePosts:function(){var that=this,postCount=this.get("_availablePosts").length,nextOffset=this.get("offset")+Number(this.get("amount"));return!(0===postCount||postCount<nextOffset)&&(this.set("offset",nextOffset),this.trigger("loadingMorePosts"),CommunicationComponent.getPosts(this.toJSON()).done(function(posts){that.get("_availablePosts").add(posts),that.trigger("change:_availablePosts")}).fail(function(){MailPoet.Notice.error(MailPoet.I18n.t("failedToFetchAvailablePosts"))}).always(function(){that.trigger("morePostsLoaded")}),!0)},_refreshTransformedPosts:function(){var that=this,data=this.toJSON();if(data.posts=this.get("_selectedPosts").pluck("ID"),0===data.posts.length)return void this.get("_transformedPosts").get("blocks").reset();CommunicationComponent.getTransformedPosts(data).done(function(posts){that.get("_transformedPosts").get("blocks").reset(posts,{parse:!0})}).fail(function(){MailPoet.Notice.error(MailPoet.I18n.t("failedToFetchRenderedPosts"))})},_insertSelectedPosts:function(){var data=this.toJSON(),index=this.collection.indexOf(this),collection=this.collection;data.posts=this.get("_selectedPosts").pluck("ID"),0!==data.posts.length&&CommunicationComponent.getTransformedPosts(data).done(function(posts){collection.add(JSON.parse(JSON.stringify(posts)),{at:index})}).fail(function(){MailPoet.Notice.error(MailPoet.I18n.t("failedToFetchRenderedPosts"))})}}),Module.PostsBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_posts_block mailpoet_droppable_block",getTemplate:function(){return window.templates.postsBlock},modelEvents:{},regions:_.extend({postsRegion:".mailpoet_posts_container"},base.BlockView.prototype.regions),onDragSubstituteBy:function(){return Module.PostsWidgetView},initialize:function(){base.BlockView.prototype.initialize.apply(this,arguments),this.toolsView=new Module.PostsBlockToolsView({model:this.model}),this.model.reply("blockView",this.notifyAboutSelf,this)},onRender:function(){var ContainerView,renderOptions;this.getRegion("toolsRegion").hasView()||this.showChildView("toolsRegion",this.toolsView),this.trigger("showSettings"),ContainerView=App.getBlockTypeView("container"),renderOptions={disableTextEditor:!0,disableDragAndDrop:!0,emptyContainerMessage:MailPoet.I18n.t("noPostsToDisplay")},this.showChildView("postsRegion",new ContainerView({model:this.model.get("_transformedPosts"),renderOptions:renderOptions}))},notifyAboutSelf:function(){return this},onBeforeDestroy:function(){this.model.stopReplying("blockView",this.notifyAboutSelf,this)}}),Module.PostsBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.PostsBlockSettingsView}}),Module.PostsBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.postsBlockSettings},regions:{selectionRegion:".mailpoet_settings_posts_selection",displayOptionsRegion:".mailpoet_settings_posts_display_options"},events:{"click .mailpoet_settings_posts_show_display_options":"switchToDisplayOptions","click .mailpoet_settings_posts_show_post_selection":"switchToPostSelection","click .mailpoet_settings_posts_insert_selected":"insertPosts"},templateContext:function(){return{model:this.model.toJSON()}},initialize:function(){this.model.trigger("startEditing"),this.selectionView=new PostSelectionSettingsView({model:this.model}),this.displayOptionsView=new PostsDisplayOptionsSettingsView({model:this.model})},onRender:function(){var that=this;this.model.request("blockView"),this.showChildView("selectionRegion",this.selectionView),this.showChildView("displayOptionsRegion",this.displayOptionsView),MailPoet.Modal.panel({element:this.$el,template:"",position:"right",width:App.getConfig().get("sidepanelWidth"),onCancel:function(){that.model.destroy()}}),this.selectionView.triggerMethod("attach"),this.displayOptionsView.triggerMethod("attach")},switchToDisplayOptions:function(){this.$(".mailpoet_settings_posts_selection").addClass("mailpoet_closed"),this.$(".mailpoet_settings_posts_display_options").removeClass("mailpoet_closed"),this.$(".mailpoet_settings_posts_show_display_options").addClass("mailpoet_hidden"),this.$(".mailpoet_settings_posts_show_post_selection").removeClass("mailpoet_hidden")},switchToPostSelection:function(){this.$(".mailpoet_settings_posts_display_options").addClass("mailpoet_closed"),this.$(".mailpoet_settings_posts_selection").removeClass("mailpoet_closed"),this.$(".mailpoet_settings_posts_show_post_selection").addClass("mailpoet_hidden"),this.$(".mailpoet_settings_posts_show_display_options").removeClass("mailpoet_hidden")},insertPosts:function(){this.model.trigger("insertSelectedPosts"),this.model.destroy(),this.close()}}),PostsSelectionCollectionView=Marionette.CollectionView.extend({className:"mailpoet_post_scroll_container",childView:function(){return SinglePostSelectionSettingsView},emptyView:function(){return EmptyPostSelectionSettingsView},childViewOptions:function(){return{blockModel:this.blockModel}},initialize:function(options){this.blockModel=options.blockModel},events:{scroll:"onPostsScroll"},onPostsScroll:function(event){var $postsBox=jQuery(event.target);$postsBox.scrollTop()+$postsBox.innerHeight()>=$postsBox[0].scrollHeight&&this.blockModel.trigger("loadMorePosts")}}),PostSelectionSettingsView=Marionette.View.extend({getTemplate:function(){return window.templates.postSelectionPostsBlockSettings},regions:{posts:".mailpoet_post_selection_container"},events:function(){return{"change .mailpoet_settings_posts_content_type":_.partial(this.changeField,"contentType"),"change .mailpoet_posts_post_status":_.partial(this.changeField,"postStatus"),"input .mailpoet_posts_search_term":_.partial(this.changeField,"search")}},modelEvents:{"change:offset":function(model,value){0===value&&this.$(".mailpoet_post_scroll_container").scrollTop(0)},loadingMorePosts:function(){this.$(".mailpoet_post_selection_loading").css("visibility","visible")},morePostsLoaded:function(){this.$(".mailpoet_post_selection_loading").css("visibility","hidden")}},templateContext:function(){return{model:this.model.toJSON()}},onRender:function(){var postsView;CommunicationComponent.getPostTypes().done(_.bind(this._updateContentTypes,this)),postsView=new PostsSelectionCollectionView({collection:this.model.get("_availablePosts"),blockModel:this.model}),this.showChildView("posts",postsView)},onAttach:function(){var that=this;this.$(".mailpoet_posts_categories_and_tags").select2({multiple:!0,allowClear:!0,placeholder:MailPoet.I18n.t("categoriesAndTags"),ajax:{data:function(params){return{term:params.term,page:params.page||1}},transport:function(options,success,failure){var taxonomies,termsPromise,promise=CommunicationComponent.getTaxonomies(that.model.get("contentType")).then(function(tax){return taxonomies=tax,termsPromise=CommunicationComponent.getTerms({search:options.data.term,page:options.data.page,taxonomies:_.keys(taxonomies)}).then(function(terms){return{taxonomies:taxonomies,terms:terms}})});return promise.then(success),promise.fail(failure),promise},processResults:function(data){return{results:_.map(data.terms,function(item){return _.defaults({text:data.taxonomies[item.taxonomy].labels.singular_name+": "+item.name,id:item.term_id},item)}),pagination:{more:100===data.terms.length}}}}}).on({"select2:select":function(event){var terms=that.model.get("terms");terms.add(event.params.data),that.model.set("terms",terms.toJSON())},"select2:unselect":function(event){var terms=that.model.get("terms");terms.remove(event.params.data),that.model.set("terms",terms.toJSON())}}).trigger("change")},changeField:function(field,event){this.model.set(field,jQuery(event.target).val())},_updateContentTypes:function(postTypes){var select=this.$(".mailpoet_settings_posts_content_type"),selectedValue=this.model.get("contentType");select.find("option").remove(),_.each(postTypes,function(type){select.append(jQuery("<option>",{value:type.name,text:type.label}))}),select.val(selectedValue)}}),EmptyPostSelectionSettingsView=Marionette.View.extend({getTemplate:function(){return window.templates.emptyPostPostsBlockSettings}}),SinglePostSelectionSettingsView=Marionette.View.extend({getTemplate:function(){return window.templates.singlePostPostsBlockSettings},events:function(){return{"change .mailpoet_select_post_checkbox":"postSelectionChange"}},templateContext:function(){return{model:this.model.toJSON(),index:this._index}},initialize:function(options){this.blockModel=options.blockModel},postSelectionChange:function(event){var checkBox=jQuery(event.target),selectedPostsCollection=this.blockModel.get("_selectedPosts");checkBox.prop("checked")?selectedPostsCollection.add(this.model):selectedPostsCollection.remove(this.model)}}),PostsDisplayOptionsSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.displayOptionsPostsBlockSettings},events:function(){return{"click .mailpoet_posts_select_button":"showButtonSettings","click .mailpoet_posts_select_divider":"showDividerSettings","change .mailpoet_posts_read_more_type":"changeReadMoreType","change .mailpoet_posts_display_type":"changeDisplayType","change .mailpoet_posts_title_format":"changeTitleFormat","change .mailpoet_posts_title_as_links":_.partial(this.changeBoolField,"titleIsLink"),"change .mailpoet_posts_show_divider":_.partial(this.changeBoolField,"showDivider"),"input .mailpoet_posts_show_amount":_.partial(this.changeField,"amount"),"change .mailpoet_posts_content_type":_.partial(this.changeField,"contentType"),"change .mailpoet_posts_include_or_exclude":_.partial(this.changeField,"inclusionType"),"change .mailpoet_posts_title_alignment":_.partial(this.changeField,"titleAlignment"),"change .mailpoet_posts_image_full_width":_.partial(this.changeBoolField,"imageFullWidth"),"change .mailpoet_posts_featured_image_position":_.partial(this.changeField,"featuredImagePosition"),"change .mailpoet_posts_show_author":_.partial(this.changeField,"showAuthor"),"input .mailpoet_posts_author_preceded_by":_.partial(this.changeField,"authorPrecededBy"),"change .mailpoet_posts_show_categories":_.partial(this.changeField,"showCategories"),"input .mailpoet_posts_categories":_.partial(this.changeField,"categoriesPrecededBy"),"input .mailpoet_posts_read_more_text":_.partial(this.changeField,"readMoreText"),"change .mailpoet_posts_sort_by":_.partial(this.changeField,"sortBy")}},templateContext:function(){return{model:this.model.toJSON()}},showButtonSettings:function(){new ButtonBlock.ButtonBlockSettingsView({model:this.model.get("readMoreButton"),renderOptions:{displayFormat:"subpanel",hideLink:!0,hideApplyToAll:!0}}).render()},showDividerSettings:function(){new DividerBlock.DividerBlockSettingsView({model:this.model.get("divider"),renderOptions:{displayFormat:"subpanel",hideApplyToAll:!0}}).render()},changeReadMoreType:function(event){var value=jQuery(event.target).val();"link"===value?(this.$(".mailpoet_posts_read_more_text").removeClass("mailpoet_hidden"),this.$(".mailpoet_posts_select_button").addClass("mailpoet_hidden")):"button"===value&&(this.$(".mailpoet_posts_read_more_text").addClass("mailpoet_hidden"),this.$(".mailpoet_posts_select_button").removeClass("mailpoet_hidden")),this.changeField("readMoreType",event)},changeDisplayType:function(event){var value=jQuery(event.target).val();"titleOnly"===value?(this.$(".mailpoet_posts_title_as_list").removeClass("mailpoet_hidden"),this.$(".mailpoet_posts_image_full_width_option").addClass("mailpoet_hidden"),this.$(".mailpoet_posts_image_separator").addClass("mailpoet_hidden")):(this.$(".mailpoet_posts_title_as_list").addClass("mailpoet_hidden"),this.$(".mailpoet_posts_image_full_width_option").removeClass("mailpoet_hidden"),this.$(".mailpoet_posts_image_separator").removeClass("mailpoet_hidden"),"ul"===this.model.get("titleFormat")&&(this.model.set("titleFormat","h1"),this.$(".mailpoet_posts_title_format").val(["h1"]),this.$(".mailpoet_posts_title_as_link").removeClass("mailpoet_hidden"))),"excerpt"===value?this.$(".mailpoet_posts_featured_image_position_container").removeClass("mailpoet_hidden"):this.$(".mailpoet_posts_featured_image_position_container").addClass("mailpoet_hidden"),this.changeField("displayType",event)},changeTitleFormat:function(event){"ul"===jQuery(event.target).val()?(this.$(".mailpoet_posts_non_title_list_options").addClass("mailpoet_hidden"),this.model.set("titleIsLink",!0),this.$(".mailpoet_posts_title_as_link").addClass("mailpoet_hidden"),this.$(".mailpoet_posts_title_as_links").val(["true"])):(this.$(".mailpoet_posts_non_title_list_options").removeClass("mailpoet_hidden"),this.$(".mailpoet_posts_title_as_link").removeClass("mailpoet_hidden")),this.changeField("titleFormat",event)}}),Module.PostsWidgetView=base.WidgetView.extend({className:base.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.postsInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.PostsBlockModel({},{parse:!0})}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("posts",{blockModel:Module.PostsBlockModel,blockView:Module.PostsBlockView}),BeforeStartApp.registerWidget({name:"posts",widgetView:Module.PostsWidgetView,priority:96})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},500:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9),__webpack_require__(16),__webpack_require__(18),__webpack_require__(10),__webpack_require__(24),__webpack_require__(4),__webpack_require__(5)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(App,BaseBlock,Backbone,Marionette,SuperModel,_,jQuery){"use strict";var SocialBlockSettingsIconSelectorView,SocialBlockSettingsIconView,SocialBlockSettingsIconCollectionView,SocialBlockSettingsStylesView,SocialIconView,Module={},base=BaseBlock;return Module.SocialIconModel=SuperModel.extend({defaults:function(){var defaultValues=App.getConfig().get("socialIcons.custom");return{type:"socialIcon",iconType:"custom",link:defaultValues.get("defaultLink"),image:App.getAvailableStyles().get("socialIconSets.default.custom"),height:"32px",width:"32px",text:defaultValues.get("title")}},initialize:function(){var that=this;this.on("change:iconType",function(){var defaultValues=App.getConfig().get("socialIcons").get(that.get("iconType")),iconSet=that.collection.iconBlockModel.getIconSet();this.set({link:defaultValues.get("defaultLink"),image:iconSet.get(that.get("iconType")),text:defaultValues.get("title")})},this),this.on("change",function(){App.getChannel().trigger("autoSave")})}}),Module.SocialIconCollectionModel=Backbone.Collection.extend({model:Module.SocialIconModel}),Module.SocialBlockModel=base.BlockModel.extend({name:"iconBlockModel",defaults:function(){return this._getDefaults({type:"social",iconSet:"default",icons:new Module.SocialIconCollectionModel},App.getConfig().get("blockDefaults.social"))},relations:{icons:Module.SocialIconCollectionModel},initialize:function(){this.get("icons").on("add remove change",this._iconsChanged,this),this.on("change:iconSet",this.changeIconSet,this),this.on("change",this._updateDefaults,this)},getIconSet:function(){return App.getAvailableStyles().get("socialIconSets").get(this.get("iconSet"))},changeIconSet:function(){var iconSet=this.getIconSet();_.each(this.get("icons").models,function(model){model.set("image",iconSet.get(model.get("iconType")))})},_iconsChanged:function(){this._updateDefaults(),App.getChannel().trigger("autoSave")}}),SocialIconView=Marionette.View.extend({tagName:"span",getTemplate:function(){return window.templates.socialIconBlock},modelEvents:{change:"render"},templateContext:function(){var allIconSets=App.getAvailableStyles().get("socialIconSets");return{model:this.model.toJSON(),allIconSets:allIconSets.toJSON(),imageMissingSrc:App.getConfig().get("urls.imageMissing")}}}),Module.SocialIconCollectionView=Marionette.CollectionView.extend({childView:SocialIconView}),Module.SocialBlockView=base.BlockView.extend({className:"mailpoet_block mailpoet_social_block mailpoet_droppable_block",getTemplate:function(){return window.templates.socialBlock},regions:_.extend({},base.BlockView.prototype.regions,{icons:".mailpoet_social"}),ui:{tools:"> .mailpoet_tools"},behaviors:_.extend({},base.BlockView.prototype.behaviors,{ShowSettingsBehavior:{}}),onDragSubstituteBy:function(){return Module.SocialWidgetView},onRender:function(){this.toolsView=new Module.SocialBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView),this.showChildView("icons",new Module.SocialIconCollectionView({collection:this.model.get("icons")}))}}),Module.SocialBlockToolsView=base.BlockToolsView.extend({getSettingsView:function(){return Module.SocialBlockSettingsView}}),Module.SocialBlockSettingsView=base.BlockSettingsView.extend({getTemplate:function(){return window.templates.socialBlockSettings},regions:{iconRegion:"#mailpoet_social_icons_selection",stylesRegion:"#mailpoet_social_icons_styles"},events:function(){return{"click .mailpoet_done_editing":"close"}},initialize:function(){base.BlockSettingsView.prototype.initialize.apply(this,arguments),this._iconSelectorView=new SocialBlockSettingsIconSelectorView({model:this.model}),this._stylesView=new SocialBlockSettingsStylesView({model:this.model})},onRender:function(){this.showChildView("iconRegion",this._iconSelectorView),this.showChildView("stylesRegion",this._stylesView)}}),SocialBlockSettingsIconView=Marionette.View.extend({getTemplate:function(){return window.templates.socialSettingsIcon},events:function(){return{"click .mailpoet_delete_block":"deleteIcon","change .mailpoet_social_icon_field_type":_.partial(this.changeField,"iconType"),"input .mailpoet_social_icon_field_image":_.partial(this.changeField,"image"),"input .mailpoet_social_icon_field_link":this.changeLink,"input .mailpoet_social_icon_field_text":_.partial(this.changeField,"text")}},modelEvents:{"change:iconType":"render","change:image":function(){this.$(".mailpoet_social_icon_image").attr("src",this.model.get("image"))},"change:text":function(){this.$(".mailpoet_social_icon_image").attr("alt",this.model.get("text"))}},templateContext:function(){var icons=App.getConfig().get("socialIcons"),availableIconTypes=_.map(_.keys(icons.attributes),function(key){return{iconType:key,title:icons.get(key).get("title")}}),allIconSets=App.getAvailableStyles().get("socialIconSets");return _.extend({},base.BlockView.prototype.templateContext.apply(this,arguments),{iconTypes:availableIconTypes,currentType:icons.get(this.model.get("iconType")).toJSON(),allIconSets:allIconSets.toJSON()})},deleteIcon:function(){this.model.destroy()},changeLink:function(event){if("email"!==this.model.get("iconType"))return this.changeField("link",event);this.model.set("link","mailto:"+jQuery(event.target).val())},changeField:function(field,event){this.model.set(field,jQuery(event.target).val())}}),SocialBlockSettingsIconCollectionView=Marionette.CollectionView.extend({behaviors:{SortableBehavior:{items:"> div"}},childViewContainer:"#mailpoet_social_icon_selector_contents",childView:SocialBlockSettingsIconView}),SocialBlockSettingsIconSelectorView=Marionette.View.extend({getTemplate:function(){return window.templates.socialSettingsIconSelector},regions:{icons:"#mailpoet_social_icon_selector_contents"},events:{"click .mailpoet_add_social_icon":"addSocialIcon"},modelEvents:{"change:iconSet":"render"},addSocialIcon:function(){this.model.get("icons").add({})},onRender:function(){this.showChildView("icons",new SocialBlockSettingsIconCollectionView({collection:this.model.get("icons")}))}}),SocialBlockSettingsStylesView=Marionette.View.extend({getTemplate:function(){return window.templates.socialSettingsStyles},modelEvents:{change:"render"},events:{"click .mailpoet_social_icon_set":"changeSocialIconSet"},initialize:function(){this.listenTo(this.model.get("icons"),"add remove change",this.render)},templateContext:function(){var allIconSets=App.getAvailableStyles().get("socialIconSets");return{activeSet:this.model.get("iconSet"),socialIconSets:allIconSets.toJSON(),availableSets:_.keys(allIconSets.toJSON()),availableSocialIcons:this.model.get("icons").pluck("iconType")}},changeSocialIconSet:function(event){this.model.set("iconSet",jQuery(event.currentTarget).data("setname"))},onBeforeDestroy:function(){this.model.get("icons").off("add remove",this.render,this)}}),Module.SocialWidgetView=base.WidgetView.extend({getTemplate:function(){return window.templates.socialInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Module.SocialBlockModel}}}}),App.on("before:start",function(BeforeStartApp){BeforeStartApp.registerBlockType("social",{blockModel:Module.SocialBlockModel,blockView:Module.SocialBlockView}),BeforeStartApp.registerWidget({name:"social",widgetView:Module.SocialWidgetView,priority:95})}),Module}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},9:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(18),__webpack_require__(10),__webpack_require__(270)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(Backbone,Marionette,BackboneRadio){var Radio=BackboneRadio,AppView=Marionette.View.extend({el:"#mailpoet_editor",regions:{stylesRegion:"#mailpoet_editor_styles",contentRegion:"#mailpoet_editor_content",sidebarRegion:"#mailpoet_editor_sidebar",bottomRegion:"#mailpoet_editor_bottom",headingRegion:"#mailpoet_editor_heading",topRegion:"#mailpoet_editor_top"}}),EditorApplication=Marionette.Application.extend({region:"#mailpoet_editor",onStart:function(){this._appView=new AppView,this.showView(this._appView)},getChannel:function(channel){return void 0===channel?Radio.channel("global"):Radio.channel(channel)}}),app=new EditorApplication;return window.EditorApplication=app,app}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}},[465]);